{"version":3,"file":"index.cjs","sources":["../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/drawing/drawing.ts","../../../node_modules/@babel/runtime/helpers/esm/extends.js","../../../node_modules/@babel/runtime/helpers/esm/createClass.js","../src/svg/point.ts","../src/utils.ts","../src/svg/command.ts","../src/svg/vector.ts","../src/drawing/convert.ts","../src/svg/path.ts","../src/drawing/factory.ts","../../../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","../src/event.ts","../src/throttle.ts","../src/drawing/eventHandler.ts","../src/svg/svg.ts","../src/edit/segment.ts","../src/edit/boundingBox.ts","../src/edit/editPath.ts","../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../src/edit/pathSelector.ts","../src/edit/editSvg.ts","../src/edit/editing.ts","../src/edit/resizePathHandler.ts","../src/edit/translatePathHandler.ts","../src/renderer.ts","../src/download.ts","../src/resize.ts","../src/parser.ts","../src/SvgDrawing.ts","../../../node_modules/regenerator-runtime/runtime.js","../../../node_modules/@babel/runtime/regenerator/index.js","../src/animation/animation.ts","../src/SvgAnimation.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import type { DrawingClass } from '..'\nimport type { EventPoint, DrawFactory, PathClass, SvgClass } from '../types'\n\n/**\n * ### Basic Drawing usage.\n *\n * ```ts\n * import {\n *   Svg,\n *   Drawing,\n *   PenHandler,\n *   Renderer,\n *   BasicDrawFactory,\n * } from '@svg-drawing/core'\n *\n * const el = document.getElementById('draw')\n * const { width, height } = el.getBoundingClientRect()\n *\n * new Drawing(\n *   new Svg({ width, height }),\n *   new BasicDrawFactory({ stroke: '#000' }),\n *   new PenHandler(el),\n *   new Renderer(el).update\n * )\n * ```\n */\nexport class Drawing implements DrawingClass {\n  private _drawPath: PathClass | null\n  private _drawPoints: EventPoint[]\n  constructor(\n    public svg: SvgClass,\n    public pathFactory: DrawFactory,\n    private update: (svg: SvgClass) => void\n  ) {\n    /** Setup property */\n    this._drawPath = null\n    this._drawPoints = []\n\n    /** Setup EventDrawHandler */\n    this.start = this.start.bind(this)\n    this.dot = this.dot.bind(this)\n    this.end = this.end.bind(this)\n  }\n\n  public start(): void {\n    this._drawPoints = []\n    this._drawPath = this.pathFactory.createPath()\n    this.svg.addPath(this._drawPath)\n  }\n\n  public dot(po: EventPoint): void {\n    if (!this._drawPath) return\n\n    this._drawPoints.push(po)\n    this._drawPath.updateCommands(\n      this.pathFactory.createCommand(this._drawPoints)\n    )\n\n    this.update(this.svg)\n  }\n\n  public end(): void {\n    this._drawPath = null\n    this.update(this.svg)\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import type { VectorObject, PointClass, PointObject } from '../types'\n\n/**\n * Maximum number of decimal places is 5\n *\n * @todo Changeable parameter\n */\nconst coeffecient = 100000\nconst roundNumber = (num: number) => Math.round(num * coeffecient) / coeffecient\n\nexport class Point implements PointClass {\n  private _x: number\n  private _y: number\n  constructor(x: number, y: number) {\n    this._x = roundNumber(x)\n    this._y = roundNumber(y)\n  }\n\n  public get x() {\n    return this._x\n  }\n\n  public get y() {\n    return this._y\n  }\n\n  public scale(r: number) {\n    return new Point(this._x * r, this._y * r)\n  }\n\n  public scaleX(r: number) {\n    return new Point(this._x * r, this._y)\n  }\n\n  public scaleY(r: number) {\n    return new Point(this._x, this._y * r)\n  }\n\n  public add(p: PointObject) {\n    return new Point(this._x + p.x, this._y + p.y)\n  }\n\n  public sub(p: PointObject) {\n    return new Point(this._x - p.x, this._y - p.y)\n  }\n\n  public clone() {\n    return new Point(this._x, this._y)\n  }\n\n  public toJson() {\n    return {\n      x: this._x,\n      y: this._y,\n    }\n  }\n\n  /**\n   * ### Calculate coordinate from vector.\n   *\n   * ```ts\n   * const point = Point.fromVector({ value: 1, 0 })\n   *\n   * console.log(point.x) // 0\n   * console.log(point.y) // 1\n   * ```\n   */\n  public static fromVector({ value, angle }: VectorObject): Point {\n    const theta = (angle * Math.PI) / 180\n    return new Point(Math.cos(theta) * value, Math.sin(theta) * value)\n  }\n}\n","export const camel2kebab = (str: string): string =>\n  str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n\nexport const roundUp = (num: number, digits = 2): number => +num.toFixed(digits)\n\nexport const kebab2camel = (str: string): string =>\n  str.replace(/-([a-z])/g, (a: string, b: string) => b.toUpperCase())\n\nexport const isAlmostSameNumber = (a: number, b: number) =>\n  Math.trunc(a) === Math.trunc(b)\n\nexport const isNaN = (num: number) => num !== num\n","import { Point } from './point'\nimport { roundUp } from '../utils'\nimport type {\n  CommandClass,\n  CommandType,\n  OtherCommandType,\n  PointObject,\n  PointClass,\n  AbsoluteCommandType,\n  RelativeCommandType,\n} from '../types'\n\n/** @deprecated */\nexport class OtherCommand<T extends OtherCommandType>\n  implements CommandClass<OtherCommandType>\n{\n  static Types = {\n    /**\n     * Horizontal\n     *\n     * `H 10`\n     */\n    H: 'H',\n    /**\n     * Horizontal relative\n     *\n     * `h 10`\n     */\n    h: 'h',\n    /**\n     * Vertical\n     *\n     * V 10\n     */\n    V: 'V',\n    /**\n     * Vertical relative\n     *\n     * `v 10`\n     */\n    v: 'v',\n    /**\n     * Arc curve\n     *\n     * `A 6 4 10 0 1 14 10`\n     */\n    A: 'A',\n    /**\n     * Arc curve relative\n     *\n     * `a 6 4 10 0 1 14 10`\n     */\n    a: 'a',\n  } as const\n\n  constructor(public type: T, public values: number[] = []) {}\n\n  public set points(p: PointClass[]) {\n    if (!p) return\n    this.values = p.reduce((acc: number[], p) => [...acc, p.x, p.y], [])\n  }\n\n  public get points() {\n    return this.values.reduce(\n      (acc: Point[], _, i: number) =>\n        i % 2 ? acc : [...acc, new Point(this.values[i - 1], this.values[i])],\n      []\n    )\n  }\n\n  public get point() {\n    return undefined\n  }\n\n  public toString() {\n    return `${this.type}${this.values.map((v) => roundUp(v)).join(' ')}`\n  }\n\n  public scale(r: number) {\n    const upd = new OtherCommand(\n      this.type,\n      this.values.map((p) => p * r)\n    )\n    return upd\n  }\n\n  public scaleX(r: number) {\n    return new OtherCommand(\n      this.type,\n      this.points.reduce((res: number[], po: PointClass) => {\n        const upd = po.scale(r)\n        return [...res, upd.x, upd.y]\n      }, [])\n    )\n  }\n\n  public scaleY(r: number) {\n    return new OtherCommand(\n      this.type,\n      this.points.reduce((res: number[], po: PointClass) => {\n        const upd = po.scaleY(r)\n        return [...res, upd.x, upd.y]\n      }, [])\n    )\n  }\n\n  public clone() {\n    return new OtherCommand(this.type, this.values.slice())\n  }\n\n  public translate(p: PointObject) {\n    if (OtherCommand.Types.a === this.type) return this\n    this.points = this.points.map((po) => po.add(p))\n    return this\n  }\n\n  public static validTypes(t: any): t is OtherCommandType {\n    return Object.values(OtherCommand.Types).some((arg) => arg === t)\n  }\n}\n\n/**\n * Move relative\n *\n * `m 0 0`\n */\nexport class RelativeMove implements CommandClass<'m'> {\n  public readonly type = 'm'\n  public readonly relative = false\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeMove(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new RelativeMove(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new RelativeMove(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new RelativeMove(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new RelativeMove(this.point.clone())\n  }\n}\n\n/**\n * Move\n *\n * `M 0 0`\n */\nexport class Move implements CommandClass<'M'> {\n  public readonly type = 'M'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Move(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new Move(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new Move(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new Move(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new Move(this.point.clone())\n  }\n}\n\n/**\n * Line relative\n *\n * `l 0 0`\n */\nexport class RelativeLine implements CommandClass<'l'> {\n  public readonly type = 'l'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeLine(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new RelativeLine(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new RelativeLine(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new RelativeLine(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new RelativeLine(this.point.clone())\n  }\n}\n\n/**\n * Line\n *\n * `L 0 0`\n */\nexport class Line implements CommandClass<'L'> {\n  public readonly type = 'L'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values(): number[] {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Line(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new Line(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new Line(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new Line(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new Line(this.point.clone())\n  }\n}\n\n/**\n * Cubic bezier curve relative\n *\n * `c 1 1 2 2 3 3`\n */\nexport class RelativeCurve implements CommandClass<'c'> {\n  public readonly type = 'c'\n  constructor(public points: [PointClass, PointClass, PointClass]) {}\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[2]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scaleX(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scaleY(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public clone() {\n    return new RelativeCurve(\n      this.points.map((po) => po.clone()) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n}\n\n/**\n * Cubic bezier curve\n *\n * `C 1 1 2 2 3 3`\n */\nexport class Curve implements CommandClass<'C'> {\n  public readonly type = 'C'\n  constructor(public points: [PointClass, PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[2]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Curve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scaleX(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scaleY(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public clone() {\n    return new Curve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Shortcut curve\n *\n * `S 10 60 10 30`\n */\nexport class ShortcutCurve implements CommandClass<'S'> {\n  public readonly type = 'S'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new ShortcutCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new ShortcutCurve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Shortcut curve relative\n *\n * `s 10 60 10 30`\n */\nexport class RelativeShortcutCurve implements CommandClass<'s'> {\n  public readonly type = 's'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeShortcutCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new RelativeShortcutCurve(\n      this.points.map((po) => po.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Quadratic curve\n *\n * Q 10 60 10 30\n */\n\nexport class QuadraticCurve implements CommandClass<'Q'> {\n  public readonly type = 'Q'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new QuadraticCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new QuadraticCurve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Quadratic curve relative\n *\n * `q 10 60 10 30`\n */\nexport class RelativeQuadraticCurve implements CommandClass<'q'> {\n  public readonly type = 'q'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeQuadraticCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new RelativeQuadraticCurve(\n      this.points.map((po) => po.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Close\n *\n * 'z'\n */\nexport class Close implements CommandClass<'z'> {\n  public readonly type = 'z'\n\n  public get values(): [] {\n    return []\n  }\n\n  public get points(): [] {\n    return []\n  }\n\n  public get point() {\n    return undefined\n  }\n\n  public toString() {\n    return `${this.type}`\n  }\n\n  public translate(_p: PointObject) {\n    return new Close()\n  }\n\n  public scale(_r: number) {\n    return new Close()\n  }\n\n  public scaleX(r: number) {\n    return new Close()\n  }\n\n  public scaleY(r: number) {\n    return new Close()\n  }\n\n  public clone() {\n    return new Close()\n  }\n}\n\nexport const createCommand = (\n  type: CommandType,\n  values: number[] = []\n): CommandClass => {\n  switch (type) {\n    case 'M': {\n      return new Move(new Point(values[0], values[1]))\n    }\n    case 'm': {\n      return new RelativeMove(new Point(values[0], values[1]))\n    }\n    case 'L': {\n      return new Line(new Point(values[0], values[1]))\n    }\n    case 'l': {\n      return new RelativeLine(new Point(values[0], values[1]))\n    }\n    case 'C': {\n      return new Curve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n        new Point(values[4], values[5]),\n      ])\n    }\n    case 'c': {\n      return new RelativeCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n        new Point(values[4], values[5]),\n      ])\n    }\n    case 'Q': {\n      return new QuadraticCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'q': {\n      return new RelativeQuadraticCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'S': {\n      return new ShortcutCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 's': {\n      return new RelativeShortcutCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'Z':\n    case 'z': {\n      return new Close()\n    }\n\n    default: {\n      return new OtherCommand(type, values)\n    }\n  }\n}\n\nexport const isAbsoluteCommand = (\n  command: CommandClass\n): command is CommandClass<AbsoluteCommandType> =>\n  ['M', 'L', 'C', 'Q', 'S'].includes(command.type)\n\nexport const isRelativeCommand = (\n  command: CommandClass\n): command is CommandClass<RelativeCommandType> =>\n  ['m', 'l', 'c', 'q', 's'].includes(command.type)\n\nexport const isCurveCommand = (\n  command: CommandClass\n): command is CommandClass<'C' | 'c'> => ['c', 'C'].includes(command.type)\n\nexport const isOtherCommand = (\n  command: CommandClass\n): command is CommandClass<OtherCommandType> =>\n  ['h', 'H', 'v', 'V', 'a', 'A', 'z', 'Z'].includes(command.type)\n\nexport const toRelativeCommand = (\n  command: CommandClass<AbsoluteCommandType>,\n  basePoint: PointObject\n): CommandClass<RelativeCommandType> => {\n  switch (command.type) {\n    case 'M':\n      return new RelativeMove(command.point.sub(basePoint))\n    case 'L':\n      return new RelativeLine(command.point.sub(basePoint))\n    case 'C':\n      return new RelativeCurve(\n        command.points.map((p) => p.sub(basePoint)) as [\n          PointClass,\n          PointClass,\n          PointClass\n        ]\n      )\n    case 'Q':\n      return new RelativeQuadraticCurve(\n        command.points.map((p) => p.sub(basePoint)) as [PointClass, PointClass]\n      )\n    case 'S':\n      return new RelativeShortcutCurve(\n        command.points.map((p) => p.sub(basePoint)) as [PointClass, PointClass]\n      )\n    default:\n      throw new Error('toRelativeCommand error')\n  }\n}\n\nexport const toAbsoluteCommand = (\n  command: CommandClass<RelativeCommandType>,\n  basePoint: PointObject\n): CommandClass<AbsoluteCommandType> => {\n  switch (command.type) {\n    case 'm':\n      return new Move(command.point.add(basePoint))\n    case 'l':\n      return new Line(command.point.add(basePoint))\n    case 'c':\n      return new Curve(\n        command.points.map((p) => p.add(basePoint)) as [\n          PointClass,\n          PointClass,\n          PointClass\n        ]\n      )\n    case 'q':\n      return new QuadraticCurve(\n        command.points.map((p) => p.add(basePoint)) as [PointClass, PointClass]\n      )\n    case 's':\n      return new ShortcutCurve(\n        command.points.map((p) => p.add(basePoint)) as [PointClass, PointClass]\n      )\n    default:\n      throw new Error('toAbsoluteCommand error')\n  }\n}\n\nexport const toRelativeCommands = (\n  commands: CommandClass[]\n): CommandClass[] => {\n  if (commands.length === 0) return []\n\n  let basePoint = commands[0].point\n  const upd = [commands[0]]\n\n  for (let i = 1; i < commands.length; i += 1) {\n    const command = commands[i]\n\n    const notAbsoluteCommand =\n      basePoint && isAbsoluteCommand(command)\n        ? toRelativeCommand(command, basePoint)\n        : command.clone()\n\n    basePoint = isAbsoluteCommand(command)\n      ? command.point // Absolute point\n      : basePoint && command.point\n      ? basePoint.add(command.point) // Relative point\n      : undefined // Close\n\n    upd.push(notAbsoluteCommand)\n  }\n\n  return upd\n}\n\nexport const toAbsoluteCommands = (\n  commands: CommandClass[]\n): CommandClass[] => {\n  if (commands.length === 0) return []\n\n  let basePoint = commands[0].point\n  const upd = [commands[0]]\n\n  for (let i = 1; i < commands.length; i += 1) {\n    const command = commands[i]\n\n    const notRelativeCommand =\n      basePoint && isRelativeCommand(command)\n        ? toAbsoluteCommand(command, basePoint)\n        : command.clone()\n\n    basePoint = isAbsoluteCommand(command)\n      ? command.point // Absolute point\n      : basePoint && command.point\n      ? basePoint.add(command.point) // Relative point\n      : undefined // Close\n\n    upd.push(notRelativeCommand)\n  }\n\n  return upd\n}\n","import type { VectorClass, PointObject } from '../types'\n\nexport class Vector implements VectorClass {\n  constructor(public readonly value: number, public readonly angle: number) {}\n\n  scale(r: number) {\n    return new Vector(this.value * r, this.angle)\n  }\n\n  rotate(a: number) {\n    return new Vector(this.value, this.angle + a)\n  }\n\n  toJson() {\n    return {\n      value: this.value,\n      angle: this.angle,\n    }\n  }\n\n  /**\n   * ### Calculate angle and absolute value from origin of coordinates\n   *\n   * ```ts\n   * const vector = Vector.fromPoint({ x: 1, y: 1 })\n   *\n   * console.log(vector.angle) // 45\n   * console.log(vector.value) // 1.4142135623730951\n   * ```\n   */\n  public static fromPoint({ x, y }: PointObject): Vector {\n    return new Vector(\n      Math.sqrt(Math.pow(x, 2.0) + Math.pow(y, 2.0)),\n      Math.atan2(y, x) * (180 / Math.PI)\n    )\n  }\n}\n","import { Move, Line, Curve, Close } from '../svg/command'\nimport { Point } from '../svg/point'\nimport { Vector } from '../svg/vector'\nimport type {\n  EventPoint,\n  CommandClass,\n  PointObject,\n  ConvertOption,\n  CreateCommand,\n} from '../types'\n\nexport const createLineCommands: CreateCommand = (points) =>\n  points.map((p, i) =>\n    i === 0 ? new Move(new Point(p.x, p.y)) : new Line(new Point(p.x, p.y))\n  )\n\ninterface GenerateCommandsConverter {\n  create: CreateCommand\n}\n\nexport class BezierCurve implements GenerateCommandsConverter {\n  public ratio: number\n  constructor({ ratio }: ConvertOption = {}) {\n    this.ratio = ratio ?? 0.4\n    this.create = this.create.bind(this)\n  }\n\n  public genCommand(\n    p1: PointObject,\n    p2: PointObject,\n    p3: PointObject,\n    p4: PointObject\n  ): CommandClass {\n    const value = Vector.fromPoint(\n      new Point(p3.x, p3.y).sub(new Point(p2.x, p2.y))\n    ).scale(this.ratio).value\n\n    const vPrev = Point.fromVector({\n      angle: Vector.fromPoint(new Point(p3.x, p3.y).sub(new Point(p1.x, p1.y)))\n        .angle,\n      value,\n    })\n    const vNext = Point.fromVector({\n      angle: Vector.fromPoint(new Point(p2.x, p2.y).sub(new Point(p4.x, p4.y)))\n        .angle,\n      value,\n    })\n\n    const cPrev = new Point(p2.x, p2.y).add(vPrev)\n    const cNext = new Point(p3.x, p3.y).add(vNext)\n    return new Curve([cPrev, cNext, new Point(p3.x, p3.y)])\n  }\n\n  public create(p: EventPoint[]): CommandClass[] {\n    const commands: CommandClass[] = []\n    if (p.length < 3) {\n      return createLineCommands(p)\n    }\n    for (let i = 0; i < p.length; i += 1) {\n      if (i === 0) {\n        commands.push(new Move(new Point(p[i].x, p[i].y)))\n        continue\n      }\n      commands.push(\n        this.genCommand(\n          p[i - 2 < 0 ? 0 : i - 2],\n          p[i - 1],\n          p[i],\n          i < p.length - 1 ? p[i + 1] : p[i]\n        )\n      )\n    }\n    return commands\n  }\n}\n\nexport const closeCommands = (commands: CommandClass[]): CommandClass[] => [\n  ...commands,\n  new Close(),\n]\n","import { toAbsoluteCommands, toRelativeCommands } from './command'\nimport type {\n  PathClass,\n  CommandClass,\n  PathAttributes,\n  PointObject,\n  PathObject,\n} from '../types'\n\n/**\n * Cannot support commands that use `M` or` z` more than once.\n *\n * Not support example: `M 0 0 L 1 1 Z M 1 1 L 2 2 Z`.\n */\nexport class Path implements PathClass {\n  private static index = 0\n  private static genIndex = () => (Path.index += 1)\n  private commands: CommandClass[] = []\n  public key: string\n  constructor(public attrs: PathAttributes = {}, _key?: string) {\n    this.key = _key || `p${Path.genIndex()}`\n  }\n\n  get absoluteCommands(): CommandClass[] {\n    return toAbsoluteCommands(this.commands)\n  }\n\n  get relativeCommands(): CommandClass[] {\n    return toRelativeCommands(this.commands)\n  }\n\n  updateCommands(commands: CommandClass[]) {\n    this.commands = toRelativeCommands(commands)\n\n    return this\n  }\n\n  scale(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scale(r)))\n    return this\n  }\n\n  scaleX(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scaleX(r)))\n    return this\n  }\n\n  scaleY(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scaleY(r)))\n    return this\n  }\n\n  addCommand(param: CommandClass | CommandClass[]) {\n    this.updateCommands([...this.commands, param].flat())\n    return this\n  }\n\n  updateCommand(\n    i: number,\n    update: (absoluteCommand: CommandClass) => CommandClass\n  ) {\n    const commands = this.absoluteCommands\n    commands[i] = update(commands[i])\n\n    this.updateCommands(commands)\n    return this\n  }\n\n  deleteCommand(i: number) {\n    this.updateCommands(this.absoluteCommands.filter((_, index) => index !== i))\n    return this\n  }\n\n  getCommandString() {\n    return (\n      this.relativeCommands\n        ?.map((com: CommandClass, _i: number) => com.toString())\n        .join(' ')\n        .trim() || ''\n    )\n  }\n\n  toJson(): PathObject {\n    return {\n      key: this.key,\n      type: 'path',\n      attributes: {\n        ...this.attrs,\n        d: this.getCommandString(),\n      },\n    }\n  }\n\n  setAttributes(attrs: PathAttributes) {\n    this.attrs = attrs\n\n    return this\n  }\n\n  updateAttributes(attrs: PathAttributes) {\n    this.attrs = {\n      ...this.attrs,\n      ...attrs,\n    }\n\n    return this\n  }\n\n  translate(po: PointObject) {\n    this.updateCommands(this.absoluteCommands.map((com) => com.translate(po)))\n\n    return this\n  }\n\n  clone() {\n    return new Path(\n      {\n        ...this.attrs,\n      },\n      this.key\n    ).addCommand(this.commands.map((c) => c.clone()))\n  }\n}\n","import { BezierCurve, closeCommands, createLineCommands } from './convert'\nimport { Path } from '../svg/path'\nimport type {\n  CreateCommand,\n  DrawFactory,\n  PathAttributes,\n  PathClass,\n} from '../types'\n\nexport class BasicDrawFactory implements DrawFactory {\n  constructor(\n    private attrs: PathAttributes,\n    private opts: { curve?: boolean; close?: boolean } = {}\n  ) {\n    this.opts = {\n      curve: true,\n      close: false,\n      ...opts,\n    }\n  }\n\n  createPath(): PathClass {\n    return new Path({\n      ...this.attrs,\n      ...this.curveAttribute,\n    })\n  }\n\n  get createCommand(): CreateCommand {\n    const createCommand = this.opts.curve\n      ? new BezierCurve().create\n      : createLineCommands\n\n    return (po) =>\n      this.opts.close ? closeCommands(createCommand(po)) : createCommand(po)\n  }\n\n  setPathAttributes(attrs: PathAttributes) {\n    this.attrs = attrs\n  }\n\n  updatePathAttributes(attrs: PathAttributes) {\n    this.attrs = {\n      ...this.attrs,\n      ...attrs,\n    }\n  }\n\n  changeCurve(curve: boolean) {\n    this.opts = {\n      ...this.opts,\n      curve,\n    }\n  }\n\n  changeClose(curve: boolean) {\n    this.opts = {\n      ...this.opts,\n      curve,\n    }\n  }\n\n  get curveAttribute() {\n    return {\n      strokeLinecap: this.opts.curve ? 'round' : 'mitter',\n      strokeLinejoin: this.opts.curve ? 'round' : 'square',\n    }\n  }\n}\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import type { EventPoint } from './types'\n\nexport const SUPPORT_POINTER_EVENT = typeof PointerEvent !== 'undefined'\n\nexport const SUPPORT_ON_TOUCH_START = typeof ontouchstart !== 'undefined'\n\nexport const SUPPORT_EVENT_LISTENER_PASSIVE_OPTION = (() => {\n  try {\n    const check = () => null\n    addEventListener('testPassive', check, { passive: true })\n    removeEventListener('testPassive', check)\n    return true\n  } catch (e) {\n    return false\n  }\n})()\n\nexport const getEventPoint = (\n  ev: MouseEvent | TouchEvent | PointerEvent\n): EventPoint => {\n  if ('touches' in ev) {\n    const touche = ev.touches.length ? ev.touches[0] : ev.changedTouches[0]\n    return {\n      x: touche.clientX,\n      y: touche.clientY,\n      pressure: touche.force,\n    }\n  }\n\n  return {\n    x: ev.clientX,\n    y: ev.clientY,\n    pressure: 'pressure' in ev ? ev.pressure : undefined,\n  }\n}\n","/**\n * ```ts\n * const handleMouseMove = throttle(\n *   (ev) => console.log(ev.target.clientX, ev.target.clientY),\n *   50\n * )\n *\n * window.addEventListener('onmousemove', handleMouseMove)\n * ```\n */\nexport function throttle<T extends (...args: any) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => ReturnType<T> | null {\n  let context: any | null\n  let args: any | null\n  let result: ReturnType<T> | null\n  let timeout: any | null = null\n  let previous = 0\n\n  const later = (): void => {\n    previous = Date.now()\n    timeout = null\n    result = func.apply(context, args)\n    if (!timeout) {\n      context = null\n      args = null\n    }\n  }\n\n  return function wrap(\n    this: typeof func,\n    ...wrapArg: Parameters<T>\n  ): ReturnType<T> | null {\n    const now = Date.now()\n    const remaining = wait - (now - previous)\n    context = this\n    args = wrapArg\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout)\n        timeout = null\n      }\n      previous = now\n      result = func.apply(context, args)\n      if (!timeout) {\n        context = null\n        args = null\n      }\n    } else if (!timeout) {\n      timeout = setTimeout(later, remaining)\n    }\n    return result\n  }\n}\n","import {\n  getEventPoint,\n  SUPPORT_EVENT_LISTENER_PASSIVE_OPTION,\n  SUPPORT_ON_TOUCH_START,\n  SUPPORT_POINTER_EVENT,\n} from '../event'\nimport { throttle } from '../throttle'\nimport type { DrawingClass } from '..'\nimport type {\n  DrawListenerType,\n  DrawEventHandler,\n  ClearListener,\n  EventPoint,\n  DrawEventName,\n} from '../types'\n\nclass OffsetPosition {\n  left: number\n  top: number\n  constructor(private el?: HTMLElement) {\n    const { left, top } = el ? el.getBoundingClientRect() : { left: 0, top: 0 }\n\n    this.left = left\n    this.top = top\n  }\n\n  setElement(el: HTMLElement) {\n    this.el = el\n  }\n\n  setup(): Array<ClearListener> {\n    const el = this.el\n    if (!el) return []\n\n    const setOffsetPosition = () => {\n      const { left, top } = el.getBoundingClientRect()\n      this.left = left\n      this.top = top\n    }\n\n    setOffsetPosition()\n    addEventListener('scroll', setOffsetPosition)\n    el.addEventListener('resize', setOffsetPosition)\n    return [\n      () => {\n        removeEventListener('scroll', setOffsetPosition)\n        el.removeEventListener('resize', setOffsetPosition)\n      },\n    ]\n  }\n}\n\nexport abstract class BaseHandler implements DrawEventHandler {\n  /** Remove EventList */\n  private _clearEventList: Array<ClearListener>\n  /** Offset coordinates */\n  private _offsetPosition: OffsetPosition\n\n  constructor(\n    protected drawing: DrawingClass,\n    protected el?: HTMLElement | undefined\n  ) {\n    // Bind method\n    this.on = this.on.bind(this)\n    this.off = this.off.bind(this)\n    this.setDrawing = this.setDrawing.bind(this)\n\n    // Set offset coordinates\n    this._offsetPosition = new OffsetPosition(el)\n    this._clearEventList = []\n  }\n\n  public get isActive(): boolean {\n    return this._clearEventList.length > 0\n  }\n\n  public off() {\n    this._clearEventList.map((fn) => fn())\n    this._clearEventList = []\n  }\n\n  public on() {\n    this.off()\n\n    this._clearEventList = [\n      ...this._offsetPosition.setup(),\n      ...this.setupListener(),\n    ]\n  }\n\n  public setElement(el: HTMLElement) {\n    this.el = el\n    this._offsetPosition.setElement(el)\n\n    if (this.isActive) this.on()\n  }\n\n  public setDrawing(drawing: DrawingClass) {\n    this.drawing = drawing\n    if (this.isActive) this.on()\n  }\n\n  public getPointObjectFromDrawEvent(\n    ev: MouseEvent | TouchEvent | PointerEvent\n  ): EventPoint {\n    const { x, y, pressure } = getEventPoint(ev)\n\n    return {\n      x: x - this._offsetPosition.left,\n      y: y - this._offsetPosition.top,\n      pressure,\n    }\n  }\n\n  protected abstract setupListener(): Array<ClearListener>\n}\n\nexport class PencilHandler extends BaseHandler {\n  private _drawMoveThrottle: DrawingClass['dot']\n  private delay = 20\n  /** AddEventListener Options */\n  private listenerOption: { passive: boolean } | false\n  constructor(drawing: DrawingClass, el?: HTMLElement) {\n    super(drawing, el)\n\n    // Bind methods\n    this.setDrawing = this.setDrawing.bind(this)\n    this._handleStart = this._handleStart.bind(this)\n    this._handleMove = this._handleMove.bind(this)\n    this._handleEnd = this._handleEnd.bind(this)\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay).bind(this)\n\n    this.listenerOption = SUPPORT_EVENT_LISTENER_PASSIVE_OPTION\n      ? { passive: false }\n      : false\n  }\n\n  public changeDelay(delay: number): void {\n    this.delay = delay\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay)\n\n    if (this.isActive) this.on()\n  }\n\n  public setDrawing(drawing: DrawingClass) {\n    this.drawing = drawing\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay)\n\n    if (this.isActive) this.on()\n  }\n\n  protected setupListener(): Array<ClearListener> {\n    if (SUPPORT_POINTER_EVENT) return this._setupDrawListener('pointer')\n\n    if (SUPPORT_ON_TOUCH_START) return this._setupDrawListener('touch')\n\n    return this._setupDrawListener('mouse')\n  }\n\n  private _handleStart(ev: TouchEvent | MouseEvent | PointerEvent) {\n    ev.preventDefault()\n    this.drawing.start()\n  }\n\n  private _handleEnd(ev: TouchEvent | MouseEvent | PointerEvent) {\n    ev.preventDefault()\n    this.drawing.end()\n  }\n\n  private _handleMove(ev: MouseEvent | PointerEvent | TouchEvent) {\n    ev.preventDefault()\n    this._drawMoveThrottle(this.getPointObjectFromDrawEvent(ev))\n  }\n\n  private _setupDrawListener(type: DrawListenerType): Array<() => void> {\n    const el = this.el\n    if (!el) return []\n\n    const eventMap: Record<\n      DrawListenerType,\n      {\n        start: Array<DrawEventName>\n        move: Array<DrawEventName>\n        end: Array<DrawEventName>\n        flameout: Array<DrawEventName>\n      }\n    > = {\n      pointer: {\n        start: ['pointerdown'],\n        move: ['pointermove'],\n        end: ['pointerleave', 'pointercancel'],\n        flameout: ['pointerup'],\n      },\n      touch: {\n        start: ['touchstart'],\n        move: ['touchmove'],\n        end: ['touchend'],\n        flameout: ['touchcancel'],\n      },\n      mouse: {\n        start: ['mousedown'],\n        move: ['mousemove'],\n        end: ['mouseleave', 'mouseout'],\n        flameout: ['mouseup'],\n      },\n    }\n\n    const { start, move, end, flameout } = eventMap[type]\n\n    const startClear = start.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleStart, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleStart)\n    })\n\n    const moveClear = move.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleMove, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleMove)\n    })\n\n    const endClear = end.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleEnd, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleEnd)\n    })\n\n    const flameoutClear = flameout.map((evname): ClearListener => {\n      addEventListener(evname, this._handleEnd, this.listenerOption)\n      return () => removeEventListener(evname, this._handleEnd)\n    })\n\n    return [...startClear, ...moveClear, ...endClear, ...flameoutClear]\n  }\n}\n\nexport class PenHandler extends BaseHandler {\n  private _editing: boolean\n  constructor(drawing: DrawingClass, el?: HTMLElement) {\n    super(drawing, el)\n    this._editing = false\n    this._handleProt = this._handleProt.bind(this)\n  }\n\n  protected setupListener(): Array<ClearListener> {\n    const clearEvent: ClearListener[] = [...this._setupCancelListener()]\n    if (SUPPORT_POINTER_EVENT)\n      return [...this._setupDrawListener('pointer'), ...clearEvent]\n\n    if (SUPPORT_ON_TOUCH_START)\n      return [...this._setupDrawListener('touch'), ...clearEvent]\n\n    return [...this._setupDrawListener('mouse'), ...clearEvent]\n  }\n\n  private _handleProt(ev: MouseEvent | PointerEvent | TouchEvent) {\n    ev.preventDefault()\n    const isFrameIn = this._isContainElement(ev)\n    if (!this._editing && isFrameIn) {\n      this.drawing.start()\n      this.drawing.dot(this.getPointObjectFromDrawEvent(ev))\n      this._editing = true\n      return\n    }\n\n    if (isFrameIn) {\n      this.drawing.dot(this.getPointObjectFromDrawEvent(ev))\n      return\n    }\n\n    // end\n    this._editing = false\n    this.drawing.end()\n  }\n\n  private _isContainElement(\n    ev: MouseEvent | PointerEvent | TouchEvent\n  ): boolean {\n    if (!this.el) return false\n    return this.el.contains(ev.target as any)\n  }\n\n  private _setupCancelListener() {\n    const stopId = setInterval(() => {\n      if (!document.hasFocus()) {\n        this._editing = false\n        this.drawing.end()\n      }\n    }, 1000)\n    return [() => clearInterval(stopId)]\n  }\n\n  private _setupDrawListener(type: DrawListenerType): Array<ClearListener> {\n    const eventMap: Record<DrawListenerType, DrawEventName> = {\n      touch: 'touchstart',\n      pointer: 'pointerup',\n      mouse: 'mouseup',\n    }\n\n    addEventListener(eventMap[type], this._handleProt)\n    return [\n      () => {\n        removeEventListener(eventMap[type], this._handleProt)\n      },\n    ]\n  }\n}\n","import type { SvgOption, PathClass, SvgClass } from '../types'\n\nexport class Svg implements SvgClass {\n  public paths: PathClass[]\n  public width: number\n  public height: number\n  public background?: string\n\n  constructor({ width, height, background }: SvgOption) {\n    this.paths = []\n    this.width = width\n    this.height = height\n    this.background = background\n  }\n\n  public resize({ width, height }: { width: number; height: number }) {\n    this.scale(width / this.width)\n    this.width = width\n    this.height = height\n  }\n\n  private scale(r: number) {\n    if (r !== 1 && isFinite(r) && r !== 0) {\n      for (let i = 0; i < this.paths.length; i += 1) {\n        this.paths[i].scale(r)\n      }\n    }\n    return this\n  }\n\n  public addPath(pa: PathClass | PathClass[]) {\n    if (Array.isArray(pa)) {\n      this.paths.push(...pa)\n    } else {\n      this.paths.push(pa)\n    }\n    return this\n  }\n\n  public getPath(key: string): PathClass | undefined {\n    return this.paths.find((p) => p.key === key)\n  }\n\n  public updatePath(path: PathClass) {\n    const index = this.paths.findIndex((p) => p.key === path.key)\n    if (index !== -1) {\n      this.paths[index] = path\n    }\n    return this\n  }\n\n  public deletePath(deletePath: PathClass) {\n    this.paths = this.paths.filter((path) => path.key !== deletePath.key)\n    return this\n  }\n\n  public clonePaths() {\n    return this.paths.map((p) => p.clone())\n  }\n\n  public toJson() {\n    return {\n      width: this.width,\n      height: this.height,\n      background: this.background,\n      paths: this.paths.map((p) => p.toJson()),\n    }\n  }\n\n  /**\n   * Copy resized paths.\n   *\n   * @example\n   *\n   * ```ts\n   * const drawSvg = new Svg()\n   * const animateSvg = new Svg().copy(drawSvg)\n   * ```\n   */\n  public copy(svg: SvgClass) {\n    this.paths = svg.clonePaths()\n    if (svg.width && this.width) {\n      this.scale(this.width / svg.width)\n    }\n    return this\n  }\n\n  public clone() {\n    const svg = new Svg({\n      width: this.width,\n      height: this.height,\n      background: this.background,\n    })\n    svg.addPath(this.clonePaths())\n    return svg\n  }\n}\n","import { isCurveCommand } from '../svg/command'\nimport type { PointObject, CommandClass } from '../types'\n\ntype BezierCurvePoint = [PointObject, PointObject, PointObject, PointObject]\n\n/**\n * A cubic Bezier curve is defined by four points. Two are endpoints. (x0,y0) is\n * the origin endpoint. (x3,y3) is the destination endpoint. The points (x1,y1)\n * and (x2,y2) are control points.\n *\n * Two equations define the points on the curve. Both are evaluated for an\n * arbitrary number of values of t between 0 and 1. One equation yields values\n * for x, the other yields values for y. As increasing values for t are supplied\n * to the equations, the point defined by x(t),y(t) moves from the origin to the\n * destination. This is how the equations are defined in Adobe's PostScript references.\n *\n * X(t) = A(x) * pow(t, 3) + B(x) * pow(t, 2) + C(x) * t + x0\n *\n * Y(t) = A(y) * pow(t, 3) + B(y) * pow(t, 2) + c(y) * t + y0\n *\n * This method of definition can be reverse-engineered so that it'll give up the\n * coefficient values based on the points described above:\n *\n * C(x) = 3 (x1 - x0)\n *\n * B(x) = 3 (x2 - x1) - cx\n *\n * A(x) = x3 - x0 - cx - bx\n *\n * C(y) = 3 (y1 - y0)\n *\n * B(y) = 3 (y2 - y1) - cy\n *\n * A(y) = y3 - y0 - cy - by\n *\n * {@link https://www.moshplant.com/direct-or/bezier/math.html}\n */\nexport const calculateCoefficient = ([p0, p1, p2, p3]: BezierCurvePoint): {\n  a: PointObject\n  b: PointObject\n  c: PointObject\n} => {\n  const c = {\n    x: 3 * (p1.x - p0.x),\n    y: 3 * (p1.y - p0.y),\n  }\n\n  const b = {\n    x: 3 * (p2.x - p1.x) - c.x,\n    y: 3 * (p2.y - p1.y) - c.y,\n  }\n\n  const a = {\n    x: p3.x - p0.x - c.x - b.x,\n    y: p3.y - p0.y - c.y - b.y,\n  }\n\n  return { a, b, c }\n}\n\nconst { pow } = Math\n\n/** @todo Compatible for Quadratic and shortcut curve. */\nexport const segmentPoint = (\n  bezierCurve: BezierCurvePoint,\n  range = 10\n): PointObject[] => {\n  const { a, b, c } = calculateCoefficient(bezierCurve)\n  const p = bezierCurve[0]\n\n  const calc = (t: number): PointObject => ({\n    x: a.x * pow(t, 3) + b.x * pow(t, 2) + c.x * t + p.x,\n    y: a.y * pow(t, 3) + b.y * pow(t, 2) + c.y * t + p.y,\n  })\n\n  const step = 1 / range\n  return Array.from({ length: range + 1 }).map((_, i) =>\n    calc(i === 0 ? 0 : i === range ? 1 : i * step)\n  )\n}\n\n/** @todo Compatible for Quadratic and shortcut curve */\nexport const segmentPointsFromCommand = (\n  command: CommandClass,\n  {\n    base,\n    range = 10,\n  }: {\n    base?: PointObject\n    range?: number\n  }\n): PointObject[] => {\n  if (!command.point) return []\n\n  if (isCurveCommand(command)) {\n    const basePoint = base || (command.points[0].toJson() as PointObject)\n    const commandPoints = command.points.map((p) => p.toJson()) as [\n      PointObject,\n      PointObject,\n      PointObject\n    ]\n\n    return segmentPoint([basePoint, ...commandPoints], range)\n  }\n\n  return [command.point.toJson()]\n}\n","import { segmentPointsFromCommand } from './segment'\nimport type { PointObject, FixedType, PathClass } from '../types'\n\nconst fallbackPointObject: PointObject = { x: 0, y: 0 }\n\nexport class BoundingBox {\n  constructor(private paths: PathClass[]) {}\n\n  private get points(): PointObject[] {\n    return this.paths.flatMap((path) => {\n      let prev: PointObject | undefined = undefined\n\n      return path.absoluteCommands.flatMap((command) => {\n        const pts: PointObject[] = segmentPointsFromCommand(command, {\n          base: prev,\n        })\n\n        prev = command.point ? command.point.toJson() : undefined\n\n        return pts\n      })\n    })\n  }\n\n  private get pointsX(): number[] {\n    return this.points.map((point) => point.x)\n  }\n\n  private get pointsY(): number[] {\n    return this.points.map((point) => point.y)\n  }\n\n  get min(): PointObject {\n    if (this.points.length === 0) return fallbackPointObject\n\n    return {\n      x: Math.min(...this.pointsX),\n      y: Math.min(...this.pointsY),\n    }\n  }\n\n  get max(): PointObject {\n    if (this.points.length === 0) return fallbackPointObject\n\n    return {\n      x: Math.max(...this.pointsX),\n      y: Math.max(...this.pointsY),\n    }\n  }\n\n  get width(): number {\n    return this.max.x - this.min.x\n  }\n\n  get height(): number {\n    return this.max.y - this.min.y\n  }\n\n  get vertex(): Record<FixedType, PointObject> {\n    return {\n      ['LeftTop']: { x: this.min.x, y: this.min.y },\n      ['RightTop']: { x: this.max.x, y: this.min.y },\n      ['RightBottom']: { x: this.max.x, y: this.max.y },\n      ['LeftBottom']: { x: this.min.x, y: this.max.y },\n    }\n  }\n\n  public resizeParams(\n    fixedType: FixedType,\n    movePoint: PointObject\n  ): { scale: PointObject; move: PointObject } {\n    const width = this.width\n    const height = this.height\n\n    switch (fixedType) {\n      case 'LeftTop': {\n        const scale = {\n          x: (width - movePoint.x) / width,\n          y: (height - movePoint.y) / height,\n        }\n        const move = {\n          x: -(this.max.x * scale.x - this.max.x),\n          y: -(this.max.y * scale.y - this.max.y),\n        }\n        return { scale, move }\n      }\n      case 'RightTop': {\n        const scale = {\n          x: (width + movePoint.x) / width,\n          y: (height - movePoint.y) / height,\n        }\n        return {\n          scale,\n          move: {\n            x: -(this.min.x * scale.x - this.min.x),\n            y: -(this.max.y * scale.y - this.max.y),\n          },\n        }\n      }\n      case 'LeftBottom': {\n        const scale = {\n          x: (width - movePoint.x) / width,\n          y: (height + movePoint.y) / height,\n        }\n\n        return {\n          scale,\n          move: {\n            x: -(this.max.x * scale.x - this.max.x),\n            y: -(this.min.y * scale.y - this.min.y),\n          },\n        }\n      }\n      case 'RightBottom': {\n        const scale = {\n          x: (width + movePoint.x) / width,\n          y: (height + movePoint.y) / height,\n        }\n        return {\n          scale,\n          move: {\n            x: -(this.min.x * scale.x - this.min.x),\n            y: -(this.min.y * scale.y - this.min.y),\n          },\n        }\n      }\n    }\n  }\n}\n","import type {\n  PointObject,\n  EditVertex,\n  EditPathObject,\n  PathClass,\n} from '../types'\nimport type { PathSelector } from './pathSelector'\n\nconst genOutline = (points: PointObject[]) =>\n  points.reduce(\n    (str, po, i) => (i === 0 ? `M ${po.x} ${po.y}` : str + `L ${po.x} ${po.y}`),\n    ''\n  )\n\nexport class EditPath {\n  constructor(private path: PathClass, private selector: PathSelector) {}\n\n  public toJson(): EditPathObject {\n    return {\n      key: this.path.key,\n      d: this.path.getCommandString(),\n      vertex: this.vertex,\n    }\n  }\n\n  private get vertex(): EditVertex[] {\n    const vertex: EditVertex[] = []\n    const commands = this.path.absoluteCommands\n\n    for (let c = 0; c < commands.length; c += 1) {\n      const curr = commands[c]\n      const next = commands[c + 1]\n\n      const outlinePoints: PointObject[] = [\n        curr.points[1]?.toJson(),\n        curr.points[2]?.toJson(),\n        next?.points[0]?.toJson(),\n      ].filter((p): p is PointObject => !!p)\n\n      const pointIndex = this.selector?.getPointsIndex(this.path.key, c)\n\n      vertex.push({\n        points: curr.points.map((point, pIndex) => ({\n          index: {\n            path: this.path.key,\n            command: c,\n            point: pIndex,\n          },\n          value: point.toJson(),\n          selected: pointIndex?.includes(pIndex) ?? false,\n        })),\n        d: genOutline(outlinePoints),\n      })\n    }\n\n    return vertex\n  }\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import type {\n  SelectIndex,\n  SelectPathIndex,\n  SelectCommandIndex,\n  SelectPointIndex,\n  PathObject,\n} from '../types'\n\ntype Selecting = Record<PathObject['key'], SelectingCommands>\ntype SelectingCommands = Record<number, SelectingPoints>\ntype SelectingPoints = Array<number>\n\nconst convertSelectingFromIndex = (index: SelectIndex): Selecting => ({\n  [index.path]:\n    typeof index.command === 'number'\n      ? {\n          [index.command]: typeof index.point === 'number' ? [index.point] : [],\n        }\n      : {},\n})\n\nconst isSelectPathIndex = (index: SelectIndex): index is SelectPathIndex =>\n  !!(\n    index.path &&\n    typeof index.command !== 'number' &&\n    typeof index.point !== 'number'\n  )\n\nconst isSelectCommandIndex = (\n  index: SelectIndex\n): index is SelectCommandIndex =>\n  !!(\n    index.path &&\n    typeof index.command === 'number' &&\n    typeof index.point !== 'number'\n  )\n\nconst isSelectPointIndex = (index: SelectIndex): index is SelectPointIndex =>\n  !!(\n    index.path &&\n    typeof index.command === 'number' &&\n    typeof index.point === 'number'\n  )\n\nconst isObjectEmpty = (obj: object): obj is Record<any, never> =>\n  Object.keys(obj).length === 0\n\nexport class PathSelector {\n  private selecting: Selecting = {}\n\n  get selectedPathsOnly(): boolean {\n    return (\n      this.selected &&\n      Object.keys(this.selecting).every(\n        (key: string) =>\n          this.selecting && Object.keys(this.selecting[key]).length === 0\n      )\n    )\n  }\n\n  get selected(): boolean {\n    return !isObjectEmpty(this.selecting)\n  }\n\n  get pathsIndex(): string[] {\n    return Object.keys(this.selecting)\n  }\n\n  getCommandsIndex(pathKey: string): number[] | undefined {\n    const selectingCommands = this.selecting[pathKey]\n\n    return selectingCommands && !isObjectEmpty(selectingCommands)\n      ? Object.keys(selectingCommands).map(Number)\n      : undefined\n  }\n\n  getPointsIndex(pathKey: string, commandKey: number): number[] | undefined {\n    const selectingPoints = this.selecting[pathKey]?.[commandKey]\n\n    return selectingPoints && !isObjectEmpty(selectingPoints)\n      ? selectingPoints\n      : undefined\n  }\n\n  clear() {\n    this.selecting = {}\n  }\n\n  select(index: SelectIndex) {\n    this.selecting = convertSelectingFromIndex(index)\n  }\n\n  /**\n   * Currently, only path indexes are supported.\n   *\n   * @todo Implement so that multiple commands and points can be selected.\n   */\n  selectMerge(index: SelectIndex) {\n    this.selecting = {\n      ...this.selecting,\n      ...convertSelectingFromIndex(index),\n    }\n  }\n\n  unselect(index: SelectIndex) {\n    if (!this.selecting) return\n\n    const { [index.path]: unselectedPath, ...updateSelecting } = this.selecting\n\n    if (!unselectedPath) return\n    if (isSelectPathIndex(index)) {\n      this.selecting = updateSelecting\n      return\n    }\n\n    const { [index.command]: unselectedCommand, ...updateCommandSelecting } =\n      unselectedPath\n\n    if (!unselectedCommand) return\n    if (isSelectCommandIndex(index)) {\n      this.selecting = {\n        ...this.selecting,\n        [index.path]: updateCommandSelecting,\n      }\n      return\n    }\n\n    if (isSelectPointIndex(index)) {\n      this.selecting = {\n        ...this.selecting,\n        [index.path]: {\n          ...this.selecting[index.path],\n          [index.command]: unselectedCommand.filter(\n            (pointIndex) => pointIndex !== index.point\n          ),\n        },\n      }\n    }\n  }\n}\n","import { BoundingBox } from './boundingBox'\nimport { EditPath } from './editPath'\nimport { PathSelector } from './pathSelector'\nimport type {\n  SvgClass,\n  PointObject,\n  PathAttributes,\n  SelectIndex,\n  EditSvgObject,\n  CommandClass,\n  PathClass,\n  PointClass,\n  FixedType,\n} from '../types'\n\nexport class EditSvg {\n  private pathSelector = new PathSelector()\n  constructor(public svg: SvgClass) {}\n\n  /** Return true when some path selected. */\n  get selected() {\n    return this.pathSelector.selected\n  }\n\n  /** Select path index. */\n  select(index: SelectIndex, multipleSelect?: boolean) {\n    if (multipleSelect) {\n      this.pathSelector.selectMerge(index)\n      return\n    }\n    this.pathSelector.select(index)\n  }\n\n  /** Clear selected status. */\n  cancel() {\n    this.pathSelector.clear()\n  }\n\n  /** Change attributes of selected path. */\n  changeAttributes(attrs: PathAttributes) {\n    this.exec((path) => path.updateAttributes(attrs))\n  }\n\n  /** Translate position of selected path. */\n  translate(move: PointObject) {\n    this.exec(\n      (path) => path.translate(move),\n      (command) => command.translate(move),\n      (point) => point.add(move)\n    )\n  }\n\n  /** Scale the selected path. */\n  scale(r: number) {\n    this.exec(\n      (path) => path.scale(r),\n      (command) => command.scale(r),\n      (point) => point.scale(r)\n    )\n  }\n\n  /** Scale the selected path horizontally. */\n  scaleX(r: number) {\n    this.exec(\n      (path) => path.scaleX(r),\n      (command) => command.scaleX(r),\n      (point) => point.scaleX(r)\n    )\n  }\n\n  /** Scale the selected path vertically. */\n  scaleY(r: number) {\n    this.exec(\n      (path) => path.scaleY(r),\n      (command) => command.scaleY(r),\n      (point) => point.scaleY(r)\n    )\n  }\n\n  /** Resize based on the bounding box vertices */\n  resizeBoundingBox(type: FixedType, po: PointObject) {\n    const { move, scale } = new BoundingBox(this.paths).resizeParams(type, po)\n\n    this.exec((path) => path.scaleX(scale.x).scaleY(scale.y).translate(move))\n  }\n\n  /**\n   * Delete the selected path.\n   *\n   * @todo Implements to delete points.\n   */\n  delete() {\n    this.pathSelector.pathsIndex.forEach((pathKey) => {\n      const commandsIndex = this.pathSelector.getCommandsIndex(pathKey)\n\n      const path = this.svg.getPath(pathKey)\n      if (!path) return\n\n      if (!commandsIndex) {\n        this.pathSelector.unselect({ path: pathKey })\n        this.svg.deletePath(path)\n        return\n      }\n\n      commandsIndex.forEach((command) => {\n        this.pathSelector.unselect({ path: pathKey, command })\n        this.svg.updatePath(path.deleteCommand(command))\n      })\n    })\n  }\n\n  /** Clone an EditSvg class object for preview. */\n  preview(): EditSvg {\n    const preview = new EditSvg(this.svg.clone())\n    preview.pathSelector = this.pathSelector\n    return preview\n  }\n\n  /** Return data in json format. */\n  toJson(): EditSvgObject | null {\n    if (!this.pathSelector.selected) return null\n\n    const paths = this.pathSelector.pathsIndex.reduce(\n      (acc: EditSvgObject['paths'], pathKey) => {\n        const path = this.svg.paths.find((path) => path.key === pathKey)\n\n        return path\n          ? {\n              ...acc,\n              [path.key]: new EditPath(\n                path.clone(),\n                this.pathSelector\n              ).toJson(),\n            }\n          : acc\n      },\n      {}\n    )\n\n    const {\n      min: { x, y },\n      width,\n      height,\n      vertex,\n    } = new BoundingBox(this.paths)\n\n    return {\n      paths,\n      boundingBox: {\n        x,\n        y,\n        width,\n        height,\n        vertex,\n        selected: this.pathSelector.selectedPathsOnly,\n      },\n    }\n  }\n\n  private get paths(): PathClass[] {\n    return this.pathSelector.pathsIndex.flatMap((pathKey) => {\n      const path = this.svg.paths.find((path) => path.key === pathKey)\n\n      return path ? path.clone() : []\n    })\n  }\n\n  private exec(\n    pathExec: (path: PathClass) => PathClass,\n    commandExec?: (command: CommandClass) => CommandClass,\n    pointExec?: (point: PointClass) => PointClass\n  ): void {\n    this.pathSelector.pathsIndex.forEach((pathKey) => {\n      const path = this.svg.getPath(pathKey)\n      if (!path) return\n\n      const commandsIndex = this.pathSelector.getCommandsIndex(pathKey)\n      if (!commandsIndex || !commandExec) {\n        this.svg.updatePath(pathExec(path))\n        return\n      }\n\n      commandsIndex.forEach((commandKey) => {\n        const pointsIndex = this.pathSelector.getPointsIndex(\n          pathKey,\n          commandKey\n        )\n        if (!pointsIndex || !pointExec) {\n          this.svg.updatePath(path.updateCommand(commandKey, commandExec))\n          return\n        }\n\n        this.svg.updatePath(\n          path.updateCommand(commandKey, (com) => {\n            const command = com.clone()\n\n            pointsIndex.forEach((pointKey: number) => {\n              command.points[pointKey] = pointExec(command.points[pointKey])\n            })\n\n            return command\n          })\n        )\n      })\n    })\n  }\n}\n","import type {\n  PointObject,\n  PathAttributes,\n  SelectIndex,\n  FixedType,\n} from '../types'\nimport type { EditSvg } from './editSvg'\n\nexport class Editing {\n  constructor(\n    public editSvg: EditSvg,\n    /** Callback function that refreshes the screen. */\n    public updater: (eSvg: EditSvg) => void = () => void 0\n  ) {\n    this.translate = this.translate.bind(this)\n    this.translatePreview = this.translatePreview.bind(this)\n\n    this.resize = this.resize.bind(this)\n    this.resizePreview = this.resizePreview.bind(this)\n  }\n\n  /** Set the callback function to update the screen */\n  setupUpdater(upd: (eSvg: EditSvg) => void) {\n    this.updater = upd\n  }\n\n  /** Clear selected status and update screen. */\n  cancel() {\n    this.editSvg.cancel()\n    this.updater(this.editSvg)\n  }\n\n  /** Select edit path and update screen. */\n  select(index: SelectIndex, multipleSelect?: boolean) {\n    this.editSvg.select(index, multipleSelect)\n    this.updater(this.editSvg)\n  }\n\n  /** Delete path and update screen. */\n  deletePaths() {\n    this.editSvg.delete()\n    this.updater(this.editSvg)\n  }\n\n  /** Change attributes and update screen. */\n  changeAttributes(attrs: PathAttributes) {\n    this.editSvg.changeAttributes(attrs)\n    this.updater(this.editSvg)\n  }\n\n  translatePreview(po: PointObject) {\n    this.translateEditSvg(this.editSvg.preview(), po)\n  }\n\n  translate(po: PointObject) {\n    this.translateEditSvg(this.editSvg, po)\n  }\n\n  private translateEditSvg(editSvg: EditSvg, po: PointObject) {\n    editSvg.translate(po)\n    this.updater(editSvg)\n  }\n\n  resize(fixedType: FixedType, po: PointObject) {\n    this.resizeEditSvg(this.editSvg, fixedType, po)\n  }\n\n  resizePreview(fixedType: FixedType, po: PointObject) {\n    this.resizeEditSvg(this.editSvg.preview(), fixedType, po)\n  }\n\n  private resizeEditSvg(\n    editSvg: EditSvg,\n    fixedType: FixedType,\n    point: PointObject\n  ) {\n    editSvg.resizeBoundingBox(fixedType, point)\n    this.updater(editSvg)\n  }\n}\n","import { getEventPoint } from '../event'\nimport type { PointObject, ResizeBoundingBoxBase } from '../types'\nimport type { Editing } from './editing' // TODO: Replace interface\n\nexport class ResizePathHandler {\n  private resizeBoundingBoxBase: ResizeBoundingBoxBase | null = null\n  constructor(public editing: Editing) {\n    this.handleResizePathEnd = this.handleResizePathEnd.bind(this)\n    this.handleResizePathPreview = this.handleResizePathPreview.bind(this)\n  }\n\n  private getResizeMovePoint(ev: MouseEvent | TouchEvent): PointObject {\n    const po = getEventPoint(ev)\n    return {\n      x: po.x - (this.resizeBoundingBoxBase?.point.x ?? 0),\n      y: po.y - (this.resizeBoundingBoxBase?.point.y ?? 0),\n    }\n  }\n\n  private handleResizePathPreview(ev: MouseEvent | TouchEvent) {\n    if (!this.resizeBoundingBoxBase) return\n\n    this.editing.resizePreview(\n      this.resizeBoundingBoxBase.fixedType,\n      this.getResizeMovePoint(ev)\n    )\n  }\n\n  private handleResizePathEnd(ev: MouseEvent | TouchEvent) {\n    this.end()\n\n    if (!this.resizeBoundingBoxBase) return\n\n    this.editing.resize(\n      this.resizeBoundingBoxBase?.fixedType,\n      this.getResizeMovePoint(ev)\n    )\n\n    this.resizeBoundingBoxBase = null\n  }\n\n  start(base: ResizeBoundingBoxBase) {\n    this.resizeBoundingBoxBase = base\n    addEventListener('mouseup', this.handleResizePathEnd)\n    addEventListener('touchend', this.handleResizePathEnd)\n\n    addEventListener('mousemove', this.handleResizePathPreview)\n    addEventListener('touchmove', this.handleResizePathPreview)\n  }\n\n  end() {\n    removeEventListener('mouseup', this.handleResizePathEnd)\n    removeEventListener('touchend', this.handleResizePathEnd)\n\n    removeEventListener('mousemove', this.handleResizePathPreview)\n    removeEventListener('touchmove', this.handleResizePathPreview)\n  }\n}\n","import { getEventPoint } from '../event'\nimport type { PointObject } from '../types'\nimport type { Editing } from './editing' // todo: Replace interface\n\nexport class TranslatePathHandler {\n  private basePoint: PointObject | null\n\n  constructor(public editing: Editing) {\n    this.basePoint = null\n\n    this.handleTranslateEnd = this.handleTranslateEnd.bind(this)\n    this.handleTranslatePreview = this.handleTranslatePreview.bind(this)\n  }\n\n  private handleTranslatePreview(ev: MouseEvent | TouchEvent) {\n    this.editing.translatePreview(this.getTranslatePoint(ev))\n  }\n\n  private handleTranslateEnd(ev: MouseEvent | TouchEvent) {\n    this.end()\n\n    this.editing.translate(this.getTranslatePoint(ev))\n    this.basePoint = null\n  }\n\n  private getTranslatePoint(ev: MouseEvent | TouchEvent): PointObject {\n    const point = getEventPoint(ev)\n\n    return {\n      x: point.x - (this.basePoint?.x ?? 0),\n      y: point.y - (this.basePoint?.y ?? 0),\n    }\n  }\n\n  start(po: PointObject) {\n    this.basePoint = po\n\n    addEventListener('mouseup', this.handleTranslateEnd)\n    addEventListener('touchend', this.handleTranslateEnd)\n\n    addEventListener('mousemove', this.handleTranslatePreview)\n    addEventListener('touchmove', this.handleTranslatePreview)\n  }\n\n  end() {\n    removeEventListener('mouseup', this.handleTranslateEnd)\n    removeEventListener('touchend', this.handleTranslateEnd)\n\n    removeEventListener('mousemove', this.handleTranslatePreview)\n    removeEventListener('touchmove', this.handleTranslatePreview)\n  }\n}\n","import { camel2kebab } from './utils'\nimport type { PathAttributes, RendererOption, SvgObject } from './types'\n\nconst VERSION = '1.1'\nconst SVG_NS = 'http://www.w3.org/2000/svg'\nconst SVG_XLINK = 'http://www.w3.org/1999/xlink'\ninterface Attrs {\n  [key: string]: string\n}\n\nexport const createSvgElement = (\n  attrs: Attrs,\n  childs: SVGElement[]\n): SVGSVGElement => {\n  const svg = document.createElementNS(SVG_NS, 'svg')\n  svg.setAttributeNS(null, 'version', VERSION)\n  svg.setAttribute('xmlns', SVG_NS)\n  svg.setAttribute('xmlns:xlink', SVG_XLINK)\n  Object.keys(attrs)\n    .sort()\n    .map((key: string) => {\n      svg.setAttribute(key, attrs[key])\n    })\n  childs.map((el: SVGElement) => {\n    svg.appendChild(el)\n  })\n  return svg\n}\n\nexport const createSvgChildElement = <\n  T extends keyof SVGElementTagNameMap = any\n>(\n  elName: T,\n  attrs: Attrs\n): SVGElementTagNameMap[T] => {\n  const path = document.createElementNS(SVG_NS, elName)\n  Object.keys(attrs)\n    .sort()\n    .map((key: string) => {\n      path.setAttribute(key, attrs[key])\n    })\n  return path\n}\n\n/** @deprecated */\nexport const pathObjectToElement = (path: PathAttributes): SVGPathElement => {\n  const kebabAttrs = Object.entries(path).reduce(\n    (acc, [key, val], _i) =>\n      val\n        ? {\n            ...acc,\n            [camel2kebab(key)]: val,\n          }\n        : acc,\n    {}\n  )\n  return createSvgChildElement('path', kebabAttrs)\n}\n\nexport const svgObjectToElement = ({\n  width,\n  height,\n  background,\n  paths,\n}: SvgObject): SVGSVGElement => {\n  const size = { width: String(width), height: String(height) }\n  const bgEl = background\n    ? [createSvgChildElement('rect', { ...size, fill: background })]\n    : []\n  const updateEl = createSvgElement(size, [\n    ...bgEl,\n    ...paths.map(({ attributes }) => pathObjectToElement(attributes)),\n  ])\n  return updateEl\n}\n\nexport class Renderer {\n  constructor(public el: HTMLElement, { background }: RendererOption = {}) {\n    /** Setup parameter */\n    const { width, height } = this.el.getBoundingClientRect()\n    this.el.appendChild(\n      svgObjectToElement({ background, width, height, paths: [] })\n    )\n\n    this.update = this.update.bind(this)\n  }\n  /** Update render */\n  public update({ svg }: { svg: SvgObject }): void {\n    this.el.replaceChild(svgObjectToElement(svg), this.el.childNodes[0])\n  }\n}\n","export const mimeTypeMap = {\n  png: 'image/png',\n  jpg: 'image/jpeg',\n  svg: 'image/svg+xml',\n} as const\n\nconst base64ToBlob = (\n  data: string,\n  type: typeof mimeTypeMap[keyof typeof mimeTypeMap]\n) => {\n  const bin = Buffer.from(data.replace(/^.*,/, '')).toString()\n  const buffer = new Uint8Array(bin.length)\n\n  for (let i = 0; i < bin.length; i += 1) {\n    buffer[i] = bin.charCodeAt(i)\n  }\n\n  return new Blob([buffer.buffer], {\n    type,\n  })\n}\n\nexport const downloadBlob = ({\n  data,\n  extension,\n  filename,\n}: {\n  data: string\n  extension: keyof typeof mimeTypeMap\n  filename: string\n}): void => {\n  const blob = base64ToBlob(data, mimeTypeMap[extension])\n  // IE\n  if ((navigator as any).msSaveBlob) {\n    ;(navigator as any).msSaveBlob(blob, filename)\n    return\n  }\n\n  // Firefox, Chrome, Safari\n  if (URL?.createObjectURL) {\n    const a = document.createElement('a')\n    a.download = filename\n    a.href = URL.createObjectURL(blob)\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n    return\n  }\n\n  // Other\n  open(data, '_blank')\n}\n\nexport class Download {\n  private download: typeof downloadBlob\n  constructor(private el: SVGSVGElement, _download?: typeof downloadBlob) {\n    this.download = _download || downloadBlob\n  }\n\n  public svg(filename: string) {\n    this.download({\n      data: this.toBase64(),\n      extension: 'svg',\n      filename,\n    })\n  }\n\n  public png(filename: string) {\n    this.renderCanvas({\n      filename,\n      extension: 'png',\n    })\n  }\n\n  public jpg(filename: string) {\n    this.renderCanvas({\n      filename,\n      extension: 'png',\n    })\n  }\n\n  public toBase64() {\n    return `data:image/svg+xml;base64,${Buffer.from(this.el.outerHTML).toString(\n      'base64'\n    )}`\n  }\n\n  private renderCanvas({\n    filename,\n    extension,\n  }: {\n    filename: string\n    extension: 'png' | 'jpg'\n  }) {\n    const img = new Image()\n    const renderCanvas = () => {\n      const canvas = document.createElement('canvas')\n\n      canvas.setAttribute('width', String(this.el.width.animVal.value))\n      canvas.setAttribute('height', String(this.el.height.animVal.value))\n      const ctx = canvas.getContext('2d')\n      if (!ctx) return\n\n      ctx.drawImage(img, 0, 0)\n      this.download({\n        data: canvas.toDataURL(mimeTypeMap[extension]),\n        extension,\n        filename,\n      })\n    }\n    img.addEventListener('load', renderCanvas, false)\n    img.src = this.toBase64()\n  }\n}\n","import type { ResizeEventHandler, ResizeCallback } from './types'\n\nconst SUPPORT_RESIZE_OBSERVER = typeof ResizeObserver !== 'undefined'\n\n/**\n * ### Resize SVG to match element resizing\n *\n * ```ts\n * const svg = new Svg()\n * const resizeHandler = new ResizeHandler(\n *   document.getElementById('draw-area')\n * )\n *\n * resizeHandler.setHandler(({ width, height }) =>\n *   svg.resize({ width, height })\n * )\n * resizeHandler.on()\n * ```\n */\nexport class ResizeHandler implements ResizeEventHandler {\n  /** Remove EventList */\n  private _clearEventList: Array<() => void>\n  private resizeCallback: ResizeCallback\n  private width = 0\n  private height = 0\n  private threshold = 1\n  constructor(private el: HTMLElement | null = null) {\n    this.el = el\n    this.resizeCallback = () => void 0\n    this._clearEventList = []\n  }\n\n  public get active(): boolean {\n    return this._clearEventList.length > 0\n  }\n\n  public off() {\n    this._clearEventList.map((fn) => fn())\n    this._clearEventList = []\n  }\n\n  public on() {\n    this.off()\n    this._setupListener()\n  }\n\n  public setElement(el: HTMLElement) {\n    this.el = el\n    if (this.active) this.on()\n    return this\n  }\n\n  public setHandler(resizeCallback: ResizeCallback) {\n    this.resizeCallback = resizeCallback\n  }\n\n  private resize({ width, height }: { width: number; height: number }) {\n    this.width = width\n    this.height = height\n    this.resizeCallback({ width, height })\n  }\n\n  private handleResize() {\n    if (!this.el) return\n    const { width, height } = this.el.getBoundingClientRect()\n\n    if (\n      Math.abs(this.width - width) < this.threshold &&\n      Math.abs(this.height - height) < this.threshold\n    ) {\n      return\n    }\n\n    this.resize({ width, height })\n  }\n\n  private _setupListener(): void {\n    if (!this.el) return\n\n    // Initialize size\n    this.handleResize()\n\n    // ResizeObserver\n    // Use `getBoundingClientRect` because it is not fit when the size is obtained from `contentRect` of resize observe entry.\n    if (SUPPORT_RESIZE_OBSERVER) {\n      const resizeObserver = new ResizeObserver(() => this.handleResize())\n      resizeObserver.observe(this.el)\n\n      this._clearEventList.push(() => resizeObserver.disconnect())\n      return\n    }\n\n    // Fallback resize listener\n    addEventListener('resize', this.handleResize)\n    this._clearEventList.push(() =>\n      removeEventListener('resize', this.handleResize)\n    )\n  }\n}\n","import { createCommand } from './svg/command'\nimport { Path } from './svg/path'\nimport { Svg } from './svg/svg'\nimport { kebab2camel } from './utils'\nimport type { PathClass, CommandClass, CommandType, SvgClass } from './types'\n\nexport const parseSVGString = (svgStr: string): SvgClass => {\n  const svgEl: SVGSVGElement | null = new DOMParser()\n    .parseFromString(svgStr, 'image/svg+xml')\n    .querySelector('svg')\n\n  return svgEl ? parseSVGElement(svgEl) : new Svg({ width: 0, height: 0 })\n}\n\nexport const parseSVGElement = (svgEl: SVGSVGElement): SvgClass => {\n  const width = Number(svgEl.getAttribute('width'))\n  const height = Number(svgEl.getAttribute('height'))\n\n  const svg = new Svg({ width, height })\n  svgEl.querySelectorAll('path').forEach((pEl) => {\n    svg.addPath(parsePathElement(pEl))\n  })\n\n  return svg\n}\n\nexport const parsePathElement = (pathEl: SVGPathElement): PathClass => {\n  const path = new Path()\n  for (let i = 0; i < pathEl.attributes.length; i += 1) {\n    const attr: Attr | null = pathEl.attributes.item(i)\n    if (!attr || !attr.value) continue\n    if (attr.name === 'd') {\n      path.addCommand(parseCommandString(attr.value))\n      continue\n    }\n\n    path.updateAttributes({\n      [kebab2camel(attr.name)]: attr.value,\n    })\n  }\n\n  return path\n}\n\nexport const parseCommandString = (d: string): CommandClass[] => {\n  const commandsTypes = 'mlsqlhvcsqaz'\n  // expect ['M 0 0 ', 'M', ' 0 0 ', ...]\n  const regexp = new RegExp(`([${commandsTypes}])([^${commandsTypes}]*)`, 'gi')\n\n  return Array.from(d.matchAll(regexp) || []).reduce(\n    (acc: CommandClass<any>[], match: RegExpMatchArray, i) => {\n      const values: number[] =\n        match[2]\n          ?.split(/[,\\s]/)\n          ?.reduce(\n            (acc: number[], str) => (str === '' ? acc : [...acc, +str]),\n            []\n          ) || []\n      return [...acc, createCommand(match[1] as CommandType, values)]\n    },\n    []\n  )\n}\n","import { Drawing } from './drawing/drawing'\nimport { PencilHandler } from './drawing/eventHandler'\nimport { BasicDrawFactory } from './drawing/factory'\nimport { Renderer } from './renderer'\nimport { Svg } from './svg/svg'\nimport { isAlmostSameNumber } from './utils'\nimport type {\n  DrawingOption,\n  DrawEventHandler,\n  SvgClass,\n  DrawingClass,\n  PathClass,\n  ResizeCallback,\n  SvgObject,\n  EventPoint,\n} from './types'\n\n/**\n * ### Setup SvgDrawing\n *\n * ```ts\n * import { SvgDrawing } from '@svg-drawing/core'\n *\n * const el = document.getElementById('draw-area')\n * new SvgDrawing(el)\n * ```\n *\n * ### Set draw options.\n *\n * ```ts\n * // It is default value\n * const options = {\n *   penColor: '#000',\n *   penWidth: 1,\n *   curve: true,\n *   close: false,\n *   delay: 0,\n *   fill: 'none',\n *   background: undefined,\n * }\n *\n * new SvgDrawing(el, options)\n * ```\n */\nexport class SvgDrawing {\n  private svg: SvgClass\n  private drawing: DrawingClass\n  private factory: BasicDrawFactory\n  private handler: DrawEventHandler\n  private renderer: Renderer\n  constructor(\n    el: HTMLElement,\n    {\n      curve = true,\n      close = false,\n      delay = 0,\n      penColor,\n      penWidth,\n      fill,\n      background,\n    }: DrawingOption = {}\n  ) {\n    const { width, height } = el.getBoundingClientRect()\n\n    this.renderer = new Renderer(el, { background })\n\n    this.update = this.update.bind(this)\n\n    this.svg = new Svg({ width, height, background })\n\n    this.factory = new BasicDrawFactory(\n      {\n        stroke: penColor ?? '#000',\n        strokeWidth: penWidth || penWidth === 0 ? String(penWidth) : '1',\n        fill: fill ?? 'none',\n      },\n      { curve, close }\n    )\n\n    this.drawing = new Drawing(this.svg, this.factory, this.update)\n\n    const pencilHandler = new PencilHandler(this.drawing, el)\n    this.handler = pencilHandler\n    pencilHandler.changeDelay(delay)\n    this.handler.on()\n  }\n\n  public drawStart(): void {\n    this.drawing.start()\n  }\n\n  public drawMove(po: EventPoint): void {\n    this.drawing.dot(po)\n  }\n\n  public drawEnd(): void {\n    this.drawing.end()\n  }\n\n  public toJson(): SvgObject {\n    return this.svg.toJson()\n  }\n\n  public changeCurve(curve: boolean): void {\n    this.factory.changeCurve(curve)\n  }\n\n  public changeClose(close: boolean): void {\n    this.factory.changeClose(close)\n  }\n\n  public clear(): PathClass[] {\n    const paths = this.svg.paths\n    this.svg.paths = []\n    this.update()\n    return paths\n  }\n\n  public undo(): PathClass | undefined {\n    const path = this.svg.paths.pop()\n    this.update()\n    return path\n  }\n\n  private update(): void {\n    this.renderer.update({ svg: this.svg.toJson() })\n  }\n\n  public resize({ width, height }: Parameters<ResizeCallback>[0]) {\n    if (isAlmostSameNumber(this.svg.width, width)) return\n\n    this.svg.resize({ width, height })\n    this.update()\n  }\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","import { roundUp, camel2kebab } from '../utils'\nimport type {\n  PathClass,\n  AnimationOption,\n  FrameAnimation,\n  AnimateAttribute,\n  AnimationObject,\n} from '../types'\n\nconst createAnimateAttributeValues = (\n  animationPaths: (PathClass | undefined)[],\n  attributeName: string,\n  defaultValue: string\n): string[] =>\n  animationPaths.map((p) => p?.attrs[attributeName] || defaultValue)\n\nconst createAnimateCommandValues = (\n  animationPaths: (PathClass | undefined)[],\n  originPath: PathClass\n): string[] =>\n  animationPaths.map(\n    (p) => p?.getCommandString() || originPath.relativeCommands[0].toString()\n  )\n\nexport class Animation {\n  public ms: number\n  public paths: PathClass[]\n  public generator?: Generator<PathClass[], void, unknown>\n  private _frame: FrameAnimation | null = null\n  private _repeatCount?: number\n  constructor({ ms }: AnimationOption = { ms: 60 }) {\n    this.ms = ms\n    this.paths = []\n  }\n\n  /**\n   * `frame` is the number of frames to animate `repeat` is related for\n   * repeatCount of animate element attribute.\n   *\n   * @param {FramaAnimation} fn\n   * @param {{ frame?: number; repeat?: number }} opts\n   */\n  public setup(\n    frame: FrameAnimation,\n    { repeatCount, ms }: { repeatCount?: number; ms?: number } = {}\n  ): void {\n    this._frame = frame\n\n    this._repeatCount = repeatCount || undefined\n    if (ms) this.ms = ms\n\n    this.generator = this.setupGenerator()\n  }\n\n  public getFramePaths(key: number): PathClass[] {\n    const paths = this.paths.map((p) => p.clone())\n\n    if (!paths.length || !this._frame) return paths\n\n    return this._frame.animation(paths, key)\n  }\n\n  public restorePaths() {\n    return this.paths.map((p) => p.clone())\n  }\n\n  private *setupGenerator() {\n    let loopId = 0\n    let repeatCount = 0\n    if (!this._frame) return\n\n    while (!this._repeatCount || repeatCount < this._repeatCount) {\n      if (loopId > this._frame.loops) {\n        repeatCount += 1\n        loopId = 0\n      } else {\n        loopId += 1\n      }\n\n      yield this.getFramePaths(loopId)\n    }\n  }\n\n  public initialize(paths: PathClass[]) {\n    this.paths = paths.map((p) => p.clone())\n    this.generator = this.setupGenerator()\n    return this\n  }\n\n  public toJson(): AnimationObject {\n    if (!this._frame) return {}\n\n    const loop = this._frame.loops\n    const frameLoop = Array(this._frame.loops).fill(null)\n\n    const animPathsList: PathClass[][] = frameLoop.map((_: any, i: number) =>\n      this.getFramePaths(i)\n    )\n\n    const baseAttrs = {\n      repeatCount: `${this._repeatCount || `indefinite`}`,\n      dur: loop * (this.ms > 0 ? this.ms : 1) + 'ms',\n      keyTimes: frameLoop.reduce(\n        (acc: string, _, i) => acc + ';' + roundUp((i + 1) * (1 / loop), 4),\n        '0'\n      ),\n    }\n\n    return this.paths.reduce((acc: AnimationObject, basePath) => {\n      const { key, attributes } = basePath.toJson()\n\n      const animPaths = animPathsList.map((ap) =>\n        ap.find((p) => p.key === basePath.key)\n      )\n\n      // TODO: Check attribute key and value.\n      const animateAttributesList: AnimateAttribute[] = Object.keys(attributes)\n        .sort()\n        .reduce((animateAttrs: AnimateAttribute[], attributeName: string) => {\n          const defaultValue = attributes[attributeName]\n          if (!defaultValue) return animateAttrs\n\n          const values =\n            attributeName === 'd'\n              ? createAnimateCommandValues(animPaths, basePath)\n              : createAnimateAttributeValues(\n                  animPaths,\n                  attributeName,\n                  defaultValue\n                )\n          if (values.every((v) => v === defaultValue)) return animateAttrs\n\n          return [\n            ...animateAttrs,\n            {\n              ...baseAttrs,\n              attributeName: camel2kebab(attributeName),\n              values: [...values, defaultValue].join(';'),\n            },\n          ]\n        }, [])\n\n      return {\n        ...acc,\n        [key]: animateAttributesList.map((animateAttributes) => ({\n          type: 'animate',\n          attributes: animateAttributes,\n        })),\n      }\n    }, {})\n  }\n}\n","import { Animation } from './animation/animation'\nimport {\n  Renderer,\n  createSvgChildElement,\n  createSvgElement,\n  pathObjectToElement,\n} from './renderer'\nimport { Svg } from './svg/svg'\nimport type {\n  AnimationOption,\n  RendererOption,\n  ResizeCallback,\n  SvgClass,\n} from './types'\n\nexport class SvgAnimation {\n  private _stopId?: number\n  constructor(\n    public svg: SvgClass,\n    public animation: Animation,\n    private update: (svg: SvgClass) => void\n  ) {\n    this.resize = this.resize.bind(this)\n  }\n\n  public stop(): void {\n    if (!this._stopId) return\n\n    cancelAnimationFrame(this._stopId)\n    this.restore()\n  }\n\n  public restore(): void {\n    this.svg.paths = this.animation.restorePaths()\n    this.update(this.svg)\n  }\n\n  public start(): void {\n    // If do not this first, this cannot get the number of frames well.\n    this.stop()\n\n    this._setupAnimation()\n    this._startAnimation()\n  }\n\n  private _setupAnimation() {\n    this.animation.initialize(this.svg.paths)\n  }\n\n  private _updateFrame() {\n    if (!this.animation.generator) return\n\n    const result = this.animation.generator.next()\n    if (result.done) {\n      this.stop()\n      return\n    }\n\n    this.svg.paths = result.value\n    this.update(this.svg)\n  }\n\n  private _startAnimation(): void {\n    let start = 0\n\n    const frame: FrameRequestCallback = (timestamp: number) => {\n      if (timestamp - start > this.animation.ms) {\n        start = timestamp\n        this._updateFrame()\n      }\n\n      this._stopId = requestAnimationFrame(frame)\n    }\n\n    this._stopId = requestAnimationFrame(frame)\n  }\n\n  public toElement() {\n    const sizeAttributes = {\n      width: String(this.svg.width),\n      height: String(this.svg.height),\n    }\n\n    const animationJson = this.animation.toJson()\n\n    const pathEls = this.animation.paths.map((path) => {\n      const { key, attributes } = path.toJson()\n      const pathEl = pathObjectToElement(attributes)\n\n      animationJson?.[key]?.map(({ type, attributes }) => {\n        pathEl.appendChild(createSvgChildElement(type, attributes))\n      })\n\n      return pathEl\n    })\n\n    const childEls: SVGElement[] = this.svg.background\n      ? [\n          createSvgChildElement('rect', {\n            ...sizeAttributes,\n            fill: this.svg.background,\n          }),\n          ...pathEls,\n        ]\n      : pathEls\n\n    return createSvgElement(sizeAttributes, childEls)\n  }\n\n  public resize({ width, height }: Parameters<ResizeCallback>[0]): void {\n    this.stop()\n    this.svg.resize({ width, height })\n    this.animation.initialize(this.svg.paths)\n    this.start()\n  }\n\n  public static init(\n    el: HTMLElement,\n    { ms, background }: AnimationOption & RendererOption = { ms: 60 }\n  ): SvgAnimation {\n    const { width, height } = el.getBoundingClientRect()\n    return new SvgAnimation(\n      new Svg({ width, height }),\n      new Animation({ ms }),\n      (svg) => new Renderer(el, { background }).update({ svg: svg.toJson() })\n    )\n  }\n}\n"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","Drawing","svg","pathFactory","update","this","_drawPath","_drawPoints","start","bind","dot","end","_proto","prototype","createPath","addPath","po","push","updateCommands","createCommand","_extends","assign","target","i","arguments","length","source","hasOwnProperty","call","apply","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","roundNumber","num","Math","round","Point","x","y","_x","_y","scale","r","scaleX","scaleY","add","p","sub","clone","toJson","fromVector","_ref","theta","angle","PI","cos","sin","get","camel2kebab","str","replace","toLowerCase","roundUp","digits","toFixed","OtherCommand","type","values","toString","map","v","join","points","reduce","res","upd","slice","translate","Types","a","validTypes","t","some","arg","_this","acc","_","set","H","h","V","A","RelativeMove","point","_proto2","Move","_proto3","RelativeLine","_proto4","Line","_proto5","RelativeCurve","_proto6","Curve","_proto7","ShortcutCurve","_proto8","RelativeShortcutCurve","_proto9","QuadraticCurve","_proto10","RelativeQuadraticCurve","_proto11","Close","_proto12","_p","_r","isAbsoluteCommand","command","includes","isRelativeCommand","isCurveCommand","toRelativeCommand","basePoint","Error","toAbsoluteCommand","toRelativeCommands","commands","notAbsoluteCommand","undefined","toAbsoluteCommands","notRelativeCommand","Vector","rotate","fromPoint","sqrt","pow","atan2","createLineCommands","BezierCurve","_temp","ratio","create","genCommand","p1","p2","p3","p4","vPrev","vNext","cPrev","cNext","closeCommands","concat","Path","attrs","_key","genIndex","c","addCommand","param","flat","updateCommand","absoluteCommands","deleteCommand","filter","index","getCommandString","_this$relativeCommand","relativeCommands","com","_i","trim","attributes","d","setAttributes","updateAttributes","BasicDrawFactory","opts","curve","close","curveAttribute","setPathAttributes","updatePathAttributes","changeCurve","changeClose","strokeLinecap","strokeLinejoin","_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","SUPPORT_POINTER_EVENT","PointerEvent","SUPPORT_ON_TOUCH_START","ontouchstart","SUPPORT_EVENT_LISTENER_PASSIVE_OPTION","check","addEventListener","passive","removeEventListener","e","getEventPoint","ev","touche","touches","changedTouches","clientX","clientY","pressure","force","throttle","func","wait","context","args","result","timeout","previous","later","Date","now","remaining","_len","wrapArg","Array","clearTimeout","setTimeout","OffsetPosition","el","getBoundingClientRect","left","top","setElement","setup","setOffsetPosition","BaseHandler","drawing","on","off","setDrawing","_offsetPosition","_clearEventList","fn","setupListener","isActive","getPointObjectFromDrawEvent","PencilHandler","_BaseHandler","_this2","_handleStart","_handleMove","_handleEnd","_drawMoveThrottle","delay","listenerOption","changeDelay","_setupDrawListener","preventDefault","_this3","eventMap","pointer","move","flameout","touch","mouse","startClear","evname","moveClear","endClear","flameoutClear","PenHandler","_BaseHandler2","_this4","_editing","_handleProt","clearEvent","_setupCancelListener","isFrameIn","_isContainElement","contains","_this5","stopId","setInterval","document","hasFocus","clearInterval","_this6","Svg","width","height","background","paths","resize","_ref2","isFinite","pa","_this$paths","isArray","getPath","find","updatePath","path","findIndex","deletePath","clonePaths","copy","segmentPoint","bezierCurve","range","calculateCoefficient","p0","b","step","from","fallbackPointObject","BoundingBox","resizeParams","fixedType","movePoint","max","min","flatMap","prev","pts","base","_ref2$range","commandPoints","segmentPointsFromCommand","pointsX","pointsY","EditPath","selector","vertex","_loop","_curr$points$","_curr$points$2","_next$points$","_this$selector","curr","next","outlinePoints","pointIndex","getPointsIndex","pIndex","_pointIndex$includes","selected","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","convertSelectingFromIndex","isObjectEmpty","PathSelector","getCommandsIndex","pathKey","selectingCommands","selecting","Number","commandKey","_this$selecting$pathK","selectingPoints","clear","select","selectMerge","unselect","_this$selecting","unselectedPath","_index$path","updateSelecting","_toPropertyKey","isSelectPathIndex","_extends2","_extends3","_extends4","unselectedCommand","_index$command","updateCommandSelecting","isSelectCommandIndex","isSelectPointIndex","every","EditSvg","multipleSelect","pathSelector","cancel","changeAttributes","exec","resizeBoundingBox","_BoundingBox$resizePa","pathsIndex","forEach","commandsIndex","preview","_BoundingBox","_BoundingBox$min","boundingBox","selectedPathsOnly","pathExec","commandExec","pointExec","pointsIndex","pointKey","Editing","editSvg","updater","translatePreview","resizePreview","setupUpdater","deletePaths","translateEditSvg","resizeEditSvg","ResizePathHandler","editing","handleResizePathEnd","handleResizePathPreview","getResizeMovePoint","_this$resizeBoundingB","_this$resizeBoundingB2","_this$resizeBoundingB3","_this$resizeBoundingB4","resizeBoundingBoxBase","_this$resizeBoundingB5","TranslatePathHandler","handleTranslateEnd","handleTranslatePreview","getTranslatePoint","_this$basePoint$x","_this$basePoint","_this$basePoint$y","_this$basePoint2","SVG_NS","createSvgElement","childs","createElementNS","setAttributeNS","setAttribute","sort","appendChild","createSvgChildElement","elName","pathObjectToElement","kebabAttrs","entries","val","svgObjectToElement","size","String","bgEl","fill","_ref3","Renderer","_this$el$getBoundingC","_ref5","replaceChild","childNodes","mimeTypeMap","png","jpg","downloadBlob","_URL","data","extension","filename","blob","bin","Buffer","buffer","Uint8Array","charCodeAt","Blob","base64ToBlob","navigator","msSaveBlob","URL","createObjectURL","createElement","download","href","body","click","removeChild","open","Download","_download","toBase64","renderCanvas","outerHTML","img","Image","canvas","animVal","ctx","getContext","drawImage","toDataURL","src","SUPPORT_RESIZE_OBSERVER","ResizeObserver","ResizeHandler","resizeCallback","_setupListener","active","setHandler","handleResize","abs","threshold","resizeObserver","observe","disconnect","parseSVGElement","svgEl","getAttribute","querySelectorAll","pEl","parsePathElement","pathEl","_path$updateAttribute","attr","item","name","kebab2camel","toUpperCase","parseCommandString","regexp","RegExp","matchAll","match","_match$","_match$$split","split","SvgDrawing","_ref$curve","_ref$close","_ref$delay","penColor","penWidth","renderer","factory","stroke","strokeWidth","pencilHandler","handler","drawStart","drawMove","drawEnd","undo","pop","trunc","runtime","exports","Op","hasOwn","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","Context","_invoke","state","GenStateSuspendedStart","method","GenStateExecuting","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","done","GenStateSuspendedYield","makeInvokeMethod","err","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","invoke","resolve","reject","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","Promise","iter","object","reverse","skipTempReset","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","require$$0","Animation","ms","frame","_temp2","repeatCount","_frame","_repeatCount","setupGenerator","getFramePaths","animation","restorePaths","_regeneratorRuntime","loopId","_context","loops","initialize","loop","frameLoop","animPathsList","baseAttrs","dur","keyTimes","basePath","animPaths","ap","animateAttributesList","animateAttrs","attributeName","defaultValue","originPath","animationPaths","createAnimateAttributeValues","animateAttributes","SvgAnimation","_stopId","cancelAnimationFrame","restore","_setupAnimation","_startAnimation","_updateFrame","requestAnimationFrame","timestamp","toElement","sizeAttributes","animationJson","pathEls","_animationJson$key","childEls","init","svgStr","DOMParser","parseFromString","querySelector"],"mappings":"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"}