/*
 * @svg-drawing/core v5.0.1-beta.0 
 * 
 * Copyright (C) Kazuto Kamei.
 * This source code is licensed under the MIT license.
 */
"use strict";function t(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(n,e,i){this.svg=n,this.pathFactory=e,this.update=i,t(this,"_drawPath",void 0),t(this,"_drawPoints",void 0),this._drawPath=null,this._drawPoints=[],this.start=this.start.bind(this),this.dot=this.dot.bind(this),this.end=this.end.bind(this)}var e=n.prototype;return e.start=function(){this._drawPoints=[],this._drawPath=this.pathFactory.createPath(),this.svg.addPath(this._drawPath)},e.dot=function(t){this._drawPath&&(this._drawPoints.push(t),this._drawPath.updateCommands(this.pathFactory.createCommand(this._drawPoints)),this.update(this.svg))},e.end=function(){this._drawPath=null,this.update(this.svg)},n}();function e(){return e=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t},e.apply(this,arguments)}function i(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}var o=function(t){return Math.round(1e5*t)/1e5},s=function(){function n(n,e){t(this,"_x",void 0),t(this,"_y",void 0),this._x=o(n),this._y=o(e)}var e=n.prototype;return e.scale=function(t){return new n(this._x*t,this._y*t)},e.scaleX=function(t){return new n(this._x*t,this._y)},e.scaleY=function(t){return new n(this._x,this._y*t)},e.add=function(t){return new n(this._x+t.x,this._y+t.y)},e.sub=function(t){return new n(this._x-t.x,this._y-t.y)},e.clone=function(){return new n(this._x,this._y)},e.toJson=function(){return{x:this._x,y:this._y}},n.fromVector=function(t){var e=t.value,i=t.angle*Math.PI/180;return new n(Math.cos(i)*e,Math.sin(i)*e)},r(n,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}}]),n}(),a=function(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},u=function(t,n){return void 0===n&&(n=2),+t.toFixed(n)},h=function(){function t(t,n){void 0===n&&(n=[]),this.type=t,this.values=n}var n=t.prototype;return n.toString=function(){return""+this.type+this.values.map((function(t){return u(t)})).join(" ")},n.scale=function(n){return new t(this.type,this.values.map((function(t){return t*n})))},n.scaleX=function(n){return new t(this.type,this.points.reduce((function(t,e){var i=e.scale(n);return[].concat(t,[i.x,i.y])}),[]))},n.scaleY=function(n){return new t(this.type,this.points.reduce((function(t,e){var i=e.scaleY(n);return[].concat(t,[i.x,i.y])}),[]))},n.clone=function(){return new t(this.type,this.values.slice())},n.translate=function(n){return t.Types.a===this.type||(this.points=this.points.map((function(t){return t.add(n)}))),this},t.validTypes=function(n){return Object.values(t.Types).some((function(t){return t===n}))},r(t,[{key:"points",get:function(){var t=this;return this.values.reduce((function(n,e,i){return i%2?n:[].concat(n,[new s(t.values[i-1],t.values[i])])}),[])},set:function(t){t&&(this.values=t.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[]))}},{key:"point",get:function(){}}]),t}();t(h,"Types",{H:"H",h:"h",V:"V",v:"v",A:"A",a:"a"});var c=function(){function n(n){t(this,"type","m"),t(this,"relative",!1),t(this,"points",void 0),this.points=[n]}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.point.add(t))},e.scale=function(t){return new n(this.point.scale(t))},e.scaleX=function(t){return new n(this.point.scaleX(t))},e.scaleY=function(t){return new n(this.point.scaleY(t))},e.clone=function(){return new n(this.point.clone())},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[0]}}]),n}(),l=function(){function n(n){t(this,"type","M"),t(this,"points",void 0),this.points=[n]}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.point.add(t))},e.scale=function(t){return new n(this.point.scale(t))},e.scaleX=function(t){return new n(this.point.scaleX(t))},e.scaleY=function(t){return new n(this.point.scaleY(t))},e.clone=function(){return new n(this.point.clone())},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[0]}}]),n}(),f=function(){function n(n){t(this,"type","l"),t(this,"points",void 0),this.points=[n]}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.point.add(t))},e.scale=function(t){return new n(this.point.scale(t))},e.scaleX=function(t){return new n(this.point.scaleX(t))},e.scaleY=function(t){return new n(this.point.scaleY(t))},e.clone=function(){return new n(this.point.clone())},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[0]}}]),n}(),p=function(){function n(n){t(this,"type","L"),t(this,"points",void 0),this.points=[n]}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.point.add(t))},e.scale=function(t){return new n(this.point.scale(t))},e.scaleX=function(t){return new n(this.point.scaleX(t))},e.scaleY=function(t){return new n(this.point.scaleY(t))},e.clone=function(){return new n(this.point.clone())},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[0]}}]),n}(),d=function(){function n(n){this.points=n,t(this,"type","c")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scale(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[2]}}]),n}(),v=function(){function n(n){this.points=n,t(this,"type","C")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scale(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[2]}}]),n}(),m=function(){function n(n){this.points=n,t(this,"type","S")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scale(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[1]}}]),n}(),g=function(){function n(n){this.points=n,t(this,"type","s")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[1]}}]),n}(),y=function(){function n(n){this.points=n,t(this,"type","Q")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scale(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[1]}}]),n}(),w=function(){function n(n){this.points=n,t(this,"type","q")}var e=n.prototype;return e.toString=function(){return""+this.type+this.values.join(" ")},e.translate=function(t){return new n(this.points.map((function(n){return n.add(t)})))},e.scale=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleX=function(t){return new n(this.points.map((function(n){return n.scaleX(t)})))},e.scaleY=function(t){return new n(this.points.map((function(n){return n.scaleY(t)})))},e.clone=function(){return new n(this.points.map((function(t){return t.clone()})))},r(n,[{key:"values",get:function(){return this.points.reduce((function(t,n){return[].concat(t,[n.x,n.y])}),[])}},{key:"point",get:function(){return this.points[1]}}]),n}(),x=function(){function n(){t(this,"type","z")}var e=n.prototype;return e.toString=function(){return""+this.type},e.translate=function(t){return new n},e.scale=function(t){return new n},e.scaleX=function(t){return new n},e.scaleY=function(t){return new n},e.clone=function(){return new n},r(n,[{key:"values",get:function(){return[]}},{key:"points",get:function(){return[]}},{key:"point",get:function(){}}]),n}(),b=function(t,n){switch(void 0===n&&(n=[]),t){case"M":return new l(new s(n[0],n[1]));case"m":return new c(new s(n[0],n[1]));case"L":return new p(new s(n[0],n[1]));case"l":return new f(new s(n[0],n[1]));case"C":return new v([new s(n[0],n[1]),new s(n[2],n[3]),new s(n[4],n[5])]);case"c":return new d([new s(n[0],n[1]),new s(n[2],n[3]),new s(n[4],n[5])]);case"Q":return new y([new s(n[0],n[1]),new s(n[2],n[3])]);case"q":return new w([new s(n[0],n[1]),new s(n[2],n[3])]);case"S":return new m([new s(n[0],n[1]),new s(n[2],n[3])]);case"s":return new g([new s(n[0],n[1]),new s(n[2],n[3])]);case"Z":case"z":return new x;default:return new h(t,n)}},_=function(t){return["M","L","C","Q","S"].includes(t.type)},P=function(t){return["m","l","c","q","s"].includes(t.type)},E=function(t){return["c","C"].includes(t.type)},k=function(t,n){switch(t.type){case"M":return new c(t.point.sub(n));case"L":return new f(t.point.sub(n));case"C":return new d(t.points.map((function(t){return t.sub(n)})));case"Q":return new w(t.points.map((function(t){return t.sub(n)})));case"S":return new g(t.points.map((function(t){return t.sub(n)})));default:throw new Error("toRelativeCommand error")}},L=function(t,n){switch(t.type){case"m":return new l(t.point.add(n));case"l":return new p(t.point.add(n));case"c":return new v(t.points.map((function(t){return t.add(n)})));case"q":return new y(t.points.map((function(t){return t.add(n)})));case"s":return new m(t.points.map((function(t){return t.add(n)})));default:throw new Error("toAbsoluteCommand error")}},C=function(t){if(0===t.length)return[];for(var n=t[0].point,e=[t[0]],i=1;i<t.length;i+=1){var r=t[i],o=n&&_(r)?k(r,n):r.clone();n=_(r)?r.point:n&&r.point?n.add(r.point):void 0,e.push(o)}return e},S=function(t){if(0===t.length)return[];for(var n=t[0].point,e=[t[0]],i=1;i<t.length;i+=1){var r=t[i],o=n&&P(r)?L(r,n):r.clone();n=_(r)?r.point:n&&r.point?n.add(r.point):void 0,e.push(o)}return e},z=function(){function t(t,n){this.value=t,this.angle=n}var n=t.prototype;return n.scale=function(n){return new t(this.value*n,this.angle)},n.rotate=function(n){return new t(this.value,this.angle+n)},n.toJson=function(){return{value:this.value,angle:this.angle}},t.fromPoint=function(n){var e=n.x,i=n.y;return new t(Math.sqrt(Math.pow(e,2)+Math.pow(i,2)),Math.atan2(i,e)*(180/Math.PI))},t}(),j=function(t){return t.map((function(t,n){return 0===n?new l(new s(t.x,t.y)):new p(new s(t.x,t.y))}))},O=function(){function n(n){var e=(void 0===n?{}:n).ratio;t(this,"ratio",void 0),this.ratio=null!=e?e:.4,this.create=this.create.bind(this)}var e=n.prototype;return e.genCommand=function(t,n,e,i){var r=z.fromPoint(new s(e.x,e.y).sub(new s(n.x,n.y))).scale(this.ratio).value,o=s.fromVector({angle:z.fromPoint(new s(e.x,e.y).sub(new s(t.x,t.y))).angle,value:r}),a=s.fromVector({angle:z.fromPoint(new s(n.x,n.y).sub(new s(i.x,i.y))).angle,value:r}),u=new s(n.x,n.y).add(o),h=new s(e.x,e.y).add(a);return new v([u,h,new s(e.x,e.y)])},e.create=function(t){var n=[];if(t.length<3)return j(t);for(var e=0;e<t.length;e+=1)0!==e?n.push(this.genCommand(t[e-2<0?0:e-2],t[e-1],t[e],e<t.length-1?t[e+1]:t[e])):n.push(new l(new s(t[e].x,t[e].y)));return n},n}(),R=function(t){return[].concat(t,[new x])},A=function(){function n(e,i){void 0===e&&(e={}),this.attrs=e,t(this,"commands",[]),t(this,"key",void 0),this.key=i||"p"+n.genIndex()}var i=n.prototype;return i.updateCommands=function(t){return this.commands=C(t),this},i.scale=function(t){return this.updateCommands(this.commands.map((function(n){return n.scale(t)}))),this},i.scaleX=function(t){return this.updateCommands(this.commands.map((function(n){return n.scaleX(t)}))),this},i.scaleY=function(t){return this.updateCommands(this.commands.map((function(n){return n.scaleY(t)}))),this},i.addCommand=function(t){return this.updateCommands([].concat(this.commands,[t]).flat()),this},i.updateCommand=function(t,n){var e=this.absoluteCommands;return e[t]=n(e[t]),this.updateCommands(e),this},i.deleteCommand=function(t){return this.updateCommands(this.absoluteCommands.filter((function(n,e){return e!==t}))),this},i.getCommandString=function(){var t;return(null==(t=this.relativeCommands)?void 0:t.map((function(t,n){return t.toString()})).join(" ").trim())||""},i.toJson=function(){return{key:this.key,type:"path",attributes:e({},this.attrs,{d:this.getCommandString()})}},i.setAttributes=function(t){return this.attrs=t,this},i.updateAttributes=function(t){return this.attrs=e({},this.attrs,t),this},i.translate=function(t){return this.updateCommands(this.absoluteCommands.map((function(n){return n.translate(t)}))),this},i.clone=function(){return new n(e({},this.attrs),this.key).addCommand(this.commands.map((function(t){return t.clone()})))},r(n,[{key:"absoluteCommands",get:function(){return S(this.commands)}},{key:"relativeCommands",get:function(){return C(this.commands)}}]),n}();t(A,"index",0),t(A,"genIndex",(function(){return A.index+=1}));var B=function(){function t(t,n){void 0===n&&(n={}),this.attrs=t,this.opts=n,this.opts=e({curve:!0,close:!1},n)}var n=t.prototype;return n.createPath=function(){return new A(e({},this.attrs,this.curveAttribute))},n.setPathAttributes=function(t){this.attrs=t},n.updatePathAttributes=function(t){this.attrs=e({},this.attrs,t)},n.changeCurve=function(t){this.opts=e({},this.opts,{curve:t})},n.changeClose=function(t){this.opts=e({},this.opts,{curve:t})},r(t,[{key:"createCommand",get:function(){var t=this,n=this.opts.curve?(new O).create:j;return function(e){return t.opts.close?R(n(e)):n(e)}}},{key:"curveAttribute",get:function(){return{strokeLinecap:this.opts.curve?"round":"mitter",strokeLinejoin:this.opts.curve?"round":"square"}}}]),t}();function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function T(t,n){return T=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},T(t,n)}function Y(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,T(t,n)}var X="undefined"!=typeof PointerEvent,D="undefined"!=typeof ontouchstart,I=function(){try{var t=function(){return null};return addEventListener("testPassive",t,{passive:!0}),removeEventListener("testPassive",t),!0}catch(t){return!1}}(),F=function(t){if("touches"in t){var n=t.touches.length?t.touches[0]:t.changedTouches[0];return{x:n.clientX,y:n.clientY,pressure:n.force}}return{x:t.clientX,y:t.clientY,pressure:"pressure"in t?t.pressure:void 0}};function J(t,n){var e,i,r,o=null,s=0,a=function(){s=Date.now(),o=null,r=t.apply(e,i),o||(e=null,i=null)};return function(){var u=Date.now(),h=n-(u-s);e=this;for(var c=arguments.length,l=new Array(c),f=0;f<c;f++)l[f]=arguments[f];return i=l,h<=0||h>n?(o&&(clearTimeout(o),o=null),s=u,r=t.apply(e,i),o||(e=null,i=null)):o||(o=setTimeout(a,h)),r}}var N=function(){function n(n){this.el=n,t(this,"left",void 0),t(this,"top",void 0);var e=n?n.getBoundingClientRect():{left:0,top:0},i=e.left,r=e.top;this.left=i,this.top=r}var e=n.prototype;return e.setElement=function(t){this.el=t},e.setup=function(){var t=this,n=this.el;if(!n)return[];var e=function(){var e=n.getBoundingClientRect(),i=e.left,r=e.top;t.left=i,t.top=r};return e(),addEventListener("scroll",e),n.addEventListener("resize",e),[function(){removeEventListener("scroll",e),n.removeEventListener("resize",e)}]},n}(),q=function(){function n(n,e){this.drawing=n,this.el=e,t(this,"_clearEventList",void 0),t(this,"_offsetPosition",void 0),this.on=this.on.bind(this),this.off=this.off.bind(this),this.setDrawing=this.setDrawing.bind(this),this._offsetPosition=new N(e),this._clearEventList=[]}var e=n.prototype;return e.off=function(){this._clearEventList.map((function(t){return t()})),this._clearEventList=[]},e.on=function(){this.off(),this._clearEventList=[].concat(this._offsetPosition.setup(),this.setupListener())},e.setElement=function(t){this.el=t,this._offsetPosition.setElement(t),this.isActive&&this.on()},e.setDrawing=function(t){this.drawing=t,this.isActive&&this.on()},e.getPointObjectFromDrawEvent=function(t){var n=F(t),e=n.x,i=n.y,r=n.pressure;return{x:e-this._offsetPosition.left,y:i-this._offsetPosition.top,pressure:r}},r(n,[{key:"isActive",get:function(){return this._clearEventList.length>0}}]),n}(),G=function(n){function e(e,i){var r;return t(M(r=n.call(this,e,i)||this),"_drawMoveThrottle",void 0),t(M(r),"delay",20),t(M(r),"listenerOption",void 0),r.setDrawing=r.setDrawing.bind(M(r)),r._handleStart=r._handleStart.bind(M(r)),r._handleMove=r._handleMove.bind(M(r)),r._handleEnd=r._handleEnd.bind(M(r)),r._drawMoveThrottle=J(r.drawing.dot,r.delay).bind(M(r)),r.listenerOption=!!I&&{passive:!1},r}Y(e,n);var i=e.prototype;return i.changeDelay=function(t){this.delay=t,this._drawMoveThrottle=J(this.drawing.dot,this.delay),this.isActive&&this.on()},i.setDrawing=function(t){this.drawing=t,this._drawMoveThrottle=J(this.drawing.dot,this.delay),this.isActive&&this.on()},i.setupListener=function(){return X?this._setupDrawListener("pointer"):D?this._setupDrawListener("touch"):this._setupDrawListener("mouse")},i._handleStart=function(t){t.preventDefault(),this.drawing.start()},i._handleEnd=function(t){t.preventDefault(),this.drawing.end()},i._handleMove=function(t){t.preventDefault(),this._drawMoveThrottle(this.getPointObjectFromDrawEvent(t))},i._setupDrawListener=function(t){var n=this,e=this.el;if(!e)return[];var i={pointer:{start:["pointerdown"],move:["pointermove"],end:["pointerleave","pointercancel"],flameout:["pointerup"]},touch:{start:["touchstart"],move:["touchmove"],end:["touchend"],flameout:["touchcancel"]},mouse:{start:["mousedown"],move:["mousemove"],end:["mouseleave","mouseout"],flameout:["mouseup"]}}[t],r=i.start,o=i.move,s=i.end,a=i.flameout,u=r.map((function(t){return e.addEventListener(t,n._handleStart,n.listenerOption),function(){return e.removeEventListener(t,n._handleStart)}})),h=o.map((function(t){return e.addEventListener(t,n._handleMove,n.listenerOption),function(){return e.removeEventListener(t,n._handleMove)}})),c=s.map((function(t){return e.addEventListener(t,n._handleEnd,n.listenerOption),function(){return e.removeEventListener(t,n._handleEnd)}})),l=a.map((function(t){return addEventListener(t,n._handleEnd,n.listenerOption),function(){return removeEventListener(t,n._handleEnd)}}));return[].concat(u,h,c,l)},e}(q),H=function(n){function e(e,i){var r;return t(M(r=n.call(this,e,i)||this),"_editing",void 0),r._editing=!1,r._handleProt=r._handleProt.bind(M(r)),r}Y(e,n);var i=e.prototype;return i.setupListener=function(){var t=[].concat(this._setupCancelListener());return[].concat(X?this._setupDrawListener("pointer"):D?this._setupDrawListener("touch"):this._setupDrawListener("mouse"),t)},i._handleProt=function(t){t.preventDefault();var n=this._isContainElement(t);if(!this._editing&&n)return this.drawing.start(),this.drawing.dot(this.getPointObjectFromDrawEvent(t)),void(this._editing=!0);n?this.drawing.dot(this.getPointObjectFromDrawEvent(t)):(this._editing=!1,this.drawing.end())},i._isContainElement=function(t){return!!this.el&&this.el.contains(t.target)},i._setupCancelListener=function(){var t=this,n=setInterval((function(){document.hasFocus()||(t._editing=!1,t.drawing.end())}),1e3);return[function(){return clearInterval(n)}]},i._setupDrawListener=function(t){var n=this,e={touch:"touchstart",pointer:"pointerup",mouse:"mouseup"};return addEventListener(e[t],this._handleProt),[function(){removeEventListener(e[t],n._handleProt)}]},e}(q),V=function(){function n(n){var e=n.width,i=n.height,r=n.background;t(this,"paths",void 0),t(this,"width",void 0),t(this,"height",void 0),t(this,"background",void 0),this.paths=[],this.width=e,this.height=i,this.background=r}var e=n.prototype;return e.resize=function(t){var n=t.width,e=t.height;this.scale(n/this.width),this.width=n,this.height=e},e.scale=function(t){if(1!==t&&isFinite(t)&&0!==t)for(var n=0;n<this.paths.length;n+=1)this.paths[n].scale(t);return this},e.addPath=function(t){var n;Array.isArray(t)?(n=this.paths).push.apply(n,t):this.paths.push(t);return this},e.getPath=function(t){return this.paths.find((function(n){return n.key===t}))},e.updatePath=function(t){var n=this.paths.findIndex((function(n){return n.key===t.key}));return-1!==n&&(this.paths[n]=t),this},e.deletePath=function(t){return this.paths=this.paths.filter((function(n){return n.key!==t.key})),this},e.clonePaths=function(){return this.paths.map((function(t){return t.clone()}))},e.toJson=function(){return{width:this.width,height:this.height,background:this.background,paths:this.paths.map((function(t){return t.toJson()}))}},e.copy=function(t){return this.paths=t.clonePaths(),t.width&&this.width&&this.scale(this.width/t.width),this},e.clone=function(){var t=new n({width:this.width,height:this.height,background:this.background});return t.addPath(this.clonePaths()),t},n}(),U=Math.pow,Q=function(t,n){void 0===n&&(n=10);var e=function(t){var n=t[0],e=t[1],i=t[2],r=t[3],o={x:3*(e.x-n.x),y:3*(e.y-n.y)},s={x:3*(i.x-e.x)-o.x,y:3*(i.y-e.y)-o.y};return{a:{x:r.x-n.x-o.x-s.x,y:r.y-n.y-o.y-s.y},b:s,c:o}}(t),i=e.a,r=e.b,o=e.c,s=t[0],a=1/n;return Array.from({length:n+1}).map((function(t,e){return u=0===e?0:e===n?1:e*a,{x:i.x*U(u,3)+r.x*U(u,2)+o.x*u+s.x,y:i.y*U(u,3)+r.y*U(u,2)+o.y*u+s.y};var u}))},Z={x:0,y:0},W=function(){function t(t){this.paths=t}return t.prototype.resizeParams=function(t,n){var e=this.width,i=this.height;switch(t){case"LeftTop":var r={x:(e-n.x)/e,y:(i-n.y)/i};return{scale:r,move:{x:-(this.max.x*r.x-this.max.x),y:-(this.max.y*r.y-this.max.y)}};case"RightTop":var o={x:(e+n.x)/e,y:(i-n.y)/i};return{scale:o,move:{x:-(this.min.x*o.x-this.min.x),y:-(this.max.y*o.y-this.max.y)}};case"LeftBottom":var s={x:(e-n.x)/e,y:(i+n.y)/i};return{scale:s,move:{x:-(this.max.x*s.x-this.max.x),y:-(this.min.y*s.y-this.min.y)}};case"RightBottom":var a={x:(e+n.x)/e,y:(i+n.y)/i};return{scale:a,move:{x:-(this.min.x*a.x-this.min.x),y:-(this.min.y*a.y-this.min.y)}}}},r(t,[{key:"points",get:function(){return this.paths.flatMap((function(t){var n=void 0;return t.absoluteCommands.flatMap((function(t){var e=function(t,n){var e=n.base,i=n.range,r=void 0===i?10:i;if(!t.point)return[];if(E(t)){var o=e||t.points[0].toJson(),s=t.points.map((function(t){return t.toJson()}));return Q([o].concat(s),r)}return[t.point.toJson()]}(t,{base:n});return n=t.point?t.point.toJson():void 0,e}))}))}},{key:"pointsX",get:function(){return this.points.map((function(t){return t.x}))}},{key:"pointsY",get:function(){return this.points.map((function(t){return t.y}))}},{key:"min",get:function(){return 0===this.points.length?Z:{x:Math.min.apply(Math,this.pointsX),y:Math.min.apply(Math,this.pointsY)}}},{key:"max",get:function(){return 0===this.points.length?Z:{x:Math.max.apply(Math,this.pointsX),y:Math.max.apply(Math,this.pointsY)}}},{key:"width",get:function(){return this.max.x-this.min.x}},{key:"height",get:function(){return this.max.y-this.min.y}},{key:"vertex",get:function(){var t;return(t={}).LeftTop={x:this.min.x,y:this.min.y},t.RightTop={x:this.max.x,y:this.min.y},t.RightBottom={x:this.max.x,y:this.max.y},t.LeftBottom={x:this.min.x,y:this.max.y},t}}]),t}(),$=function(){function t(t,n){this.path=t,this.selector=n}return t.prototype.toJson=function(){return{key:this.path.key,d:this.path.getCommandString(),vertex:this.vertex}},r(t,[{key:"vertex",get:function(){for(var t=this,n=[],e=this.path.absoluteCommands,i=function(i){var r,o,s,a,u,h=e[i],c=e[i+1],l=[null==(r=h.points[1])?void 0:r.toJson(),null==(o=h.points[2])?void 0:o.toJson(),null==c||null==(s=c.points[0])?void 0:s.toJson()].filter((function(t){return!!t})),f=null==(a=t.selector)?void 0:a.getPointsIndex(t.path.key,i);n.push({points:h.points.map((function(n,e){var r;return{index:{path:t.path.key,command:i,point:e},value:n.toJson(),selected:null!=(r=null==f?void 0:f.includes(e))&&r}})),d:(u=l,u.reduce((function(t,n,e){return 0===e?"M "+n.x+" "+n.y:t+"L "+n.x+" "+n.y}),""))})},r=0;r<e.length;r+=1)i(r);return n}}]),t}();function K(t,n){if(null==t)return{};var e,i,r={},o=Object.keys(t);for(i=0;i<o.length;i++)e=o[i],n.indexOf(e)>=0||(r[e]=t[e]);return r}function tt(t){var n=function(t,n){if("object"!=typeof t||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,n||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"==typeof n?n:String(n)}var nt=function(t){var n,e;return(e={})[t.path]="number"==typeof t.command?((n={})[t.command]="number"==typeof t.point?[t.point]:[],n):{},e},et=function(t){return 0===Object.keys(t).length},it=function(){function n(){t(this,"selecting",{})}var i=n.prototype;return i.getCommandsIndex=function(t){var n=this.selecting[t];return n&&!et(n)?Object.keys(n).map(Number):void 0},i.getPointsIndex=function(t,n){var e,i=null==(e=this.selecting[t])?void 0:e[n];return i&&!et(i)?i:void 0},i.clear=function(){this.selecting={}},i.select=function(t){this.selecting=nt(t)},i.selectMerge=function(t){this.selecting=e({},this.selecting,nt(t))},i.unselect=function(t){if(this.selecting){var n=this.selecting,i=t.path,r=n[i],o=K(n,[i].map(tt));if(r)if(function(t){return!(!t.path||"number"==typeof t.command||"number"==typeof t.point)}(t))this.selecting=o;else{var s,a,u,h=t.command,c=r[h],l=K(r,[h].map(tt));if(c)if(function(t){return!(!t.path||"number"!=typeof t.command||"number"==typeof t.point)}(t))this.selecting=e({},this.selecting,((s={})[t.path]=l,s));else if(function(t){return!(!t.path||"number"!=typeof t.command||"number"!=typeof t.point)}(t))this.selecting=e({},this.selecting,((u={})[t.path]=e({},this.selecting[t.path],((a={})[t.command]=c.filter((function(n){return n!==t.point})),a)),u))}}},r(n,[{key:"selectedPathsOnly",get:function(){var t=this;return this.selected&&Object.keys(this.selecting).every((function(n){return t.selecting&&0===Object.keys(t.selecting[n]).length}))}},{key:"selected",get:function(){return!et(this.selecting)}},{key:"pathsIndex",get:function(){return Object.keys(this.selecting)}}]),n}(),rt=function(){function n(n){this.svg=n,t(this,"pathSelector",new it)}var i=n.prototype;return i.select=function(t,n){n?this.pathSelector.selectMerge(t):this.pathSelector.select(t)},i.cancel=function(){this.pathSelector.clear()},i.changeAttributes=function(t){this.exec((function(n){return n.updateAttributes(t)}))},i.translate=function(t){this.exec((function(n){return n.translate(t)}),(function(n){return n.translate(t)}),(function(n){return n.add(t)}))},i.scale=function(t){this.exec((function(n){return n.scale(t)}),(function(n){return n.scale(t)}),(function(n){return n.scale(t)}))},i.scaleX=function(t){this.exec((function(n){return n.scaleX(t)}),(function(n){return n.scaleX(t)}),(function(n){return n.scaleX(t)}))},i.scaleY=function(t){this.exec((function(n){return n.scaleY(t)}),(function(n){return n.scaleY(t)}),(function(n){return n.scaleY(t)}))},i.resizeBoundingBox=function(t,n){var e=new W(this.paths).resizeParams(t,n),i=e.move,r=e.scale;this.exec((function(t){return t.scaleX(r.x).scaleY(r.y).translate(i)}))},i.delete=function(){var t=this;this.pathSelector.pathsIndex.forEach((function(n){var e=t.pathSelector.getCommandsIndex(n),i=t.svg.getPath(n);if(i)return e?void e.forEach((function(e){t.pathSelector.unselect({path:n,command:e}),t.svg.updatePath(i.deleteCommand(e))})):(t.pathSelector.unselect({path:n}),void t.svg.deletePath(i))}))},i.preview=function(){var t=new n(this.svg.clone());return t.pathSelector=this.pathSelector,t},i.toJson=function(){var t=this;if(!this.pathSelector.selected)return null;var n=this.pathSelector.pathsIndex.reduce((function(n,i){var r,o=t.svg.paths.find((function(t){return t.key===i}));return o?e({},n,((r={})[o.key]=new $(o.clone(),t.pathSelector).toJson(),r)):n}),{}),i=new W(this.paths),r=i.min;return{paths:n,boundingBox:{x:r.x,y:r.y,width:i.width,height:i.height,vertex:i.vertex,selected:this.pathSelector.selectedPathsOnly}}},i.exec=function(t,n,e){var i=this;this.pathSelector.pathsIndex.forEach((function(r){var o=i.svg.getPath(r);if(o){var s=i.pathSelector.getCommandsIndex(r);s&&n?s.forEach((function(t){var s=i.pathSelector.getPointsIndex(r,t);s&&e?i.svg.updatePath(o.updateCommand(t,(function(t){var n=t.clone();return s.forEach((function(t){n.points[t]=e(n.points[t])})),n}))):i.svg.updatePath(o.updateCommand(t,n))})):i.svg.updatePath(t(o))}}))},r(n,[{key:"selected",get:function(){return this.pathSelector.selected}},{key:"paths",get:function(){var t=this;return this.pathSelector.pathsIndex.flatMap((function(n){var e=t.svg.paths.find((function(t){return t.key===n}));return e?e.clone():[]}))}}]),n}(),ot=function(){function t(t,n){void 0===n&&(n=function(){}),this.editSvg=t,this.updater=n,this.translate=this.translate.bind(this),this.translatePreview=this.translatePreview.bind(this),this.resize=this.resize.bind(this),this.resizePreview=this.resizePreview.bind(this)}var n=t.prototype;return n.setupUpdater=function(t){this.updater=t},n.cancel=function(){this.editSvg.cancel(),this.updater(this.editSvg)},n.select=function(t,n){this.editSvg.select(t,n),this.updater(this.editSvg)},n.deletePaths=function(){this.editSvg.delete(),this.updater(this.editSvg)},n.changeAttributes=function(t){this.editSvg.changeAttributes(t),this.updater(this.editSvg)},n.translatePreview=function(t){this.translateEditSvg(this.editSvg.preview(),t)},n.translate=function(t){this.translateEditSvg(this.editSvg,t)},n.translateEditSvg=function(t,n){t.translate(n),this.updater(t)},n.resize=function(t,n){this.resizeEditSvg(this.editSvg,t,n)},n.resizePreview=function(t,n){this.resizeEditSvg(this.editSvg.preview(),t,n)},n.resizeEditSvg=function(t,n,e){t.resizeBoundingBox(n,e),this.updater(t)},t}(),st=function(){function n(n){this.editing=n,t(this,"resizeBoundingBoxBase",null),this.handleResizePathEnd=this.handleResizePathEnd.bind(this),this.handleResizePathPreview=this.handleResizePathPreview.bind(this)}var e=n.prototype;return e.getResizeMovePoint=function(t){var n,e,i,r,o=F(t);return{x:o.x-(null!=(n=null==(e=this.resizeBoundingBoxBase)?void 0:e.point.x)?n:0),y:o.y-(null!=(i=null==(r=this.resizeBoundingBoxBase)?void 0:r.point.y)?i:0)}},e.handleResizePathPreview=function(t){this.resizeBoundingBoxBase&&this.editing.resizePreview(this.resizeBoundingBoxBase.fixedType,this.getResizeMovePoint(t))},e.handleResizePathEnd=function(t){var n;this.end(),this.resizeBoundingBoxBase&&(this.editing.resize(null==(n=this.resizeBoundingBoxBase)?void 0:n.fixedType,this.getResizeMovePoint(t)),this.resizeBoundingBoxBase=null)},e.start=function(t){this.resizeBoundingBoxBase=t,addEventListener("mouseup",this.handleResizePathEnd),addEventListener("touchend",this.handleResizePathEnd),addEventListener("mousemove",this.handleResizePathPreview),addEventListener("touchmove",this.handleResizePathPreview)},e.end=function(){removeEventListener("mouseup",this.handleResizePathEnd),removeEventListener("touchend",this.handleResizePathEnd),removeEventListener("mousemove",this.handleResizePathPreview),removeEventListener("touchmove",this.handleResizePathPreview)},n}(),at=function(){function n(n){this.editing=n,t(this,"basePoint",void 0),this.basePoint=null,this.handleTranslateEnd=this.handleTranslateEnd.bind(this),this.handleTranslatePreview=this.handleTranslatePreview.bind(this)}var e=n.prototype;return e.handleTranslatePreview=function(t){this.editing.translatePreview(this.getTranslatePoint(t))},e.handleTranslateEnd=function(t){this.end(),this.editing.translate(this.getTranslatePoint(t)),this.basePoint=null},e.getTranslatePoint=function(t){var n,e,i,r,o=F(t);return{x:o.x-(null!=(n=null==(e=this.basePoint)?void 0:e.x)?n:0),y:o.y-(null!=(i=null==(r=this.basePoint)?void 0:r.y)?i:0)}},e.start=function(t){this.basePoint=t,addEventListener("mouseup",this.handleTranslateEnd),addEventListener("touchend",this.handleTranslateEnd),addEventListener("mousemove",this.handleTranslatePreview),addEventListener("touchmove",this.handleTranslatePreview)},e.end=function(){removeEventListener("mouseup",this.handleTranslateEnd),removeEventListener("touchend",this.handleTranslateEnd),removeEventListener("mousemove",this.handleTranslatePreview),removeEventListener("touchmove",this.handleTranslatePreview)},n}(),ut="http://www.w3.org/2000/svg",ht=function(t,n){var e=document.createElementNS(ut,"svg");return e.setAttributeNS(null,"version","1.1"),e.setAttribute("xmlns",ut),e.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),Object.keys(t).sort().map((function(n){e.setAttribute(n,t[n])})),n.map((function(t){e.appendChild(t)})),e},ct=function(t,n){var e=document.createElementNS(ut,t);return Object.keys(n).sort().map((function(t){e.setAttribute(t,n[t])})),e},lt=function(t){var n=Object.entries(t).reduce((function(t,n,i){var r,o=n[0],s=n[1];return s?e({},t,((r={})[a(o)]=s,r)):t}),{});return ct("path",n)},ft=function(t){var n=t.width,i=t.height,r=t.background,o=t.paths,s={width:String(n),height:String(i)},a=r?[ct("rect",e({},s,{fill:r}))]:[];return ht(s,[].concat(a,o.map((function(t){var n=t.attributes;return lt(n)}))))},pt=function(){function t(t,n){var e=(void 0===n?{}:n).background;this.el=t;var i=this.el.getBoundingClientRect(),r=i.width,o=i.height;this.el.appendChild(ft({background:e,width:r,height:o,paths:[]})),this.update=this.update.bind(this)}return t.prototype.update=function(t){var n=t.svg;this.el.replaceChild(ft(n),this.el.childNodes[0])},t}(),dt={png:"image/png",jpg:"image/jpeg",svg:"image/svg+xml"},vt=function(t){var n,e=t.data,i=t.extension,r=t.filename,o=function(t,n){for(var e=Buffer.from(t.replace(/^.*,/,"")).toString(),i=new Uint8Array(e.length),r=0;r<e.length;r+=1)i[r]=e.charCodeAt(r);return new Blob([i.buffer],{type:n})}(e,dt[i]);if(navigator.msSaveBlob)navigator.msSaveBlob(o,r);else{if(null!=(n=URL)&&n.createObjectURL){var s=document.createElement("a");return s.download=r,s.href=URL.createObjectURL(o),document.body.appendChild(s),s.click(),void document.body.removeChild(s)}open(e,"_blank")}},mt=function(){function n(n,e){this.el=n,t(this,"download",void 0),this.download=e||vt}var e=n.prototype;return e.svg=function(t){this.download({data:this.toBase64(),extension:"svg",filename:t})},e.png=function(t){this.renderCanvas({filename:t,extension:"png"})},e.jpg=function(t){this.renderCanvas({filename:t,extension:"png"})},e.toBase64=function(){return"data:image/svg+xml;base64,"+Buffer.from(this.el.outerHTML).toString("base64")},e.renderCanvas=function(t){var n=this,e=t.filename,i=t.extension,r=new Image,o=function(){var t=document.createElement("canvas");t.setAttribute("width",String(n.el.width.animVal.value)),t.setAttribute("height",String(n.el.height.animVal.value));var o=t.getContext("2d");o&&(o.drawImage(r,0,0),n.download({data:t.toDataURL(dt[i]),extension:i,filename:e}))};r.addEventListener("load",o,!1),r.src=this.toBase64()},n}(),gt="undefined"!=typeof ResizeObserver,yt=function(){function n(n){void 0===n&&(n=null),this.el=n,t(this,"_clearEventList",void 0),t(this,"resizeCallback",void 0),t(this,"width",0),t(this,"height",0),t(this,"threshold",1),this.el=n,this.resizeCallback=function(){},this._clearEventList=[]}var e=n.prototype;return e.off=function(){this._clearEventList.map((function(t){return t()})),this._clearEventList=[]},e.on=function(){this.off(),this._setupListener()},e.setElement=function(t){return this.el=t,this.active&&this.on(),this},e.setHandler=function(t){this.resizeCallback=t},e.resize=function(t){var n=t.width,e=t.height;this.width=n,this.height=e,this.resizeCallback({width:n,height:e})},e.handleResize=function(){if(this.el){var t=this.el.getBoundingClientRect(),n=t.width,e=t.height;Math.abs(this.width-n)<this.threshold&&Math.abs(this.height-e)<this.threshold||this.resize({width:n,height:e})}},e._setupListener=function(){var t=this;if(this.el){if(this.handleResize(),gt){var n=new ResizeObserver((function(){return t.handleResize()}));return n.observe(this.el),void this._clearEventList.push((function(){return n.disconnect()}))}addEventListener("resize",this.handleResize),this._clearEventList.push((function(){return removeEventListener("resize",t.handleResize)}))}},r(n,[{key:"active",get:function(){return this._clearEventList.length>0}}]),n}(),wt=function(t){var n=Number(t.getAttribute("width")),e=Number(t.getAttribute("height")),i=new V({width:n,height:e});return t.querySelectorAll("path").forEach((function(t){i.addPath(xt(t))})),i},xt=function(t){for(var n,e=new A,i=0;i<t.attributes.length;i+=1){var r,o=t.attributes.item(i);o&&o.value&&("d"!==o.name?e.updateAttributes(((r={})[(n=o.name,n.replace(/-([a-z])/g,(function(t,n){return n.toUpperCase()})))]=o.value,r)):e.addCommand(bt(o.value)))}return e},bt=function(t){var n=new RegExp("([mlsqlhvcsqaz])([^mlsqlhvcsqaz]*)","gi");return Array.from(t.matchAll(n)||[]).reduce((function(t,n,e){var i,r,o=(null==(i=n[2])||null==(r=i.split(/[,\s]/))?void 0:r.reduce((function(t,n){return""===n?t:[].concat(t,[+n])}),[]))||[];return[].concat(t,[b(n[1],o)])}),[])},_t=function(){function e(e,i){var r=void 0===i?{}:i,o=r.curve,s=void 0===o||o,a=r.close,u=void 0!==a&&a,h=r.delay,c=void 0===h?0:h,l=r.penColor,f=r.penWidth,p=r.fill,d=r.background;t(this,"svg",void 0),t(this,"drawing",void 0),t(this,"factory",void 0),t(this,"handler",void 0),t(this,"renderer",void 0);var v=e.getBoundingClientRect(),m=v.width,g=v.height;this.renderer=new pt(e,{background:d}),this.update=this.update.bind(this),this.svg=new V({width:m,height:g,background:d}),this.factory=new B({stroke:null!=l?l:"#000",strokeWidth:f||0===f?String(f):"1",fill:null!=p?p:"none"},{curve:s,close:u}),this.drawing=new n(this.svg,this.factory,this.update);var y=new G(this.drawing,e);this.handler=y,y.changeDelay(c),this.handler.on()}var i=e.prototype;return i.drawStart=function(){this.drawing.start()},i.drawMove=function(t){this.drawing.dot(t)},i.drawEnd=function(){this.drawing.end()},i.toJson=function(){return this.svg.toJson()},i.changeCurve=function(t){this.factory.changeCurve(t)},i.changeClose=function(t){this.factory.changeClose(t)},i.clear=function(){var t=this.svg.paths;return this.svg.paths=[],this.update(),t},i.undo=function(){var t=this.svg.paths.pop();return this.update(),t},i.update=function(){this.renderer.update({svg:this.svg.toJson()})},i.resize=function(t){var n,e,i=t.width,r=t.height;(n=this.svg.width,e=i,Math.trunc(n)!==Math.trunc(e))&&(this.svg.resize({width:i,height:r}),this.update())},e}();function Pt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Et={exports:{}},kt={exports:{}};
/**
 * Copyright (c) 2014-present, Facebook, Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(t){var n=function(t){var n,e=Object.prototype,i=e.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",s=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function u(t,n,e,i){var r=n&&n.prototype instanceof v?n:v,o=Object.create(r.prototype),s=new C(i||[]);return o._invoke=function(t,n,e){var i=c;return function(r,o){if(i===f)throw new Error("Generator is already running");if(i===p){if("throw"===r)throw o;return z()}for(e.method=r,e.arg=o;;){var s=e.delegate;if(s){var a=E(s,e);if(a){if(a===d)continue;return a}}if("next"===e.method)e.sent=e._sent=e.arg;else if("throw"===e.method){if(i===c)throw i=p,e.arg;e.dispatchException(e.arg)}else"return"===e.method&&e.abrupt("return",e.arg);i=f;var u=h(t,n,e);if("normal"===u.type){if(i=e.done?p:l,u.arg===d)continue;return{value:u.arg,done:e.done}}"throw"===u.type&&(i=p,e.method="throw",e.arg=u.arg)}}}(t,e,s),o}function h(t,n,e){try{return{type:"normal",arg:t.call(n,e)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var c="suspendedStart",l="suspendedYield",f="executing",p="completed",d={};function v(){}function m(){}function g(){}var y={};y[o]=function(){return this};var w=Object.getPrototypeOf,x=w&&w(w(S([])));x&&x!==e&&i.call(x,o)&&(y=x);var b=g.prototype=v.prototype=Object.create(y);function _(t){["next","throw","return"].forEach((function(n){t[n]=function(t){return this._invoke(n,t)}}))}function P(t,n){function e(r,o,s,a){var u=h(t[r],t,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&i.call(l,"__await")?n.resolve(l.__await).then((function(t){e("next",t,s,a)}),(function(t){e("throw",t,s,a)})):n.resolve(l).then((function(t){c.value=t,s(c)}),(function(t){return e("throw",t,s,a)}))}a(u.arg)}var r;this._invoke=function(t,i){function o(){return new n((function(n,r){e(t,i,n,r)}))}return r=r?r.then(o,o):o()}}function E(t,e){var i=t.iterator[e.method];if(i===n){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=n,E(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=h(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,d;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,d):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function k(t){var n={tryLoc:t[0]};1 in t&&(n.catchLoc=t[1]),2 in t&&(n.finallyLoc=t[2],n.afterLoc=t[3]),this.tryEntries.push(n)}function L(t){var n=t.completion||{};n.type="normal",delete n.arg,t.completion=n}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,s=function e(){for(;++r<t.length;)if(i.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=n,e.done=!0,e};return s.next=s}}return{next:z}}function z(){return{value:n,done:!0}}return m.prototype=b.constructor=g,g.constructor=m,g[a]=m.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var n="function"==typeof t&&t.constructor;return!!n&&(n===m||"GeneratorFunction"===(n.displayName||n.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,a in t||(t[a]="GeneratorFunction")),t.prototype=Object.create(b),t},t.awrap=function(t){return{__await:t}},_(P.prototype),P.prototype[s]=function(){return this},t.AsyncIterator=P,t.async=function(n,e,i,r,o){void 0===o&&(o=Promise);var s=new P(u(n,e,i,r),o);return t.isGeneratorFunction(e)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},_(b),b[a]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},t.keys=function(t){var n=[];for(var e in t)n.push(e);return n.reverse(),function e(){for(;n.length;){var i=n.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},t.values=S,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(i,r){return a.type="throw",a.arg=t,e.next=i,r&&(e.method="next",e.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var u=i.call(s,"catchLoc"),h=i.call(s,"finallyLoc");if(u&&h){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(t,n){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=n&&n<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=n,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(s)},complete:function(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),d},finish:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),L(e),d}},catch:function(t){for(var n=this.tryEntries.length-1;n>=0;--n){var e=this.tryEntries[n];if(e.tryLoc===t){var i=e.completion;if("throw"===i.type){var r=i.arg;L(e)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:S(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=n),d}},t}(t.exports);try{regeneratorRuntime=n}catch(t){Function("r","regeneratorRuntime = r")(n)}}(kt);var Lt=Pt(Et.exports=kt.exports),Ct=function(){function n(n){var e=(void 0===n?{ms:60}:n).ms;t(this,"ms",void 0),t(this,"paths",void 0),t(this,"generator",void 0),t(this,"_frame",null),t(this,"_repeatCount",void 0),this.ms=e,this.paths=[]}var i=n.prototype;return i.setup=function(t,n){var e=void 0===n?{}:n,i=e.repeatCount,r=e.ms;this._frame=t,this._repeatCount=i||void 0,r&&(this.ms=r),this.generator=this.setupGenerator()},i.getFramePaths=function(t){var n=this.paths.map((function(t){return t.clone()}));return n.length&&this._frame?this._frame.animation(n,t):n},i.restorePaths=function(){return this.paths.map((function(t){return t.clone()}))},i.setupGenerator=Lt.mark((function t(){var n,e;return Lt.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=0,e=0,this._frame){t.next=4;break}return t.abrupt("return");case 4:if(this._repeatCount&&!(e<this._repeatCount)){t.next=10;break}return n>this._frame.loops?(e+=1,n=0):n+=1,t.next=8,this.getFramePaths(n);case 8:t.next=4;break;case 10:case"end":return t.stop()}}),t,this)})),i.initialize=function(t){return this.paths=t.map((function(t){return t.clone()})),this.generator=this.setupGenerator(),this},i.toJson=function(){var t=this;if(!this._frame)return{};var n=this._frame.loops,i=Array(this._frame.loops).fill(null),r=i.map((function(n,e){return t.getFramePaths(e)})),o={repeatCount:""+(this._repeatCount||"indefinite"),dur:n*(this.ms>0?this.ms:1)+"ms",keyTimes:i.reduce((function(t,e,i){return t+";"+u((i+1)*(1/n),4)}),"0")};return this.paths.reduce((function(t,n){var i,s=n.toJson(),u=s.key,h=s.attributes,c=r.map((function(t){return t.find((function(t){return t.key===n.key}))})),l=Object.keys(h).sort().reduce((function(t,i){var r=h[i];if(!r)return t;var s,u="d"===i?(s=n,c.map((function(t){return(null==t?void 0:t.getCommandString())||s.relativeCommands[0].toString()}))):function(t,n,e){return t.map((function(t){return(null==t?void 0:t.attrs[n])||e}))}(c,i,r);return u.every((function(t){return t===r}))?t:[].concat(t,[e({},o,{attributeName:a(i),values:[].concat(u,[r]).join(";")})])}),[]);return e({},t,((i={})[u]=l.map((function(t){return{type:"animate",attributes:t}})),i))}),{})},n}(),St=function(){function n(n,e,i){this.svg=n,this.animation=e,this.update=i,t(this,"_stopId",void 0),this.resize=this.resize.bind(this)}var i=n.prototype;return i.stop=function(){this._stopId&&(cancelAnimationFrame(this._stopId),this.restore())},i.restore=function(){this.svg.paths=this.animation.restorePaths(),this.update(this.svg)},i.start=function(){this.stop(),this._setupAnimation(),this._startAnimation()},i._setupAnimation=function(){this.animation.initialize(this.svg.paths)},i._updateFrame=function(){if(this.animation.generator){var t=this.animation.generator.next();t.done?this.stop():(this.svg.paths=t.value,this.update(this.svg))}},i._startAnimation=function(){var t=this,n=0;this._stopId=requestAnimationFrame((function e(i){i-n>t.animation.ms&&(n=i,t._updateFrame()),t._stopId=requestAnimationFrame(e)}))},i.toElement=function(){var t={width:String(this.svg.width),height:String(this.svg.height)},n=this.animation.toJson(),i=this.animation.paths.map((function(t){var e,i=t.toJson(),r=i.key,o=i.attributes,s=lt(o);return null==n||null==(e=n[r])||e.map((function(t){var n=t.type,e=t.attributes;s.appendChild(ct(n,e))})),s})),r=this.svg.background?[ct("rect",e({},t,{fill:this.svg.background}))].concat(i):i;return ht(t,r)},i.resize=function(t){var n=t.width,e=t.height;this.stop(),this.svg.resize({width:n,height:e}),this.animation.initialize(this.svg.paths),this.start()},n.init=function(t,e){var i=void 0===e?{ms:60}:e,r=i.ms,o=i.background,s=t.getBoundingClientRect(),a=s.width,u=s.height;return new n(new V({width:a,height:u}),new Ct({ms:r}),(function(n){return new pt(t,{background:o}).update({svg:n.toJson()})}))},n}();exports.Animation=Ct,exports.BaseHandler=q,exports.BasicDrawFactory=B,exports.BezierCurve=O,exports.Close=x,exports.Curve=v,exports.Download=mt,exports.Drawing=n,exports.EditPath=$,exports.EditSvg=rt,exports.Editing=ot,exports.Line=p,exports.Move=l,exports.OtherCommand=h,exports.Path=A,exports.PenHandler=H,exports.PencilHandler=G,exports.Point=s,exports.QuadraticCurve=y,exports.RelativeCurve=d,exports.RelativeLine=f,exports.RelativeMove=c,exports.RelativeQuadraticCurve=w,exports.RelativeShortcutCurve=g,exports.Renderer=pt,exports.ResizeHandler=yt,exports.ResizePathHandler=st,exports.Svg=V,exports.SvgAnimation=St,exports.SvgDrawing=_t,exports.TranslatePathHandler=at,exports.Vector=z,exports.closeCommands=R,exports.createCommand=b,exports.createLineCommands=j,exports.createSvgChildElement=ct,exports.createSvgElement=ht,exports.isAbsoluteCommand=_,exports.isCurveCommand=E,exports.isOtherCommand=function(t){return["h","H","v","V","a","A","z","Z"].includes(t.type)},exports.isRelativeCommand=P,exports.parseCommandString=bt,exports.parsePathElement=xt,exports.parseSVGElement=wt,exports.parseSVGString=function(t){var n=(new DOMParser).parseFromString(t,"image/svg+xml").querySelector("svg");return n?wt(n):new V({width:0,height:0})},exports.pathObjectToElement=lt,exports.segmentPoint=Q,exports.svgObjectToElement=ft,exports.toAbsoluteCommand=L,exports.toAbsoluteCommands=S,exports.toRelativeCommand=k,exports.toRelativeCommands=C;
//# sourceMappingURL=index.cjs.map
