{"version":3,"file":"index.umd.js","sources":["../../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/drawing/drawing.ts","../../../node_modules/@babel/runtime/helpers/esm/extends.js","../../../node_modules/@babel/runtime/helpers/esm/createClass.js","../src/svg/point.ts","../src/utils.ts","../src/svg/command.ts","../src/svg/vector.ts","../src/drawing/convert.ts","../src/svg/path.ts","../src/drawing/factory.ts","../../../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../../../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../../../node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","../src/event.ts","../src/throttle.ts","../src/drawing/eventHandler.ts","../src/svg/svg.ts","../src/edit/segment.ts","../src/edit/boundingBox.ts","../src/edit/editPath.ts","../../../node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","../src/edit/pathSelector.ts","../src/edit/editSvg.ts","../src/edit/editing.ts","../src/edit/resizePathHandler.ts","../src/edit/translatePathHandler.ts","../src/renderer.ts","../src/download.ts","../src/resize.ts","../src/parser.ts","../src/SvgDrawing.ts","../../../node_modules/regenerator-runtime/runtime.js","../../../node_modules/@babel/runtime/regenerator/index.js","../src/animation/animation.ts","../src/SvgAnimation.ts"],"sourcesContent":["export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import type { DrawingClass } from '..'\nimport type { EventPoint, DrawFactory, PathClass, SvgClass } from '../types'\n\n/**\n * ### Basic Drawing usage.\n *\n * ```ts\n * import {\n *   Svg,\n *   Drawing,\n *   PenHandler,\n *   Renderer,\n *   BasicDrawFactory,\n * } from '@svg-drawing/core'\n *\n * const el = document.getElementById('draw')\n * const { width, height } = el.getBoundingClientRect()\n *\n * new Drawing(\n *   new Svg({ width, height }),\n *   new BasicDrawFactory({ stroke: '#000' }),\n *   new PenHandler(el),\n *   new Renderer(el).update\n * )\n * ```\n */\nexport class Drawing implements DrawingClass {\n  private _drawPath: PathClass | null\n  private _drawPoints: EventPoint[]\n  constructor(\n    public svg: SvgClass,\n    public pathFactory: DrawFactory,\n    private update: (svg: SvgClass) => void\n  ) {\n    /** Setup property */\n    this._drawPath = null\n    this._drawPoints = []\n\n    /** Setup EventDrawHandler */\n    this.start = this.start.bind(this)\n    this.dot = this.dot.bind(this)\n    this.end = this.end.bind(this)\n  }\n\n  public start(): void {\n    this._drawPoints = []\n    this._drawPath = this.pathFactory.createPath()\n    this.svg.addPath(this._drawPath)\n  }\n\n  public dot(po: EventPoint): void {\n    if (!this._drawPath) return\n\n    this._drawPoints.push(po)\n    this._drawPath.updateCommands(\n      this.pathFactory.createCommand(this._drawPoints)\n    )\n\n    this.update(this.svg)\n  }\n\n  public end(): void {\n    this._drawPath = null\n    this.update(this.svg)\n  }\n}\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","import type { VectorObject, PointClass, PointObject } from '../types'\n\n/**\n * Maximum number of decimal places is 5\n *\n * @todo Changeable parameter\n */\nconst coeffecient = 100000\nconst roundNumber = (num: number) => Math.round(num * coeffecient) / coeffecient\n\nexport class Point implements PointClass {\n  private _x: number\n  private _y: number\n  constructor(x: number, y: number) {\n    this._x = roundNumber(x)\n    this._y = roundNumber(y)\n  }\n\n  public get x() {\n    return this._x\n  }\n\n  public get y() {\n    return this._y\n  }\n\n  public scale(r: number) {\n    return new Point(this._x * r, this._y * r)\n  }\n\n  public scaleX(r: number) {\n    return new Point(this._x * r, this._y)\n  }\n\n  public scaleY(r: number) {\n    return new Point(this._x, this._y * r)\n  }\n\n  public add(p: PointObject) {\n    return new Point(this._x + p.x, this._y + p.y)\n  }\n\n  public sub(p: PointObject) {\n    return new Point(this._x - p.x, this._y - p.y)\n  }\n\n  public clone() {\n    return new Point(this._x, this._y)\n  }\n\n  public toJson() {\n    return {\n      x: this._x,\n      y: this._y,\n    }\n  }\n\n  /**\n   * ### Calculate coordinate from vector.\n   *\n   * ```ts\n   * const point = Point.fromVector({ value: 1, 0 })\n   *\n   * console.log(point.x) // 0\n   * console.log(point.y) // 1\n   * ```\n   */\n  public static fromVector({ value, angle }: VectorObject): Point {\n    const theta = (angle * Math.PI) / 180\n    return new Point(Math.cos(theta) * value, Math.sin(theta) * value)\n  }\n}\n","export const camel2kebab = (str: string): string =>\n  str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n\nexport const roundUp = (num: number, digits = 2): number => +num.toFixed(digits)\n\nexport const kebab2camel = (str: string): string =>\n  str.replace(/-([a-z])/g, (a: string, b: string) => b.toUpperCase())\n\nexport const isAlmostSameNumber = (a: number, b: number) =>\n  Math.trunc(a) === Math.trunc(b)\n\nexport const isNaN = (num: number) => num !== num\n","import { Point } from './point'\nimport { roundUp } from '../utils'\nimport type {\n  CommandClass,\n  CommandType,\n  OtherCommandType,\n  PointObject,\n  PointClass,\n  AbsoluteCommandType,\n  RelativeCommandType,\n} from '../types'\n\n/** @deprecated */\nexport class OtherCommand<T extends OtherCommandType>\n  implements CommandClass<OtherCommandType>\n{\n  static Types = {\n    /**\n     * Horizontal\n     *\n     * `H 10`\n     */\n    H: 'H',\n    /**\n     * Horizontal relative\n     *\n     * `h 10`\n     */\n    h: 'h',\n    /**\n     * Vertical\n     *\n     * V 10\n     */\n    V: 'V',\n    /**\n     * Vertical relative\n     *\n     * `v 10`\n     */\n    v: 'v',\n    /**\n     * Arc curve\n     *\n     * `A 6 4 10 0 1 14 10`\n     */\n    A: 'A',\n    /**\n     * Arc curve relative\n     *\n     * `a 6 4 10 0 1 14 10`\n     */\n    a: 'a',\n  } as const\n\n  constructor(public type: T, public values: number[] = []) {}\n\n  public set points(p: PointClass[]) {\n    if (!p) return\n    this.values = p.reduce((acc: number[], p) => [...acc, p.x, p.y], [])\n  }\n\n  public get points() {\n    return this.values.reduce(\n      (acc: Point[], _, i: number) =>\n        i % 2 ? acc : [...acc, new Point(this.values[i - 1], this.values[i])],\n      []\n    )\n  }\n\n  public get point() {\n    return undefined\n  }\n\n  public toString() {\n    return `${this.type}${this.values.map((v) => roundUp(v)).join(' ')}`\n  }\n\n  public scale(r: number) {\n    const upd = new OtherCommand(\n      this.type,\n      this.values.map((p) => p * r)\n    )\n    return upd\n  }\n\n  public scaleX(r: number) {\n    return new OtherCommand(\n      this.type,\n      this.points.reduce((res: number[], po: PointClass) => {\n        const upd = po.scale(r)\n        return [...res, upd.x, upd.y]\n      }, [])\n    )\n  }\n\n  public scaleY(r: number) {\n    return new OtherCommand(\n      this.type,\n      this.points.reduce((res: number[], po: PointClass) => {\n        const upd = po.scaleY(r)\n        return [...res, upd.x, upd.y]\n      }, [])\n    )\n  }\n\n  public clone() {\n    return new OtherCommand(this.type, this.values.slice())\n  }\n\n  public translate(p: PointObject) {\n    if (OtherCommand.Types.a === this.type) return this\n    this.points = this.points.map((po) => po.add(p))\n    return this\n  }\n\n  public static validTypes(t: any): t is OtherCommandType {\n    return Object.values(OtherCommand.Types).some((arg) => arg === t)\n  }\n}\n\n/**\n * Move relative\n *\n * `m 0 0`\n */\nexport class RelativeMove implements CommandClass<'m'> {\n  public readonly type = 'm'\n  public readonly relative = false\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeMove(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new RelativeMove(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new RelativeMove(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new RelativeMove(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new RelativeMove(this.point.clone())\n  }\n}\n\n/**\n * Move\n *\n * `M 0 0`\n */\nexport class Move implements CommandClass<'M'> {\n  public readonly type = 'M'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Move(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new Move(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new Move(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new Move(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new Move(this.point.clone())\n  }\n}\n\n/**\n * Line relative\n *\n * `l 0 0`\n */\nexport class RelativeLine implements CommandClass<'l'> {\n  public readonly type = 'l'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeLine(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new RelativeLine(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new RelativeLine(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new RelativeLine(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new RelativeLine(this.point.clone())\n  }\n}\n\n/**\n * Line\n *\n * `L 0 0`\n */\nexport class Line implements CommandClass<'L'> {\n  public readonly type = 'L'\n  public points: [PointClass]\n  constructor(point: PointClass) {\n    this.points = [point]\n  }\n\n  public get values(): number[] {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[0]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Line(this.point.add(p))\n  }\n\n  public scale(r: number) {\n    return new Line(this.point.scale(r))\n  }\n\n  public scaleX(r: number) {\n    return new Line(this.point.scaleX(r))\n  }\n\n  public scaleY(r: number) {\n    return new Line(this.point.scaleY(r))\n  }\n\n  public clone() {\n    return new Line(this.point.clone())\n  }\n}\n\n/**\n * Cubic bezier curve relative\n *\n * `c 1 1 2 2 3 3`\n */\nexport class RelativeCurve implements CommandClass<'c'> {\n  public readonly type = 'c'\n  constructor(public points: [PointClass, PointClass, PointClass]) {}\n\n  public get values() {\n    return this.points.reduce((acc: number[], po) => [...acc, po.x, po.y], [])\n  }\n\n  public get point() {\n    return this.points[2]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scaleX(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeCurve(\n      this.points.map((p) => p.scaleY(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public clone() {\n    return new RelativeCurve(\n      this.points.map((po) => po.clone()) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n}\n\n/**\n * Cubic bezier curve\n *\n * `C 1 1 2 2 3 3`\n */\nexport class Curve implements CommandClass<'C'> {\n  public readonly type = 'C'\n  constructor(public points: [PointClass, PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[2]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new Curve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scaleX(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new Curve(\n      this.points.map((p) => p.scaleY(r)) as [\n        PointClass,\n        PointClass,\n        PointClass\n      ]\n    )\n  }\n\n  public clone() {\n    return new Curve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Shortcut curve\n *\n * `S 10 60 10 30`\n */\nexport class ShortcutCurve implements CommandClass<'S'> {\n  public readonly type = 'S'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new ShortcutCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new ShortcutCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new ShortcutCurve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Shortcut curve relative\n *\n * `s 10 60 10 30`\n */\nexport class RelativeShortcutCurve implements CommandClass<'s'> {\n  public readonly type = 's'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeShortcutCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeShortcutCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new RelativeShortcutCurve(\n      this.points.map((po) => po.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Quadratic curve\n *\n * Q 10 60 10 30\n */\n\nexport class QuadraticCurve implements CommandClass<'Q'> {\n  public readonly type = 'Q'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new QuadraticCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scale(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new QuadraticCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new QuadraticCurve(\n      this.points.map((p) => p.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Quadratic curve relative\n *\n * `q 10 60 10 30`\n */\nexport class RelativeQuadraticCurve implements CommandClass<'q'> {\n  public readonly type = 'q'\n  constructor(public points: [PointClass, PointClass]) {}\n\n  public get values(): [number, number, number, number] {\n    return this.points.reduce(\n      (acc: number[], po) => [...acc, po.x, po.y],\n      []\n    ) as [number, number, number, number]\n  }\n\n  public get point() {\n    return this.points[1]\n  }\n\n  public toString() {\n    return `${this.type}${this.values.join(' ')}`\n  }\n\n  public translate(p: PointObject) {\n    return new RelativeQuadraticCurve(\n      this.points.map((po) => po.add(p)) as [PointClass, PointClass]\n    )\n  }\n\n  public scale(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleX(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleX(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public scaleY(r: number) {\n    return new RelativeQuadraticCurve(\n      this.points.map((p) => p.scaleY(r)) as [PointClass, PointClass]\n    )\n  }\n\n  public clone() {\n    return new RelativeQuadraticCurve(\n      this.points.map((po) => po.clone()) as [PointClass, PointClass]\n    )\n  }\n}\n\n/**\n * Close\n *\n * 'z'\n */\nexport class Close implements CommandClass<'z'> {\n  public readonly type = 'z'\n\n  public get values(): [] {\n    return []\n  }\n\n  public get points(): [] {\n    return []\n  }\n\n  public get point() {\n    return undefined\n  }\n\n  public toString() {\n    return `${this.type}`\n  }\n\n  public translate(_p: PointObject) {\n    return new Close()\n  }\n\n  public scale(_r: number) {\n    return new Close()\n  }\n\n  public scaleX(r: number) {\n    return new Close()\n  }\n\n  public scaleY(r: number) {\n    return new Close()\n  }\n\n  public clone() {\n    return new Close()\n  }\n}\n\nexport const createCommand = (\n  type: CommandType,\n  values: number[] = []\n): CommandClass => {\n  switch (type) {\n    case 'M': {\n      return new Move(new Point(values[0], values[1]))\n    }\n    case 'm': {\n      return new RelativeMove(new Point(values[0], values[1]))\n    }\n    case 'L': {\n      return new Line(new Point(values[0], values[1]))\n    }\n    case 'l': {\n      return new RelativeLine(new Point(values[0], values[1]))\n    }\n    case 'C': {\n      return new Curve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n        new Point(values[4], values[5]),\n      ])\n    }\n    case 'c': {\n      return new RelativeCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n        new Point(values[4], values[5]),\n      ])\n    }\n    case 'Q': {\n      return new QuadraticCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'q': {\n      return new RelativeQuadraticCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'S': {\n      return new ShortcutCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 's': {\n      return new RelativeShortcutCurve([\n        new Point(values[0], values[1]),\n        new Point(values[2], values[3]),\n      ])\n    }\n    case 'Z':\n    case 'z': {\n      return new Close()\n    }\n\n    default: {\n      return new OtherCommand(type, values)\n    }\n  }\n}\n\nexport const isAbsoluteCommand = (\n  command: CommandClass\n): command is CommandClass<AbsoluteCommandType> =>\n  ['M', 'L', 'C', 'Q', 'S'].includes(command.type)\n\nexport const isRelativeCommand = (\n  command: CommandClass\n): command is CommandClass<RelativeCommandType> =>\n  ['m', 'l', 'c', 'q', 's'].includes(command.type)\n\nexport const isCurveCommand = (\n  command: CommandClass\n): command is CommandClass<'C' | 'c'> => ['c', 'C'].includes(command.type)\n\nexport const isOtherCommand = (\n  command: CommandClass\n): command is CommandClass<OtherCommandType> =>\n  ['h', 'H', 'v', 'V', 'a', 'A', 'z', 'Z'].includes(command.type)\n\nexport const toRelativeCommand = (\n  command: CommandClass<AbsoluteCommandType>,\n  basePoint: PointObject\n): CommandClass<RelativeCommandType> => {\n  switch (command.type) {\n    case 'M':\n      return new RelativeMove(command.point.sub(basePoint))\n    case 'L':\n      return new RelativeLine(command.point.sub(basePoint))\n    case 'C':\n      return new RelativeCurve(\n        command.points.map((p) => p.sub(basePoint)) as [\n          PointClass,\n          PointClass,\n          PointClass\n        ]\n      )\n    case 'Q':\n      return new RelativeQuadraticCurve(\n        command.points.map((p) => p.sub(basePoint)) as [PointClass, PointClass]\n      )\n    case 'S':\n      return new RelativeShortcutCurve(\n        command.points.map((p) => p.sub(basePoint)) as [PointClass, PointClass]\n      )\n    default:\n      throw new Error('toRelativeCommand error')\n  }\n}\n\nexport const toAbsoluteCommand = (\n  command: CommandClass<RelativeCommandType>,\n  basePoint: PointObject\n): CommandClass<AbsoluteCommandType> => {\n  switch (command.type) {\n    case 'm':\n      return new Move(command.point.add(basePoint))\n    case 'l':\n      return new Line(command.point.add(basePoint))\n    case 'c':\n      return new Curve(\n        command.points.map((p) => p.add(basePoint)) as [\n          PointClass,\n          PointClass,\n          PointClass\n        ]\n      )\n    case 'q':\n      return new QuadraticCurve(\n        command.points.map((p) => p.add(basePoint)) as [PointClass, PointClass]\n      )\n    case 's':\n      return new ShortcutCurve(\n        command.points.map((p) => p.add(basePoint)) as [PointClass, PointClass]\n      )\n    default:\n      throw new Error('toAbsoluteCommand error')\n  }\n}\n\nexport const toRelativeCommands = (\n  commands: CommandClass[]\n): CommandClass[] => {\n  if (commands.length === 0) return []\n\n  let basePoint = commands[0].point\n  const upd = [commands[0]]\n\n  for (let i = 1; i < commands.length; i += 1) {\n    const command = commands[i]\n\n    const notAbsoluteCommand =\n      basePoint && isAbsoluteCommand(command)\n        ? toRelativeCommand(command, basePoint)\n        : command.clone()\n\n    basePoint = isAbsoluteCommand(command)\n      ? command.point // Absolute point\n      : basePoint && command.point\n      ? basePoint.add(command.point) // Relative point\n      : undefined // Close\n\n    upd.push(notAbsoluteCommand)\n  }\n\n  return upd\n}\n\nexport const toAbsoluteCommands = (\n  commands: CommandClass[]\n): CommandClass[] => {\n  if (commands.length === 0) return []\n\n  let basePoint = commands[0].point\n  const upd = [commands[0]]\n\n  for (let i = 1; i < commands.length; i += 1) {\n    const command = commands[i]\n\n    const notRelativeCommand =\n      basePoint && isRelativeCommand(command)\n        ? toAbsoluteCommand(command, basePoint)\n        : command.clone()\n\n    basePoint = isAbsoluteCommand(command)\n      ? command.point // Absolute point\n      : basePoint && command.point\n      ? basePoint.add(command.point) // Relative point\n      : undefined // Close\n\n    upd.push(notRelativeCommand)\n  }\n\n  return upd\n}\n","import type { VectorClass, PointObject } from '../types'\n\nexport class Vector implements VectorClass {\n  constructor(public readonly value: number, public readonly angle: number) {}\n\n  scale(r: number) {\n    return new Vector(this.value * r, this.angle)\n  }\n\n  rotate(a: number) {\n    return new Vector(this.value, this.angle + a)\n  }\n\n  toJson() {\n    return {\n      value: this.value,\n      angle: this.angle,\n    }\n  }\n\n  /**\n   * ### Calculate angle and absolute value from origin of coordinates\n   *\n   * ```ts\n   * const vector = Vector.fromPoint({ x: 1, y: 1 })\n   *\n   * console.log(vector.angle) // 45\n   * console.log(vector.value) // 1.4142135623730951\n   * ```\n   */\n  public static fromPoint({ x, y }: PointObject): Vector {\n    return new Vector(\n      Math.sqrt(Math.pow(x, 2.0) + Math.pow(y, 2.0)),\n      Math.atan2(y, x) * (180 / Math.PI)\n    )\n  }\n}\n","import { Move, Line, Curve, Close } from '../svg/command'\nimport { Point } from '../svg/point'\nimport { Vector } from '../svg/vector'\nimport type {\n  EventPoint,\n  CommandClass,\n  PointObject,\n  ConvertOption,\n  CreateCommand,\n} from '../types'\n\nexport const createLineCommands: CreateCommand = (points) =>\n  points.map((p, i) =>\n    i === 0 ? new Move(new Point(p.x, p.y)) : new Line(new Point(p.x, p.y))\n  )\n\ninterface GenerateCommandsConverter {\n  create: CreateCommand\n}\n\nexport class BezierCurve implements GenerateCommandsConverter {\n  public ratio: number\n  constructor({ ratio }: ConvertOption = {}) {\n    this.ratio = ratio ?? 0.4\n    this.create = this.create.bind(this)\n  }\n\n  public genCommand(\n    p1: PointObject,\n    p2: PointObject,\n    p3: PointObject,\n    p4: PointObject\n  ): CommandClass {\n    const value = Vector.fromPoint(\n      new Point(p3.x, p3.y).sub(new Point(p2.x, p2.y))\n    ).scale(this.ratio).value\n\n    const vPrev = Point.fromVector({\n      angle: Vector.fromPoint(new Point(p3.x, p3.y).sub(new Point(p1.x, p1.y)))\n        .angle,\n      value,\n    })\n    const vNext = Point.fromVector({\n      angle: Vector.fromPoint(new Point(p2.x, p2.y).sub(new Point(p4.x, p4.y)))\n        .angle,\n      value,\n    })\n\n    const cPrev = new Point(p2.x, p2.y).add(vPrev)\n    const cNext = new Point(p3.x, p3.y).add(vNext)\n    return new Curve([cPrev, cNext, new Point(p3.x, p3.y)])\n  }\n\n  public create(p: EventPoint[]): CommandClass[] {\n    const commands: CommandClass[] = []\n    if (p.length < 3) {\n      return createLineCommands(p)\n    }\n    for (let i = 0; i < p.length; i += 1) {\n      if (i === 0) {\n        commands.push(new Move(new Point(p[i].x, p[i].y)))\n        continue\n      }\n      commands.push(\n        this.genCommand(\n          p[i - 2 < 0 ? 0 : i - 2],\n          p[i - 1],\n          p[i],\n          i < p.length - 1 ? p[i + 1] : p[i]\n        )\n      )\n    }\n    return commands\n  }\n}\n\nexport const closeCommands = (commands: CommandClass[]): CommandClass[] => [\n  ...commands,\n  new Close(),\n]\n","import { toAbsoluteCommands, toRelativeCommands } from './command'\nimport type {\n  PathClass,\n  CommandClass,\n  PathAttributes,\n  PointObject,\n  PathObject,\n} from '../types'\n\n/**\n * Cannot support commands that use `M` or` z` more than once.\n *\n * Not support example: `M 0 0 L 1 1 Z M 1 1 L 2 2 Z`.\n */\nexport class Path implements PathClass {\n  private static index = 0\n  private static genIndex = () => (Path.index += 1)\n  private commands: CommandClass[] = []\n  public key: string\n  constructor(public attrs: PathAttributes = {}, _key?: string) {\n    this.key = _key || `p${Path.genIndex()}`\n  }\n\n  get absoluteCommands(): CommandClass[] {\n    return toAbsoluteCommands(this.commands)\n  }\n\n  get relativeCommands(): CommandClass[] {\n    return toRelativeCommands(this.commands)\n  }\n\n  updateCommands(commands: CommandClass[]) {\n    this.commands = toRelativeCommands(commands)\n\n    return this\n  }\n\n  scale(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scale(r)))\n    return this\n  }\n\n  scaleX(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scaleX(r)))\n    return this\n  }\n\n  scaleY(r: number) {\n    this.updateCommands(this.commands.map((c: CommandClass) => c.scaleY(r)))\n    return this\n  }\n\n  addCommand(param: CommandClass | CommandClass[]) {\n    this.updateCommands([...this.commands, param].flat())\n    return this\n  }\n\n  updateCommand(\n    i: number,\n    update: (absoluteCommand: CommandClass) => CommandClass\n  ) {\n    const commands = this.absoluteCommands\n    commands[i] = update(commands[i])\n\n    this.updateCommands(commands)\n    return this\n  }\n\n  deleteCommand(i: number) {\n    this.updateCommands(this.absoluteCommands.filter((_, index) => index !== i))\n    return this\n  }\n\n  getCommandString() {\n    return (\n      this.relativeCommands\n        ?.map((com: CommandClass, _i: number) => com.toString())\n        .join(' ')\n        .trim() || ''\n    )\n  }\n\n  toJson(): PathObject {\n    return {\n      key: this.key,\n      type: 'path',\n      attributes: {\n        ...this.attrs,\n        d: this.getCommandString(),\n      },\n    }\n  }\n\n  setAttributes(attrs: PathAttributes) {\n    this.attrs = attrs\n\n    return this\n  }\n\n  updateAttributes(attrs: PathAttributes) {\n    this.attrs = {\n      ...this.attrs,\n      ...attrs,\n    }\n\n    return this\n  }\n\n  translate(po: PointObject) {\n    this.updateCommands(this.absoluteCommands.map((com) => com.translate(po)))\n\n    return this\n  }\n\n  clone() {\n    return new Path(\n      {\n        ...this.attrs,\n      },\n      this.key\n    ).addCommand(this.commands.map((c) => c.clone()))\n  }\n}\n","import { BezierCurve, closeCommands, createLineCommands } from './convert'\nimport { Path } from '../svg/path'\nimport type {\n  CreateCommand,\n  DrawFactory,\n  PathAttributes,\n  PathClass,\n} from '../types'\n\nexport class BasicDrawFactory implements DrawFactory {\n  constructor(\n    private attrs: PathAttributes,\n    private opts: { curve?: boolean; close?: boolean } = {}\n  ) {\n    this.opts = {\n      curve: true,\n      close: false,\n      ...opts,\n    }\n  }\n\n  createPath(): PathClass {\n    return new Path({\n      ...this.attrs,\n      ...this.curveAttribute,\n    })\n  }\n\n  get createCommand(): CreateCommand {\n    const createCommand = this.opts.curve\n      ? new BezierCurve().create\n      : createLineCommands\n\n    return (po) =>\n      this.opts.close ? closeCommands(createCommand(po)) : createCommand(po)\n  }\n\n  setPathAttributes(attrs: PathAttributes) {\n    this.attrs = attrs\n  }\n\n  updatePathAttributes(attrs: PathAttributes) {\n    this.attrs = {\n      ...this.attrs,\n      ...attrs,\n    }\n  }\n\n  changeCurve(curve: boolean) {\n    this.opts = {\n      ...this.opts,\n      curve,\n    }\n  }\n\n  changeClose(curve: boolean) {\n    this.opts = {\n      ...this.opts,\n      curve,\n    }\n  }\n\n  get curveAttribute() {\n    return {\n      strokeLinecap: this.opts.curve ? 'round' : 'mitter',\n      strokeLinejoin: this.opts.curve ? 'round' : 'square',\n    }\n  }\n}\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","import type { EventPoint } from './types'\n\nexport const SUPPORT_POINTER_EVENT = typeof PointerEvent !== 'undefined'\n\nexport const SUPPORT_ON_TOUCH_START = typeof ontouchstart !== 'undefined'\n\nexport const SUPPORT_EVENT_LISTENER_PASSIVE_OPTION = (() => {\n  try {\n    const check = () => null\n    addEventListener('testPassive', check, { passive: true })\n    removeEventListener('testPassive', check)\n    return true\n  } catch (e) {\n    return false\n  }\n})()\n\nexport const getEventPoint = (\n  ev: MouseEvent | TouchEvent | PointerEvent\n): EventPoint => {\n  if ('touches' in ev) {\n    const touche = ev.touches.length ? ev.touches[0] : ev.changedTouches[0]\n    return {\n      x: touche.clientX,\n      y: touche.clientY,\n      pressure: touche.force,\n    }\n  }\n\n  return {\n    x: ev.clientX,\n    y: ev.clientY,\n    pressure: 'pressure' in ev ? ev.pressure : undefined,\n  }\n}\n","/**\n * ```ts\n * const handleMouseMove = throttle(\n *   (ev) => console.log(ev.target.clientX, ev.target.clientY),\n *   50\n * )\n *\n * window.addEventListener('onmousemove', handleMouseMove)\n * ```\n */\nexport function throttle<T extends (...args: any) => any>(\n  func: T,\n  wait: number\n): (...args: Parameters<T>) => ReturnType<T> | null {\n  let context: any | null\n  let args: any | null\n  let result: ReturnType<T> | null\n  let timeout: any | null = null\n  let previous = 0\n\n  const later = (): void => {\n    previous = Date.now()\n    timeout = null\n    result = func.apply(context, args)\n    if (!timeout) {\n      context = null\n      args = null\n    }\n  }\n\n  return function wrap(\n    this: typeof func,\n    ...wrapArg: Parameters<T>\n  ): ReturnType<T> | null {\n    const now = Date.now()\n    const remaining = wait - (now - previous)\n    context = this\n    args = wrapArg\n    if (remaining <= 0 || remaining > wait) {\n      if (timeout) {\n        clearTimeout(timeout)\n        timeout = null\n      }\n      previous = now\n      result = func.apply(context, args)\n      if (!timeout) {\n        context = null\n        args = null\n      }\n    } else if (!timeout) {\n      timeout = setTimeout(later, remaining)\n    }\n    return result\n  }\n}\n","import {\n  getEventPoint,\n  SUPPORT_EVENT_LISTENER_PASSIVE_OPTION,\n  SUPPORT_ON_TOUCH_START,\n  SUPPORT_POINTER_EVENT,\n} from '../event'\nimport { throttle } from '../throttle'\nimport type { DrawingClass } from '..'\nimport type {\n  DrawListenerType,\n  DrawEventHandler,\n  ClearListener,\n  EventPoint,\n  DrawEventName,\n} from '../types'\n\nclass OffsetPosition {\n  left: number\n  top: number\n  constructor(private el?: HTMLElement) {\n    const { left, top } = el ? el.getBoundingClientRect() : { left: 0, top: 0 }\n\n    this.left = left\n    this.top = top\n  }\n\n  setElement(el: HTMLElement) {\n    this.el = el\n  }\n\n  setup(): Array<ClearListener> {\n    const el = this.el\n    if (!el) return []\n\n    const setOffsetPosition = () => {\n      const { left, top } = el.getBoundingClientRect()\n      this.left = left\n      this.top = top\n    }\n\n    setOffsetPosition()\n    addEventListener('scroll', setOffsetPosition)\n    el.addEventListener('resize', setOffsetPosition)\n    return [\n      () => {\n        removeEventListener('scroll', setOffsetPosition)\n        el.removeEventListener('resize', setOffsetPosition)\n      },\n    ]\n  }\n}\n\nexport abstract class BaseHandler implements DrawEventHandler {\n  /** Remove EventList */\n  private _clearEventList: Array<ClearListener>\n  /** Offset coordinates */\n  private _offsetPosition: OffsetPosition\n\n  constructor(\n    protected drawing: DrawingClass,\n    protected el?: HTMLElement | undefined\n  ) {\n    // Bind method\n    this.on = this.on.bind(this)\n    this.off = this.off.bind(this)\n    this.setDrawing = this.setDrawing.bind(this)\n\n    // Set offset coordinates\n    this._offsetPosition = new OffsetPosition(el)\n    this._clearEventList = []\n  }\n\n  public get isActive(): boolean {\n    return this._clearEventList.length > 0\n  }\n\n  public off() {\n    this._clearEventList.map((fn) => fn())\n    this._clearEventList = []\n  }\n\n  public on() {\n    this.off()\n\n    this._clearEventList = [\n      ...this._offsetPosition.setup(),\n      ...this.setupListener(),\n    ]\n  }\n\n  public setElement(el: HTMLElement) {\n    this.el = el\n    this._offsetPosition.setElement(el)\n\n    if (this.isActive) this.on()\n  }\n\n  public setDrawing(drawing: DrawingClass) {\n    this.drawing = drawing\n    if (this.isActive) this.on()\n  }\n\n  public getPointObjectFromDrawEvent(\n    ev: MouseEvent | TouchEvent | PointerEvent\n  ): EventPoint {\n    const { x, y, pressure } = getEventPoint(ev)\n\n    return {\n      x: x - this._offsetPosition.left,\n      y: y - this._offsetPosition.top,\n      pressure,\n    }\n  }\n\n  protected abstract setupListener(): Array<ClearListener>\n}\n\nexport class PencilHandler extends BaseHandler {\n  private _drawMoveThrottle: DrawingClass['dot']\n  private delay = 20\n  /** AddEventListener Options */\n  private listenerOption: { passive: boolean } | false\n  constructor(drawing: DrawingClass, el?: HTMLElement) {\n    super(drawing, el)\n\n    // Bind methods\n    this.setDrawing = this.setDrawing.bind(this)\n    this._handleStart = this._handleStart.bind(this)\n    this._handleMove = this._handleMove.bind(this)\n    this._handleEnd = this._handleEnd.bind(this)\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay).bind(this)\n\n    this.listenerOption = SUPPORT_EVENT_LISTENER_PASSIVE_OPTION\n      ? { passive: false }\n      : false\n  }\n\n  public changeDelay(delay: number): void {\n    this.delay = delay\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay)\n\n    if (this.isActive) this.on()\n  }\n\n  public setDrawing(drawing: DrawingClass) {\n    this.drawing = drawing\n    this._drawMoveThrottle = throttle(this.drawing.dot, this.delay)\n\n    if (this.isActive) this.on()\n  }\n\n  protected setupListener(): Array<ClearListener> {\n    if (SUPPORT_POINTER_EVENT) return this._setupDrawListener('pointer')\n\n    if (SUPPORT_ON_TOUCH_START) return this._setupDrawListener('touch')\n\n    return this._setupDrawListener('mouse')\n  }\n\n  private _handleStart(ev: TouchEvent | MouseEvent | PointerEvent) {\n    ev.preventDefault()\n    this.drawing.start()\n  }\n\n  private _handleEnd(ev: TouchEvent | MouseEvent | PointerEvent) {\n    ev.preventDefault()\n    this.drawing.end()\n  }\n\n  private _handleMove(ev: MouseEvent | PointerEvent | TouchEvent) {\n    ev.preventDefault()\n    this._drawMoveThrottle(this.getPointObjectFromDrawEvent(ev))\n  }\n\n  private _setupDrawListener(type: DrawListenerType): Array<() => void> {\n    const el = this.el\n    if (!el) return []\n\n    const eventMap: Record<\n      DrawListenerType,\n      {\n        start: Array<DrawEventName>\n        move: Array<DrawEventName>\n        end: Array<DrawEventName>\n        flameout: Array<DrawEventName>\n      }\n    > = {\n      pointer: {\n        start: ['pointerdown'],\n        move: ['pointermove'],\n        end: ['pointerleave', 'pointercancel'],\n        flameout: ['pointerup'],\n      },\n      touch: {\n        start: ['touchstart'],\n        move: ['touchmove'],\n        end: ['touchend'],\n        flameout: ['touchcancel'],\n      },\n      mouse: {\n        start: ['mousedown'],\n        move: ['mousemove'],\n        end: ['mouseleave', 'mouseout'],\n        flameout: ['mouseup'],\n      },\n    }\n\n    const { start, move, end, flameout } = eventMap[type]\n\n    const startClear = start.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleStart, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleStart)\n    })\n\n    const moveClear = move.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleMove, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleMove)\n    })\n\n    const endClear = end.map((evname): ClearListener => {\n      el.addEventListener(evname, this._handleEnd, this.listenerOption)\n      return () => el.removeEventListener(evname, this._handleEnd)\n    })\n\n    const flameoutClear = flameout.map((evname): ClearListener => {\n      addEventListener(evname, this._handleEnd, this.listenerOption)\n      return () => removeEventListener(evname, this._handleEnd)\n    })\n\n    return [...startClear, ...moveClear, ...endClear, ...flameoutClear]\n  }\n}\n\nexport class PenHandler extends BaseHandler {\n  private _editing: boolean\n  constructor(drawing: DrawingClass, el?: HTMLElement) {\n    super(drawing, el)\n    this._editing = false\n    this._handleProt = this._handleProt.bind(this)\n  }\n\n  protected setupListener(): Array<ClearListener> {\n    const clearEvent: ClearListener[] = [...this._setupCancelListener()]\n    if (SUPPORT_POINTER_EVENT)\n      return [...this._setupDrawListener('pointer'), ...clearEvent]\n\n    if (SUPPORT_ON_TOUCH_START)\n      return [...this._setupDrawListener('touch'), ...clearEvent]\n\n    return [...this._setupDrawListener('mouse'), ...clearEvent]\n  }\n\n  private _handleProt(ev: MouseEvent | PointerEvent | TouchEvent) {\n    ev.preventDefault()\n    const isFrameIn = this._isContainElement(ev)\n    if (!this._editing && isFrameIn) {\n      this.drawing.start()\n      this.drawing.dot(this.getPointObjectFromDrawEvent(ev))\n      this._editing = true\n      return\n    }\n\n    if (isFrameIn) {\n      this.drawing.dot(this.getPointObjectFromDrawEvent(ev))\n      return\n    }\n\n    // end\n    this._editing = false\n    this.drawing.end()\n  }\n\n  private _isContainElement(\n    ev: MouseEvent | PointerEvent | TouchEvent\n  ): boolean {\n    if (!this.el) return false\n    return this.el.contains(ev.target as any)\n  }\n\n  private _setupCancelListener() {\n    const stopId = setInterval(() => {\n      if (!document.hasFocus()) {\n        this._editing = false\n        this.drawing.end()\n      }\n    }, 1000)\n    return [() => clearInterval(stopId)]\n  }\n\n  private _setupDrawListener(type: DrawListenerType): Array<ClearListener> {\n    const eventMap: Record<DrawListenerType, DrawEventName> = {\n      touch: 'touchstart',\n      pointer: 'pointerup',\n      mouse: 'mouseup',\n    }\n\n    addEventListener(eventMap[type], this._handleProt)\n    return [\n      () => {\n        removeEventListener(eventMap[type], this._handleProt)\n      },\n    ]\n  }\n}\n","import type { SvgOption, PathClass, SvgClass } from '../types'\n\nexport class Svg implements SvgClass {\n  public paths: PathClass[]\n  public width: number\n  public height: number\n  public background?: string\n\n  constructor({ width, height, background }: SvgOption) {\n    this.paths = []\n    this.width = width\n    this.height = height\n    this.background = background\n  }\n\n  public resize({ width, height }: { width: number; height: number }) {\n    this.scale(width / this.width)\n    this.width = width\n    this.height = height\n  }\n\n  private scale(r: number) {\n    if (r !== 1 && isFinite(r) && r !== 0) {\n      for (let i = 0; i < this.paths.length; i += 1) {\n        this.paths[i].scale(r)\n      }\n    }\n    return this\n  }\n\n  public addPath(pa: PathClass | PathClass[]) {\n    if (Array.isArray(pa)) {\n      this.paths.push(...pa)\n    } else {\n      this.paths.push(pa)\n    }\n    return this\n  }\n\n  public getPath(key: string): PathClass | undefined {\n    return this.paths.find((p) => p.key === key)\n  }\n\n  public updatePath(path: PathClass) {\n    const index = this.paths.findIndex((p) => p.key === path.key)\n    if (index !== -1) {\n      this.paths[index] = path\n    }\n    return this\n  }\n\n  public deletePath(deletePath: PathClass) {\n    this.paths = this.paths.filter((path) => path.key !== deletePath.key)\n    return this\n  }\n\n  public clonePaths() {\n    return this.paths.map((p) => p.clone())\n  }\n\n  public toJson() {\n    return {\n      width: this.width,\n      height: this.height,\n      background: this.background,\n      paths: this.paths.map((p) => p.toJson()),\n    }\n  }\n\n  /**\n   * Copy resized paths.\n   *\n   * @example\n   *\n   * ```ts\n   * const drawSvg = new Svg()\n   * const animateSvg = new Svg().copy(drawSvg)\n   * ```\n   */\n  public copy(svg: SvgClass) {\n    this.paths = svg.clonePaths()\n    if (svg.width && this.width) {\n      this.scale(this.width / svg.width)\n    }\n    return this\n  }\n\n  public clone() {\n    const svg = new Svg({\n      width: this.width,\n      height: this.height,\n      background: this.background,\n    })\n    svg.addPath(this.clonePaths())\n    return svg\n  }\n}\n","import { isCurveCommand } from '../svg/command'\nimport type { PointObject, CommandClass } from '../types'\n\ntype BezierCurvePoint = [PointObject, PointObject, PointObject, PointObject]\n\n/**\n * A cubic Bezier curve is defined by four points. Two are endpoints. (x0,y0) is\n * the origin endpoint. (x3,y3) is the destination endpoint. The points (x1,y1)\n * and (x2,y2) are control points.\n *\n * Two equations define the points on the curve. Both are evaluated for an\n * arbitrary number of values of t between 0 and 1. One equation yields values\n * for x, the other yields values for y. As increasing values for t are supplied\n * to the equations, the point defined by x(t),y(t) moves from the origin to the\n * destination. This is how the equations are defined in Adobe's PostScript references.\n *\n * X(t) = A(x) * pow(t, 3) + B(x) * pow(t, 2) + C(x) * t + x0\n *\n * Y(t) = A(y) * pow(t, 3) + B(y) * pow(t, 2) + c(y) * t + y0\n *\n * This method of definition can be reverse-engineered so that it'll give up the\n * coefficient values based on the points described above:\n *\n * C(x) = 3 (x1 - x0)\n *\n * B(x) = 3 (x2 - x1) - cx\n *\n * A(x) = x3 - x0 - cx - bx\n *\n * C(y) = 3 (y1 - y0)\n *\n * B(y) = 3 (y2 - y1) - cy\n *\n * A(y) = y3 - y0 - cy - by\n *\n * {@link https://www.moshplant.com/direct-or/bezier/math.html}\n */\nexport const calculateCoefficient = ([p0, p1, p2, p3]: BezierCurvePoint): {\n  a: PointObject\n  b: PointObject\n  c: PointObject\n} => {\n  const c = {\n    x: 3 * (p1.x - p0.x),\n    y: 3 * (p1.y - p0.y),\n  }\n\n  const b = {\n    x: 3 * (p2.x - p1.x) - c.x,\n    y: 3 * (p2.y - p1.y) - c.y,\n  }\n\n  const a = {\n    x: p3.x - p0.x - c.x - b.x,\n    y: p3.y - p0.y - c.y - b.y,\n  }\n\n  return { a, b, c }\n}\n\nconst { pow } = Math\n\n/** @todo Compatible for Quadratic and shortcut curve. */\nexport const segmentPoint = (\n  bezierCurve: BezierCurvePoint,\n  range = 10\n): PointObject[] => {\n  const { a, b, c } = calculateCoefficient(bezierCurve)\n  const p = bezierCurve[0]\n\n  const calc = (t: number): PointObject => ({\n    x: a.x * pow(t, 3) + b.x * pow(t, 2) + c.x * t + p.x,\n    y: a.y * pow(t, 3) + b.y * pow(t, 2) + c.y * t + p.y,\n  })\n\n  const step = 1 / range\n  return Array.from({ length: range + 1 }).map((_, i) =>\n    calc(i === 0 ? 0 : i === range ? 1 : i * step)\n  )\n}\n\n/** @todo Compatible for Quadratic and shortcut curve */\nexport const segmentPointsFromCommand = (\n  command: CommandClass,\n  {\n    base,\n    range = 10,\n  }: {\n    base?: PointObject\n    range?: number\n  }\n): PointObject[] => {\n  if (!command.point) return []\n\n  if (isCurveCommand(command)) {\n    const basePoint = base || (command.points[0].toJson() as PointObject)\n    const commandPoints = command.points.map((p) => p.toJson()) as [\n      PointObject,\n      PointObject,\n      PointObject\n    ]\n\n    return segmentPoint([basePoint, ...commandPoints], range)\n  }\n\n  return [command.point.toJson()]\n}\n","import { segmentPointsFromCommand } from './segment'\nimport type { PointObject, FixedType, PathClass } from '../types'\n\nconst fallbackPointObject: PointObject = { x: 0, y: 0 }\n\nexport class BoundingBox {\n  constructor(private paths: PathClass[]) {}\n\n  private get points(): PointObject[] {\n    return this.paths.flatMap((path) => {\n      let prev: PointObject | undefined = undefined\n\n      return path.absoluteCommands.flatMap((command) => {\n        const pts: PointObject[] = segmentPointsFromCommand(command, {\n          base: prev,\n        })\n\n        prev = command.point ? command.point.toJson() : undefined\n\n        return pts\n      })\n    })\n  }\n\n  private get pointsX(): number[] {\n    return this.points.map((point) => point.x)\n  }\n\n  private get pointsY(): number[] {\n    return this.points.map((point) => point.y)\n  }\n\n  get min(): PointObject {\n    if (this.points.length === 0) return fallbackPointObject\n\n    return {\n      x: Math.min(...this.pointsX),\n      y: Math.min(...this.pointsY),\n    }\n  }\n\n  get max(): PointObject {\n    if (this.points.length === 0) return fallbackPointObject\n\n    return {\n      x: Math.max(...this.pointsX),\n      y: Math.max(...this.pointsY),\n    }\n  }\n\n  get width(): number {\n    return this.max.x - this.min.x\n  }\n\n  get height(): number {\n    return this.max.y - this.min.y\n  }\n\n  get vertex(): Record<FixedType, PointObject> {\n    return {\n      ['LeftTop']: { x: this.min.x, y: this.min.y },\n      ['RightTop']: { x: this.max.x, y: this.min.y },\n      ['RightBottom']: { x: this.max.x, y: this.max.y },\n      ['LeftBottom']: { x: this.min.x, y: this.max.y },\n    }\n  }\n\n  public resizeParams(\n    fixedType: FixedType,\n    movePoint: PointObject\n  ): { scale: PointObject; move: PointObject } {\n    const width = this.width\n    const height = this.height\n\n    switch (fixedType) {\n      case 'LeftTop': {\n        const scale = {\n          x: (width - movePoint.x) / width,\n          y: (height - movePoint.y) / height,\n        }\n        const move = {\n          x: -(this.max.x * scale.x - this.max.x),\n          y: -(this.max.y * scale.y - this.max.y),\n        }\n        return { scale, move }\n      }\n      case 'RightTop': {\n        const scale = {\n          x: (width + movePoint.x) / width,\n          y: (height - movePoint.y) / height,\n        }\n        return {\n          scale,\n          move: {\n            x: -(this.min.x * scale.x - this.min.x),\n            y: -(this.max.y * scale.y - this.max.y),\n          },\n        }\n      }\n      case 'LeftBottom': {\n        const scale = {\n          x: (width - movePoint.x) / width,\n          y: (height + movePoint.y) / height,\n        }\n\n        return {\n          scale,\n          move: {\n            x: -(this.max.x * scale.x - this.max.x),\n            y: -(this.min.y * scale.y - this.min.y),\n          },\n        }\n      }\n      case 'RightBottom': {\n        const scale = {\n          x: (width + movePoint.x) / width,\n          y: (height + movePoint.y) / height,\n        }\n        return {\n          scale,\n          move: {\n            x: -(this.min.x * scale.x - this.min.x),\n            y: -(this.min.y * scale.y - this.min.y),\n          },\n        }\n      }\n    }\n  }\n}\n","import type {\n  PointObject,\n  EditVertex,\n  EditPathObject,\n  PathClass,\n} from '../types'\nimport type { PathSelector } from './pathSelector'\n\nconst genOutline = (points: PointObject[]) =>\n  points.reduce(\n    (str, po, i) => (i === 0 ? `M ${po.x} ${po.y}` : str + `L ${po.x} ${po.y}`),\n    ''\n  )\n\nexport class EditPath {\n  constructor(private path: PathClass, private selector: PathSelector) {}\n\n  public toJson(): EditPathObject {\n    return {\n      key: this.path.key,\n      d: this.path.getCommandString(),\n      vertex: this.vertex,\n    }\n  }\n\n  private get vertex(): EditVertex[] {\n    const vertex: EditVertex[] = []\n    const commands = this.path.absoluteCommands\n\n    for (let c = 0; c < commands.length; c += 1) {\n      const curr = commands[c]\n      const next = commands[c + 1]\n\n      const outlinePoints: PointObject[] = [\n        curr.points[1]?.toJson(),\n        curr.points[2]?.toJson(),\n        next?.points[0]?.toJson(),\n      ].filter((p): p is PointObject => !!p)\n\n      const pointIndex = this.selector?.getPointsIndex(this.path.key, c)\n\n      vertex.push({\n        points: curr.points.map((point, pIndex) => ({\n          index: {\n            path: this.path.key,\n            command: c,\n            point: pIndex,\n          },\n          value: point.toJson(),\n          selected: pointIndex?.includes(pIndex) ?? false,\n        })),\n        d: genOutline(outlinePoints),\n      })\n    }\n\n    return vertex\n  }\n}\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import type {\n  SelectIndex,\n  SelectPathIndex,\n  SelectCommandIndex,\n  SelectPointIndex,\n  PathObject,\n} from '../types'\n\ntype Selecting = Record<PathObject['key'], SelectingCommands>\ntype SelectingCommands = Record<number, SelectingPoints>\ntype SelectingPoints = Array<number>\n\nconst convertSelectingFromIndex = (index: SelectIndex): Selecting => ({\n  [index.path]:\n    typeof index.command === 'number'\n      ? {\n          [index.command]: typeof index.point === 'number' ? [index.point] : [],\n        }\n      : {},\n})\n\nconst isSelectPathIndex = (index: SelectIndex): index is SelectPathIndex =>\n  !!(\n    index.path &&\n    typeof index.command !== 'number' &&\n    typeof index.point !== 'number'\n  )\n\nconst isSelectCommandIndex = (\n  index: SelectIndex\n): index is SelectCommandIndex =>\n  !!(\n    index.path &&\n    typeof index.command === 'number' &&\n    typeof index.point !== 'number'\n  )\n\nconst isSelectPointIndex = (index: SelectIndex): index is SelectPointIndex =>\n  !!(\n    index.path &&\n    typeof index.command === 'number' &&\n    typeof index.point === 'number'\n  )\n\nconst isObjectEmpty = (obj: object): obj is Record<any, never> =>\n  Object.keys(obj).length === 0\n\nexport class PathSelector {\n  private selecting: Selecting = {}\n\n  get selectedPathsOnly(): boolean {\n    return (\n      this.selected &&\n      Object.keys(this.selecting).every(\n        (key: string) =>\n          this.selecting && Object.keys(this.selecting[key]).length === 0\n      )\n    )\n  }\n\n  get selected(): boolean {\n    return !isObjectEmpty(this.selecting)\n  }\n\n  get pathsIndex(): string[] {\n    return Object.keys(this.selecting)\n  }\n\n  getCommandsIndex(pathKey: string): number[] | undefined {\n    const selectingCommands = this.selecting[pathKey]\n\n    return selectingCommands && !isObjectEmpty(selectingCommands)\n      ? Object.keys(selectingCommands).map(Number)\n      : undefined\n  }\n\n  getPointsIndex(pathKey: string, commandKey: number): number[] | undefined {\n    const selectingPoints = this.selecting[pathKey]?.[commandKey]\n\n    return selectingPoints && !isObjectEmpty(selectingPoints)\n      ? selectingPoints\n      : undefined\n  }\n\n  clear() {\n    this.selecting = {}\n  }\n\n  select(index: SelectIndex) {\n    this.selecting = convertSelectingFromIndex(index)\n  }\n\n  /**\n   * Currently, only path indexes are supported.\n   *\n   * @todo Implement so that multiple commands and points can be selected.\n   */\n  selectMerge(index: SelectIndex) {\n    this.selecting = {\n      ...this.selecting,\n      ...convertSelectingFromIndex(index),\n    }\n  }\n\n  unselect(index: SelectIndex) {\n    if (!this.selecting) return\n\n    const { [index.path]: unselectedPath, ...updateSelecting } = this.selecting\n\n    if (!unselectedPath) return\n    if (isSelectPathIndex(index)) {\n      this.selecting = updateSelecting\n      return\n    }\n\n    const { [index.command]: unselectedCommand, ...updateCommandSelecting } =\n      unselectedPath\n\n    if (!unselectedCommand) return\n    if (isSelectCommandIndex(index)) {\n      this.selecting = {\n        ...this.selecting,\n        [index.path]: updateCommandSelecting,\n      }\n      return\n    }\n\n    if (isSelectPointIndex(index)) {\n      this.selecting = {\n        ...this.selecting,\n        [index.path]: {\n          ...this.selecting[index.path],\n          [index.command]: unselectedCommand.filter(\n            (pointIndex) => pointIndex !== index.point\n          ),\n        },\n      }\n    }\n  }\n}\n","import { BoundingBox } from './boundingBox'\nimport { EditPath } from './editPath'\nimport { PathSelector } from './pathSelector'\nimport type {\n  SvgClass,\n  PointObject,\n  PathAttributes,\n  SelectIndex,\n  EditSvgObject,\n  CommandClass,\n  PathClass,\n  PointClass,\n  FixedType,\n} from '../types'\n\nexport class EditSvg {\n  private pathSelector = new PathSelector()\n  constructor(public svg: SvgClass) {}\n\n  /** Return true when some path selected. */\n  get selected() {\n    return this.pathSelector.selected\n  }\n\n  /** Select path index. */\n  select(index: SelectIndex, multipleSelect?: boolean) {\n    if (multipleSelect) {\n      this.pathSelector.selectMerge(index)\n      return\n    }\n    this.pathSelector.select(index)\n  }\n\n  /** Clear selected status. */\n  cancel() {\n    this.pathSelector.clear()\n  }\n\n  /** Change attributes of selected path. */\n  changeAttributes(attrs: PathAttributes) {\n    this.exec((path) => path.updateAttributes(attrs))\n  }\n\n  /** Translate position of selected path. */\n  translate(move: PointObject) {\n    this.exec(\n      (path) => path.translate(move),\n      (command) => command.translate(move),\n      (point) => point.add(move)\n    )\n  }\n\n  /** Scale the selected path. */\n  scale(r: number) {\n    this.exec(\n      (path) => path.scale(r),\n      (command) => command.scale(r),\n      (point) => point.scale(r)\n    )\n  }\n\n  /** Scale the selected path horizontally. */\n  scaleX(r: number) {\n    this.exec(\n      (path) => path.scaleX(r),\n      (command) => command.scaleX(r),\n      (point) => point.scaleX(r)\n    )\n  }\n\n  /** Scale the selected path vertically. */\n  scaleY(r: number) {\n    this.exec(\n      (path) => path.scaleY(r),\n      (command) => command.scaleY(r),\n      (point) => point.scaleY(r)\n    )\n  }\n\n  /** Resize based on the bounding box vertices */\n  resizeBoundingBox(type: FixedType, po: PointObject) {\n    const { move, scale } = new BoundingBox(this.paths).resizeParams(type, po)\n\n    this.exec((path) => path.scaleX(scale.x).scaleY(scale.y).translate(move))\n  }\n\n  /**\n   * Delete the selected path.\n   *\n   * @todo Implements to delete points.\n   */\n  delete() {\n    this.pathSelector.pathsIndex.forEach((pathKey) => {\n      const commandsIndex = this.pathSelector.getCommandsIndex(pathKey)\n\n      const path = this.svg.getPath(pathKey)\n      if (!path) return\n\n      if (!commandsIndex) {\n        this.pathSelector.unselect({ path: pathKey })\n        this.svg.deletePath(path)\n        return\n      }\n\n      commandsIndex.forEach((command) => {\n        this.pathSelector.unselect({ path: pathKey, command })\n        this.svg.updatePath(path.deleteCommand(command))\n      })\n    })\n  }\n\n  /** Clone an EditSvg class object for preview. */\n  preview(): EditSvg {\n    const preview = new EditSvg(this.svg.clone())\n    preview.pathSelector = this.pathSelector\n    return preview\n  }\n\n  /** Return data in json format. */\n  toJson(): EditSvgObject | null {\n    if (!this.pathSelector.selected) return null\n\n    const paths = this.pathSelector.pathsIndex.reduce(\n      (acc: EditSvgObject['paths'], pathKey) => {\n        const path = this.svg.paths.find((path) => path.key === pathKey)\n\n        return path\n          ? {\n              ...acc,\n              [path.key]: new EditPath(\n                path.clone(),\n                this.pathSelector\n              ).toJson(),\n            }\n          : acc\n      },\n      {}\n    )\n\n    const {\n      min: { x, y },\n      width,\n      height,\n      vertex,\n    } = new BoundingBox(this.paths)\n\n    return {\n      paths,\n      boundingBox: {\n        x,\n        y,\n        width,\n        height,\n        vertex,\n        selected: this.pathSelector.selectedPathsOnly,\n      },\n    }\n  }\n\n  private get paths(): PathClass[] {\n    return this.pathSelector.pathsIndex.flatMap((pathKey) => {\n      const path = this.svg.paths.find((path) => path.key === pathKey)\n\n      return path ? path.clone() : []\n    })\n  }\n\n  private exec(\n    pathExec: (path: PathClass) => PathClass,\n    commandExec?: (command: CommandClass) => CommandClass,\n    pointExec?: (point: PointClass) => PointClass\n  ): void {\n    this.pathSelector.pathsIndex.forEach((pathKey) => {\n      const path = this.svg.getPath(pathKey)\n      if (!path) return\n\n      const commandsIndex = this.pathSelector.getCommandsIndex(pathKey)\n      if (!commandsIndex || !commandExec) {\n        this.svg.updatePath(pathExec(path))\n        return\n      }\n\n      commandsIndex.forEach((commandKey) => {\n        const pointsIndex = this.pathSelector.getPointsIndex(\n          pathKey,\n          commandKey\n        )\n        if (!pointsIndex || !pointExec) {\n          this.svg.updatePath(path.updateCommand(commandKey, commandExec))\n          return\n        }\n\n        this.svg.updatePath(\n          path.updateCommand(commandKey, (com) => {\n            const command = com.clone()\n\n            pointsIndex.forEach((pointKey: number) => {\n              command.points[pointKey] = pointExec(command.points[pointKey])\n            })\n\n            return command\n          })\n        )\n      })\n    })\n  }\n}\n","import type {\n  PointObject,\n  PathAttributes,\n  SelectIndex,\n  FixedType,\n} from '../types'\nimport type { EditSvg } from './editSvg'\n\nexport class Editing {\n  constructor(\n    public editSvg: EditSvg,\n    /** Callback function that refreshes the screen. */\n    public updater: (eSvg: EditSvg) => void = () => void 0\n  ) {\n    this.translate = this.translate.bind(this)\n    this.translatePreview = this.translatePreview.bind(this)\n\n    this.resize = this.resize.bind(this)\n    this.resizePreview = this.resizePreview.bind(this)\n  }\n\n  /** Set the callback function to update the screen */\n  setupUpdater(upd: (eSvg: EditSvg) => void) {\n    this.updater = upd\n  }\n\n  /** Clear selected status and update screen. */\n  cancel() {\n    this.editSvg.cancel()\n    this.updater(this.editSvg)\n  }\n\n  /** Select edit path and update screen. */\n  select(index: SelectIndex, multipleSelect?: boolean) {\n    this.editSvg.select(index, multipleSelect)\n    this.updater(this.editSvg)\n  }\n\n  /** Delete path and update screen. */\n  deletePaths() {\n    this.editSvg.delete()\n    this.updater(this.editSvg)\n  }\n\n  /** Change attributes and update screen. */\n  changeAttributes(attrs: PathAttributes) {\n    this.editSvg.changeAttributes(attrs)\n    this.updater(this.editSvg)\n  }\n\n  translatePreview(po: PointObject) {\n    this.translateEditSvg(this.editSvg.preview(), po)\n  }\n\n  translate(po: PointObject) {\n    this.translateEditSvg(this.editSvg, po)\n  }\n\n  private translateEditSvg(editSvg: EditSvg, po: PointObject) {\n    editSvg.translate(po)\n    this.updater(editSvg)\n  }\n\n  resize(fixedType: FixedType, po: PointObject) {\n    this.resizeEditSvg(this.editSvg, fixedType, po)\n  }\n\n  resizePreview(fixedType: FixedType, po: PointObject) {\n    this.resizeEditSvg(this.editSvg.preview(), fixedType, po)\n  }\n\n  private resizeEditSvg(\n    editSvg: EditSvg,\n    fixedType: FixedType,\n    point: PointObject\n  ) {\n    editSvg.resizeBoundingBox(fixedType, point)\n    this.updater(editSvg)\n  }\n}\n","import { getEventPoint } from '../event'\nimport type { PointObject, ResizeBoundingBoxBase } from '../types'\nimport type { Editing } from './editing' // TODO: Replace interface\n\nexport class ResizePathHandler {\n  private resizeBoundingBoxBase: ResizeBoundingBoxBase | null = null\n  constructor(public editing: Editing) {\n    this.handleResizePathEnd = this.handleResizePathEnd.bind(this)\n    this.handleResizePathPreview = this.handleResizePathPreview.bind(this)\n  }\n\n  private getResizeMovePoint(ev: MouseEvent | TouchEvent): PointObject {\n    const po = getEventPoint(ev)\n    return {\n      x: po.x - (this.resizeBoundingBoxBase?.point.x ?? 0),\n      y: po.y - (this.resizeBoundingBoxBase?.point.y ?? 0),\n    }\n  }\n\n  private handleResizePathPreview(ev: MouseEvent | TouchEvent) {\n    if (!this.resizeBoundingBoxBase) return\n\n    this.editing.resizePreview(\n      this.resizeBoundingBoxBase.fixedType,\n      this.getResizeMovePoint(ev)\n    )\n  }\n\n  private handleResizePathEnd(ev: MouseEvent | TouchEvent) {\n    this.end()\n\n    if (!this.resizeBoundingBoxBase) return\n\n    this.editing.resize(\n      this.resizeBoundingBoxBase?.fixedType,\n      this.getResizeMovePoint(ev)\n    )\n\n    this.resizeBoundingBoxBase = null\n  }\n\n  start(base: ResizeBoundingBoxBase) {\n    this.resizeBoundingBoxBase = base\n    addEventListener('mouseup', this.handleResizePathEnd)\n    addEventListener('touchend', this.handleResizePathEnd)\n\n    addEventListener('mousemove', this.handleResizePathPreview)\n    addEventListener('touchmove', this.handleResizePathPreview)\n  }\n\n  end() {\n    removeEventListener('mouseup', this.handleResizePathEnd)\n    removeEventListener('touchend', this.handleResizePathEnd)\n\n    removeEventListener('mousemove', this.handleResizePathPreview)\n    removeEventListener('touchmove', this.handleResizePathPreview)\n  }\n}\n","import { getEventPoint } from '../event'\nimport type { PointObject } from '../types'\nimport type { Editing } from './editing' // todo: Replace interface\n\nexport class TranslatePathHandler {\n  private basePoint: PointObject | null\n\n  constructor(public editing: Editing) {\n    this.basePoint = null\n\n    this.handleTranslateEnd = this.handleTranslateEnd.bind(this)\n    this.handleTranslatePreview = this.handleTranslatePreview.bind(this)\n  }\n\n  private handleTranslatePreview(ev: MouseEvent | TouchEvent) {\n    this.editing.translatePreview(this.getTranslatePoint(ev))\n  }\n\n  private handleTranslateEnd(ev: MouseEvent | TouchEvent) {\n    this.end()\n\n    this.editing.translate(this.getTranslatePoint(ev))\n    this.basePoint = null\n  }\n\n  private getTranslatePoint(ev: MouseEvent | TouchEvent): PointObject {\n    const point = getEventPoint(ev)\n\n    return {\n      x: point.x - (this.basePoint?.x ?? 0),\n      y: point.y - (this.basePoint?.y ?? 0),\n    }\n  }\n\n  start(po: PointObject) {\n    this.basePoint = po\n\n    addEventListener('mouseup', this.handleTranslateEnd)\n    addEventListener('touchend', this.handleTranslateEnd)\n\n    addEventListener('mousemove', this.handleTranslatePreview)\n    addEventListener('touchmove', this.handleTranslatePreview)\n  }\n\n  end() {\n    removeEventListener('mouseup', this.handleTranslateEnd)\n    removeEventListener('touchend', this.handleTranslateEnd)\n\n    removeEventListener('mousemove', this.handleTranslatePreview)\n    removeEventListener('touchmove', this.handleTranslatePreview)\n  }\n}\n","import { camel2kebab } from './utils'\nimport type { PathAttributes, RendererOption, SvgObject } from './types'\n\nconst VERSION = '1.1'\nconst SVG_NS = 'http://www.w3.org/2000/svg'\nconst SVG_XLINK = 'http://www.w3.org/1999/xlink'\ninterface Attrs {\n  [key: string]: string\n}\n\nexport const createSvgElement = (\n  attrs: Attrs,\n  childs: SVGElement[]\n): SVGSVGElement => {\n  const svg = document.createElementNS(SVG_NS, 'svg')\n  svg.setAttributeNS(null, 'version', VERSION)\n  svg.setAttribute('xmlns', SVG_NS)\n  svg.setAttribute('xmlns:xlink', SVG_XLINK)\n  Object.keys(attrs)\n    .sort()\n    .map((key: string) => {\n      svg.setAttribute(key, attrs[key])\n    })\n  childs.map((el: SVGElement) => {\n    svg.appendChild(el)\n  })\n  return svg\n}\n\nexport const createSvgChildElement = <\n  T extends keyof SVGElementTagNameMap = any\n>(\n  elName: T,\n  attrs: Attrs\n): SVGElementTagNameMap[T] => {\n  const path = document.createElementNS(SVG_NS, elName)\n  Object.keys(attrs)\n    .sort()\n    .map((key: string) => {\n      path.setAttribute(key, attrs[key])\n    })\n  return path\n}\n\n/** @deprecated */\nexport const pathObjectToElement = (path: PathAttributes): SVGPathElement => {\n  const kebabAttrs = Object.entries(path).reduce(\n    (acc, [key, val], _i) =>\n      val\n        ? {\n            ...acc,\n            [camel2kebab(key)]: val,\n          }\n        : acc,\n    {}\n  )\n  return createSvgChildElement('path', kebabAttrs)\n}\n\nexport const svgObjectToElement = ({\n  width,\n  height,\n  background,\n  paths,\n}: SvgObject): SVGSVGElement => {\n  const size = { width: String(width), height: String(height) }\n  const bgEl = background\n    ? [createSvgChildElement('rect', { ...size, fill: background })]\n    : []\n  const updateEl = createSvgElement(size, [\n    ...bgEl,\n    ...paths.map(({ attributes }) => pathObjectToElement(attributes)),\n  ])\n  return updateEl\n}\n\nexport class Renderer {\n  constructor(public el: HTMLElement, { background }: RendererOption = {}) {\n    /** Setup parameter */\n    const { width, height } = this.el.getBoundingClientRect()\n    this.el.appendChild(\n      svgObjectToElement({ background, width, height, paths: [] })\n    )\n\n    this.update = this.update.bind(this)\n  }\n  /** Update render */\n  public update({ svg }: { svg: SvgObject }): void {\n    this.el.replaceChild(svgObjectToElement(svg), this.el.childNodes[0])\n  }\n}\n","export const mimeTypeMap = {\n  png: 'image/png',\n  jpg: 'image/jpeg',\n  svg: 'image/svg+xml',\n} as const\n\nconst base64ToBlob = (\n  data: string,\n  type: typeof mimeTypeMap[keyof typeof mimeTypeMap]\n) => {\n  const bin = Buffer.from(data.replace(/^.*,/, '')).toString()\n  const buffer = new Uint8Array(bin.length)\n\n  for (let i = 0; i < bin.length; i += 1) {\n    buffer[i] = bin.charCodeAt(i)\n  }\n\n  return new Blob([buffer.buffer], {\n    type,\n  })\n}\n\nexport const downloadBlob = ({\n  data,\n  extension,\n  filename,\n}: {\n  data: string\n  extension: keyof typeof mimeTypeMap\n  filename: string\n}): void => {\n  const blob = base64ToBlob(data, mimeTypeMap[extension])\n  // IE\n  if ((navigator as any).msSaveBlob) {\n    ;(navigator as any).msSaveBlob(blob, filename)\n    return\n  }\n\n  // Firefox, Chrome, Safari\n  if (URL?.createObjectURL) {\n    const a = document.createElement('a')\n    a.download = filename\n    a.href = URL.createObjectURL(blob)\n    document.body.appendChild(a)\n    a.click()\n    document.body.removeChild(a)\n    return\n  }\n\n  // Other\n  open(data, '_blank')\n}\n\nexport class Download {\n  private download: typeof downloadBlob\n  constructor(private el: SVGSVGElement, _download?: typeof downloadBlob) {\n    this.download = _download || downloadBlob\n  }\n\n  public svg(filename: string) {\n    this.download({\n      data: this.toBase64(),\n      extension: 'svg',\n      filename,\n    })\n  }\n\n  public png(filename: string) {\n    this.renderCanvas({\n      filename,\n      extension: 'png',\n    })\n  }\n\n  public jpg(filename: string) {\n    this.renderCanvas({\n      filename,\n      extension: 'png',\n    })\n  }\n\n  public toBase64() {\n    return `data:image/svg+xml;base64,${Buffer.from(this.el.outerHTML).toString(\n      'base64'\n    )}`\n  }\n\n  private renderCanvas({\n    filename,\n    extension,\n  }: {\n    filename: string\n    extension: 'png' | 'jpg'\n  }) {\n    const img = new Image()\n    const renderCanvas = () => {\n      const canvas = document.createElement('canvas')\n\n      canvas.setAttribute('width', String(this.el.width.animVal.value))\n      canvas.setAttribute('height', String(this.el.height.animVal.value))\n      const ctx = canvas.getContext('2d')\n      if (!ctx) return\n\n      ctx.drawImage(img, 0, 0)\n      this.download({\n        data: canvas.toDataURL(mimeTypeMap[extension]),\n        extension,\n        filename,\n      })\n    }\n    img.addEventListener('load', renderCanvas, false)\n    img.src = this.toBase64()\n  }\n}\n","import type { ResizeEventHandler, ResizeCallback } from './types'\n\nconst SUPPORT_RESIZE_OBSERVER = typeof ResizeObserver !== 'undefined'\n\n/**\n * ### Resize SVG to match element resizing\n *\n * ```ts\n * const svg = new Svg()\n * const resizeHandler = new ResizeHandler(\n *   document.getElementById('draw-area')\n * )\n *\n * resizeHandler.setHandler(({ width, height }) =>\n *   svg.resize({ width, height })\n * )\n * resizeHandler.on()\n * ```\n */\nexport class ResizeHandler implements ResizeEventHandler {\n  /** Remove EventList */\n  private _clearEventList: Array<() => void>\n  private resizeCallback: ResizeCallback\n  private width = 0\n  private height = 0\n  private threshold = 1\n  constructor(private el: HTMLElement | null = null) {\n    this.el = el\n    this.resizeCallback = () => void 0\n    this._clearEventList = []\n  }\n\n  public get active(): boolean {\n    return this._clearEventList.length > 0\n  }\n\n  public off() {\n    this._clearEventList.map((fn) => fn())\n    this._clearEventList = []\n  }\n\n  public on() {\n    this.off()\n    this._setupListener()\n  }\n\n  public setElement(el: HTMLElement) {\n    this.el = el\n    if (this.active) this.on()\n    return this\n  }\n\n  public setHandler(resizeCallback: ResizeCallback) {\n    this.resizeCallback = resizeCallback\n  }\n\n  private resize({ width, height }: { width: number; height: number }) {\n    this.width = width\n    this.height = height\n    this.resizeCallback({ width, height })\n  }\n\n  private handleResize() {\n    if (!this.el) return\n    const { width, height } = this.el.getBoundingClientRect()\n\n    if (\n      Math.abs(this.width - width) < this.threshold &&\n      Math.abs(this.height - height) < this.threshold\n    ) {\n      return\n    }\n\n    this.resize({ width, height })\n  }\n\n  private _setupListener(): void {\n    if (!this.el) return\n\n    // Initialize size\n    this.handleResize()\n\n    // ResizeObserver\n    // Use `getBoundingClientRect` because it is not fit when the size is obtained from `contentRect` of resize observe entry.\n    if (SUPPORT_RESIZE_OBSERVER) {\n      const resizeObserver = new ResizeObserver(() => this.handleResize())\n      resizeObserver.observe(this.el)\n\n      this._clearEventList.push(() => resizeObserver.disconnect())\n      return\n    }\n\n    // Fallback resize listener\n    addEventListener('resize', this.handleResize)\n    this._clearEventList.push(() =>\n      removeEventListener('resize', this.handleResize)\n    )\n  }\n}\n","import { createCommand } from './svg/command'\nimport { Path } from './svg/path'\nimport { Svg } from './svg/svg'\nimport { kebab2camel } from './utils'\nimport type { PathClass, CommandClass, CommandType, SvgClass } from './types'\n\nexport const parseSVGString = (svgStr: string): SvgClass => {\n  const svgEl: SVGSVGElement | null = new DOMParser()\n    .parseFromString(svgStr, 'image/svg+xml')\n    .querySelector('svg')\n\n  return svgEl ? parseSVGElement(svgEl) : new Svg({ width: 0, height: 0 })\n}\n\nexport const parseSVGElement = (svgEl: SVGSVGElement): SvgClass => {\n  const width = Number(svgEl.getAttribute('width'))\n  const height = Number(svgEl.getAttribute('height'))\n\n  const svg = new Svg({ width, height })\n  svgEl.querySelectorAll('path').forEach((pEl) => {\n    svg.addPath(parsePathElement(pEl))\n  })\n\n  return svg\n}\n\nexport const parsePathElement = (pathEl: SVGPathElement): PathClass => {\n  const path = new Path()\n  for (let i = 0; i < pathEl.attributes.length; i += 1) {\n    const attr: Attr | null = pathEl.attributes.item(i)\n    if (!attr || !attr.value) continue\n    if (attr.name === 'd') {\n      path.addCommand(parseCommandString(attr.value))\n      continue\n    }\n\n    path.updateAttributes({\n      [kebab2camel(attr.name)]: attr.value,\n    })\n  }\n\n  return path\n}\n\nexport const parseCommandString = (d: string): CommandClass[] => {\n  const commandsTypes = 'mlsqlhvcsqaz'\n  // expect ['M 0 0 ', 'M', ' 0 0 ', ...]\n  const regexp = new RegExp(`([${commandsTypes}])([^${commandsTypes}]*)`, 'gi')\n\n  return Array.from(d.matchAll(regexp) || []).reduce(\n    (acc: CommandClass<any>[], match: RegExpMatchArray, i) => {\n      const values: number[] =\n        match[2]\n          ?.split(/[,\\s]/)\n          ?.reduce(\n            (acc: number[], str) => (str === '' ? acc : [...acc, +str]),\n            []\n          ) || []\n      return [...acc, createCommand(match[1] as CommandType, values)]\n    },\n    []\n  )\n}\n","import { Drawing } from './drawing/drawing'\nimport { PencilHandler } from './drawing/eventHandler'\nimport { BasicDrawFactory } from './drawing/factory'\nimport { Renderer } from './renderer'\nimport { Svg } from './svg/svg'\nimport { isAlmostSameNumber } from './utils'\nimport type {\n  DrawingOption,\n  DrawEventHandler,\n  SvgClass,\n  DrawingClass,\n  PathClass,\n  ResizeCallback,\n  SvgObject,\n  EventPoint,\n} from './types'\n\n/**\n * ### Setup SvgDrawing\n *\n * ```ts\n * import { SvgDrawing } from '@svg-drawing/core'\n *\n * const el = document.getElementById('draw-area')\n * new SvgDrawing(el)\n * ```\n *\n * ### Set draw options.\n *\n * ```ts\n * // It is default value\n * const options = {\n *   penColor: '#000',\n *   penWidth: 1,\n *   curve: true,\n *   close: false,\n *   delay: 0,\n *   fill: 'none',\n *   background: undefined,\n * }\n *\n * new SvgDrawing(el, options)\n * ```\n */\nexport class SvgDrawing {\n  private svg: SvgClass\n  private drawing: DrawingClass\n  private factory: BasicDrawFactory\n  private handler: DrawEventHandler\n  private renderer: Renderer\n  constructor(\n    el: HTMLElement,\n    {\n      curve = true,\n      close = false,\n      delay = 0,\n      penColor,\n      penWidth,\n      fill,\n      background,\n    }: DrawingOption = {}\n  ) {\n    const { width, height } = el.getBoundingClientRect()\n\n    this.renderer = new Renderer(el, { background })\n\n    this.update = this.update.bind(this)\n\n    this.svg = new Svg({ width, height, background })\n\n    this.factory = new BasicDrawFactory(\n      {\n        stroke: penColor ?? '#000',\n        strokeWidth: penWidth || penWidth === 0 ? String(penWidth) : '1',\n        fill: fill ?? 'none',\n      },\n      { curve, close }\n    )\n\n    this.drawing = new Drawing(this.svg, this.factory, this.update)\n\n    const pencilHandler = new PencilHandler(this.drawing, el)\n    this.handler = pencilHandler\n    pencilHandler.changeDelay(delay)\n    this.handler.on()\n  }\n\n  public drawStart(): void {\n    this.drawing.start()\n  }\n\n  public drawMove(po: EventPoint): void {\n    this.drawing.dot(po)\n  }\n\n  public drawEnd(): void {\n    this.drawing.end()\n  }\n\n  public toJson(): SvgObject {\n    return this.svg.toJson()\n  }\n\n  public changeCurve(curve: boolean): void {\n    this.factory.changeCurve(curve)\n  }\n\n  public changeClose(close: boolean): void {\n    this.factory.changeClose(close)\n  }\n\n  public clear(): PathClass[] {\n    const paths = this.svg.paths\n    this.svg.paths = []\n    this.update()\n    return paths\n  }\n\n  public undo(): PathClass | undefined {\n    const path = this.svg.paths.pop()\n    this.update()\n    return path\n  }\n\n  private update(): void {\n    this.renderer.update({ svg: this.svg.toJson() })\n  }\n\n  public resize({ width, height }: Parameters<ResizeCallback>[0]) {\n    if (isAlmostSameNumber(this.svg.width, width)) return\n\n    this.svg.resize({ width, height })\n    this.update()\n  }\n}\n","/**\n * Copyright (c) 2014-present, Facebook, Inc.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nvar runtime = (function (exports) {\n  \"use strict\";\n\n  var Op = Object.prototype;\n  var hasOwn = Op.hasOwnProperty;\n  var undefined; // More compressible than void 0.\n  var $Symbol = typeof Symbol === \"function\" ? Symbol : {};\n  var iteratorSymbol = $Symbol.iterator || \"@@iterator\";\n  var asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\";\n  var toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\";\n\n  function wrap(innerFn, outerFn, self, tryLocsList) {\n    // If outerFn provided and outerFn.prototype is a Generator, then outerFn.prototype instanceof Generator.\n    var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator;\n    var generator = Object.create(protoGenerator.prototype);\n    var context = new Context(tryLocsList || []);\n\n    // The ._invoke method unifies the implementations of the .next,\n    // .throw, and .return methods.\n    generator._invoke = makeInvokeMethod(innerFn, self, context);\n\n    return generator;\n  }\n  exports.wrap = wrap;\n\n  // Try/catch helper to minimize deoptimizations. Returns a completion\n  // record like context.tryEntries[i].completion. This interface could\n  // have been (and was previously) designed to take a closure to be\n  // invoked without arguments, but in all the cases we care about we\n  // already have an existing method we want to call, so there's no need\n  // to create a new function object. We can even get away with assuming\n  // the method takes exactly one argument, since that happens to be true\n  // in every case, so we don't have to touch the arguments object. The\n  // only additional allocation required is the completion record, which\n  // has a stable shape and so hopefully should be cheap to allocate.\n  function tryCatch(fn, obj, arg) {\n    try {\n      return { type: \"normal\", arg: fn.call(obj, arg) };\n    } catch (err) {\n      return { type: \"throw\", arg: err };\n    }\n  }\n\n  var GenStateSuspendedStart = \"suspendedStart\";\n  var GenStateSuspendedYield = \"suspendedYield\";\n  var GenStateExecuting = \"executing\";\n  var GenStateCompleted = \"completed\";\n\n  // Returning this object from the innerFn has the same effect as\n  // breaking out of the dispatch switch statement.\n  var ContinueSentinel = {};\n\n  // Dummy constructor functions that we use as the .constructor and\n  // .constructor.prototype properties for functions that return Generator\n  // objects. For full spec compliance, you may wish to configure your\n  // minifier not to mangle the names of these two functions.\n  function Generator() {}\n  function GeneratorFunction() {}\n  function GeneratorFunctionPrototype() {}\n\n  // This is a polyfill for %IteratorPrototype% for environments that\n  // don't natively support it.\n  var IteratorPrototype = {};\n  IteratorPrototype[iteratorSymbol] = function () {\n    return this;\n  };\n\n  var getProto = Object.getPrototypeOf;\n  var NativeIteratorPrototype = getProto && getProto(getProto(values([])));\n  if (NativeIteratorPrototype &&\n      NativeIteratorPrototype !== Op &&\n      hasOwn.call(NativeIteratorPrototype, iteratorSymbol)) {\n    // This environment has a native %IteratorPrototype%; use it instead\n    // of the polyfill.\n    IteratorPrototype = NativeIteratorPrototype;\n  }\n\n  var Gp = GeneratorFunctionPrototype.prototype =\n    Generator.prototype = Object.create(IteratorPrototype);\n  GeneratorFunction.prototype = Gp.constructor = GeneratorFunctionPrototype;\n  GeneratorFunctionPrototype.constructor = GeneratorFunction;\n  GeneratorFunctionPrototype[toStringTagSymbol] =\n    GeneratorFunction.displayName = \"GeneratorFunction\";\n\n  // Helper for defining the .next, .throw, and .return methods of the\n  // Iterator interface in terms of a single ._invoke method.\n  function defineIteratorMethods(prototype) {\n    [\"next\", \"throw\", \"return\"].forEach(function(method) {\n      prototype[method] = function(arg) {\n        return this._invoke(method, arg);\n      };\n    });\n  }\n\n  exports.isGeneratorFunction = function(genFun) {\n    var ctor = typeof genFun === \"function\" && genFun.constructor;\n    return ctor\n      ? ctor === GeneratorFunction ||\n        // For the native GeneratorFunction constructor, the best we can\n        // do is to check its .name property.\n        (ctor.displayName || ctor.name) === \"GeneratorFunction\"\n      : false;\n  };\n\n  exports.mark = function(genFun) {\n    if (Object.setPrototypeOf) {\n      Object.setPrototypeOf(genFun, GeneratorFunctionPrototype);\n    } else {\n      genFun.__proto__ = GeneratorFunctionPrototype;\n      if (!(toStringTagSymbol in genFun)) {\n        genFun[toStringTagSymbol] = \"GeneratorFunction\";\n      }\n    }\n    genFun.prototype = Object.create(Gp);\n    return genFun;\n  };\n\n  // Within the body of any async function, `await x` is transformed to\n  // `yield regeneratorRuntime.awrap(x)`, so that the runtime can test\n  // `hasOwn.call(value, \"__await\")` to determine if the yielded value is\n  // meant to be awaited.\n  exports.awrap = function(arg) {\n    return { __await: arg };\n  };\n\n  function AsyncIterator(generator, PromiseImpl) {\n    function invoke(method, arg, resolve, reject) {\n      var record = tryCatch(generator[method], generator, arg);\n      if (record.type === \"throw\") {\n        reject(record.arg);\n      } else {\n        var result = record.arg;\n        var value = result.value;\n        if (value &&\n            typeof value === \"object\" &&\n            hasOwn.call(value, \"__await\")) {\n          return PromiseImpl.resolve(value.__await).then(function(value) {\n            invoke(\"next\", value, resolve, reject);\n          }, function(err) {\n            invoke(\"throw\", err, resolve, reject);\n          });\n        }\n\n        return PromiseImpl.resolve(value).then(function(unwrapped) {\n          // When a yielded Promise is resolved, its final value becomes\n          // the .value of the Promise<{value,done}> result for the\n          // current iteration.\n          result.value = unwrapped;\n          resolve(result);\n        }, function(error) {\n          // If a rejected Promise was yielded, throw the rejection back\n          // into the async generator function so it can be handled there.\n          return invoke(\"throw\", error, resolve, reject);\n        });\n      }\n    }\n\n    var previousPromise;\n\n    function enqueue(method, arg) {\n      function callInvokeWithMethodAndArg() {\n        return new PromiseImpl(function(resolve, reject) {\n          invoke(method, arg, resolve, reject);\n        });\n      }\n\n      return previousPromise =\n        // If enqueue has been called before, then we want to wait until\n        // all previous Promises have been resolved before calling invoke,\n        // so that results are always delivered in the correct order. If\n        // enqueue has not been called before, then it is important to\n        // call invoke immediately, without waiting on a callback to fire,\n        // so that the async generator function has the opportunity to do\n        // any necessary setup in a predictable way. This predictability\n        // is why the Promise constructor synchronously invokes its\n        // executor callback, and why async functions synchronously\n        // execute code before the first await. Since we implement simple\n        // async functions in terms of async generators, it is especially\n        // important to get this right, even though it requires care.\n        previousPromise ? previousPromise.then(\n          callInvokeWithMethodAndArg,\n          // Avoid propagating failures to Promises returned by later\n          // invocations of the iterator.\n          callInvokeWithMethodAndArg\n        ) : callInvokeWithMethodAndArg();\n    }\n\n    // Define the unified helper method that is used to implement .next,\n    // .throw, and .return (see defineIteratorMethods).\n    this._invoke = enqueue;\n  }\n\n  defineIteratorMethods(AsyncIterator.prototype);\n  AsyncIterator.prototype[asyncIteratorSymbol] = function () {\n    return this;\n  };\n  exports.AsyncIterator = AsyncIterator;\n\n  // Note that simple async functions are implemented on top of\n  // AsyncIterator objects; they just return a Promise for the value of\n  // the final result produced by the iterator.\n  exports.async = function(innerFn, outerFn, self, tryLocsList, PromiseImpl) {\n    if (PromiseImpl === void 0) PromiseImpl = Promise;\n\n    var iter = new AsyncIterator(\n      wrap(innerFn, outerFn, self, tryLocsList),\n      PromiseImpl\n    );\n\n    return exports.isGeneratorFunction(outerFn)\n      ? iter // If outerFn is a generator, return the full iterator.\n      : iter.next().then(function(result) {\n          return result.done ? result.value : iter.next();\n        });\n  };\n\n  function makeInvokeMethod(innerFn, self, context) {\n    var state = GenStateSuspendedStart;\n\n    return function invoke(method, arg) {\n      if (state === GenStateExecuting) {\n        throw new Error(\"Generator is already running\");\n      }\n\n      if (state === GenStateCompleted) {\n        if (method === \"throw\") {\n          throw arg;\n        }\n\n        // Be forgiving, per 25.3.3.3.3 of the spec:\n        // https://people.mozilla.org/~jorendorff/es6-draft.html#sec-generatorresume\n        return doneResult();\n      }\n\n      context.method = method;\n      context.arg = arg;\n\n      while (true) {\n        var delegate = context.delegate;\n        if (delegate) {\n          var delegateResult = maybeInvokeDelegate(delegate, context);\n          if (delegateResult) {\n            if (delegateResult === ContinueSentinel) continue;\n            return delegateResult;\n          }\n        }\n\n        if (context.method === \"next\") {\n          // Setting context._sent for legacy support of Babel's\n          // function.sent implementation.\n          context.sent = context._sent = context.arg;\n\n        } else if (context.method === \"throw\") {\n          if (state === GenStateSuspendedStart) {\n            state = GenStateCompleted;\n            throw context.arg;\n          }\n\n          context.dispatchException(context.arg);\n\n        } else if (context.method === \"return\") {\n          context.abrupt(\"return\", context.arg);\n        }\n\n        state = GenStateExecuting;\n\n        var record = tryCatch(innerFn, self, context);\n        if (record.type === \"normal\") {\n          // If an exception is thrown from innerFn, we leave state ===\n          // GenStateExecuting and loop back for another invocation.\n          state = context.done\n            ? GenStateCompleted\n            : GenStateSuspendedYield;\n\n          if (record.arg === ContinueSentinel) {\n            continue;\n          }\n\n          return {\n            value: record.arg,\n            done: context.done\n          };\n\n        } else if (record.type === \"throw\") {\n          state = GenStateCompleted;\n          // Dispatch the exception by looping back around to the\n          // context.dispatchException(context.arg) call above.\n          context.method = \"throw\";\n          context.arg = record.arg;\n        }\n      }\n    };\n  }\n\n  // Call delegate.iterator[context.method](context.arg) and handle the\n  // result, either by returning a { value, done } result from the\n  // delegate iterator, or by modifying context.method and context.arg,\n  // setting context.delegate to null, and returning the ContinueSentinel.\n  function maybeInvokeDelegate(delegate, context) {\n    var method = delegate.iterator[context.method];\n    if (method === undefined) {\n      // A .throw or .return when the delegate iterator has no .throw\n      // method always terminates the yield* loop.\n      context.delegate = null;\n\n      if (context.method === \"throw\") {\n        // Note: [\"return\"] must be used for ES3 parsing compatibility.\n        if (delegate.iterator[\"return\"]) {\n          // If the delegate iterator has a return method, give it a\n          // chance to clean up.\n          context.method = \"return\";\n          context.arg = undefined;\n          maybeInvokeDelegate(delegate, context);\n\n          if (context.method === \"throw\") {\n            // If maybeInvokeDelegate(context) changed context.method from\n            // \"return\" to \"throw\", let that override the TypeError below.\n            return ContinueSentinel;\n          }\n        }\n\n        context.method = \"throw\";\n        context.arg = new TypeError(\n          \"The iterator does not provide a 'throw' method\");\n      }\n\n      return ContinueSentinel;\n    }\n\n    var record = tryCatch(method, delegate.iterator, context.arg);\n\n    if (record.type === \"throw\") {\n      context.method = \"throw\";\n      context.arg = record.arg;\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    var info = record.arg;\n\n    if (! info) {\n      context.method = \"throw\";\n      context.arg = new TypeError(\"iterator result is not an object\");\n      context.delegate = null;\n      return ContinueSentinel;\n    }\n\n    if (info.done) {\n      // Assign the result of the finished delegate to the temporary\n      // variable specified by delegate.resultName (see delegateYield).\n      context[delegate.resultName] = info.value;\n\n      // Resume execution at the desired location (see delegateYield).\n      context.next = delegate.nextLoc;\n\n      // If context.method was \"throw\" but the delegate handled the\n      // exception, let the outer generator proceed normally. If\n      // context.method was \"next\", forget context.arg since it has been\n      // \"consumed\" by the delegate iterator. If context.method was\n      // \"return\", allow the original .return call to continue in the\n      // outer generator.\n      if (context.method !== \"return\") {\n        context.method = \"next\";\n        context.arg = undefined;\n      }\n\n    } else {\n      // Re-yield the result returned by the delegate method.\n      return info;\n    }\n\n    // The delegate iterator is finished, so forget it and continue with\n    // the outer generator.\n    context.delegate = null;\n    return ContinueSentinel;\n  }\n\n  // Define Generator.prototype.{next,throw,return} in terms of the\n  // unified ._invoke helper method.\n  defineIteratorMethods(Gp);\n\n  Gp[toStringTagSymbol] = \"Generator\";\n\n  // A Generator should always return itself as the iterator object when the\n  // @@iterator function is called on it. Some browsers' implementations of the\n  // iterator prototype chain incorrectly implement this, causing the Generator\n  // object to not be returned from this call. This ensures that doesn't happen.\n  // See https://github.com/facebook/regenerator/issues/274 for more details.\n  Gp[iteratorSymbol] = function() {\n    return this;\n  };\n\n  Gp.toString = function() {\n    return \"[object Generator]\";\n  };\n\n  function pushTryEntry(locs) {\n    var entry = { tryLoc: locs[0] };\n\n    if (1 in locs) {\n      entry.catchLoc = locs[1];\n    }\n\n    if (2 in locs) {\n      entry.finallyLoc = locs[2];\n      entry.afterLoc = locs[3];\n    }\n\n    this.tryEntries.push(entry);\n  }\n\n  function resetTryEntry(entry) {\n    var record = entry.completion || {};\n    record.type = \"normal\";\n    delete record.arg;\n    entry.completion = record;\n  }\n\n  function Context(tryLocsList) {\n    // The root entry object (effectively a try statement without a catch\n    // or a finally block) gives us a place to store values thrown from\n    // locations where there is no enclosing try statement.\n    this.tryEntries = [{ tryLoc: \"root\" }];\n    tryLocsList.forEach(pushTryEntry, this);\n    this.reset(true);\n  }\n\n  exports.keys = function(object) {\n    var keys = [];\n    for (var key in object) {\n      keys.push(key);\n    }\n    keys.reverse();\n\n    // Rather than returning an object with a next method, we keep\n    // things simple and return the next function itself.\n    return function next() {\n      while (keys.length) {\n        var key = keys.pop();\n        if (key in object) {\n          next.value = key;\n          next.done = false;\n          return next;\n        }\n      }\n\n      // To avoid creating an additional object, we just hang the .value\n      // and .done properties off the next function object itself. This\n      // also ensures that the minifier will not anonymize the function.\n      next.done = true;\n      return next;\n    };\n  };\n\n  function values(iterable) {\n    if (iterable) {\n      var iteratorMethod = iterable[iteratorSymbol];\n      if (iteratorMethod) {\n        return iteratorMethod.call(iterable);\n      }\n\n      if (typeof iterable.next === \"function\") {\n        return iterable;\n      }\n\n      if (!isNaN(iterable.length)) {\n        var i = -1, next = function next() {\n          while (++i < iterable.length) {\n            if (hasOwn.call(iterable, i)) {\n              next.value = iterable[i];\n              next.done = false;\n              return next;\n            }\n          }\n\n          next.value = undefined;\n          next.done = true;\n\n          return next;\n        };\n\n        return next.next = next;\n      }\n    }\n\n    // Return an iterator with no values.\n    return { next: doneResult };\n  }\n  exports.values = values;\n\n  function doneResult() {\n    return { value: undefined, done: true };\n  }\n\n  Context.prototype = {\n    constructor: Context,\n\n    reset: function(skipTempReset) {\n      this.prev = 0;\n      this.next = 0;\n      // Resetting context._sent for legacy support of Babel's\n      // function.sent implementation.\n      this.sent = this._sent = undefined;\n      this.done = false;\n      this.delegate = null;\n\n      this.method = \"next\";\n      this.arg = undefined;\n\n      this.tryEntries.forEach(resetTryEntry);\n\n      if (!skipTempReset) {\n        for (var name in this) {\n          // Not sure about the optimal order of these conditions:\n          if (name.charAt(0) === \"t\" &&\n              hasOwn.call(this, name) &&\n              !isNaN(+name.slice(1))) {\n            this[name] = undefined;\n          }\n        }\n      }\n    },\n\n    stop: function() {\n      this.done = true;\n\n      var rootEntry = this.tryEntries[0];\n      var rootRecord = rootEntry.completion;\n      if (rootRecord.type === \"throw\") {\n        throw rootRecord.arg;\n      }\n\n      return this.rval;\n    },\n\n    dispatchException: function(exception) {\n      if (this.done) {\n        throw exception;\n      }\n\n      var context = this;\n      function handle(loc, caught) {\n        record.type = \"throw\";\n        record.arg = exception;\n        context.next = loc;\n\n        if (caught) {\n          // If the dispatched exception was caught by a catch block,\n          // then let that catch block handle the exception normally.\n          context.method = \"next\";\n          context.arg = undefined;\n        }\n\n        return !! caught;\n      }\n\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        var record = entry.completion;\n\n        if (entry.tryLoc === \"root\") {\n          // Exception thrown outside of any try block that could handle\n          // it, so set the completion value of the entire function to\n          // throw the exception.\n          return handle(\"end\");\n        }\n\n        if (entry.tryLoc <= this.prev) {\n          var hasCatch = hasOwn.call(entry, \"catchLoc\");\n          var hasFinally = hasOwn.call(entry, \"finallyLoc\");\n\n          if (hasCatch && hasFinally) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            } else if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else if (hasCatch) {\n            if (this.prev < entry.catchLoc) {\n              return handle(entry.catchLoc, true);\n            }\n\n          } else if (hasFinally) {\n            if (this.prev < entry.finallyLoc) {\n              return handle(entry.finallyLoc);\n            }\n\n          } else {\n            throw new Error(\"try statement without catch or finally\");\n          }\n        }\n      }\n    },\n\n    abrupt: function(type, arg) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc <= this.prev &&\n            hasOwn.call(entry, \"finallyLoc\") &&\n            this.prev < entry.finallyLoc) {\n          var finallyEntry = entry;\n          break;\n        }\n      }\n\n      if (finallyEntry &&\n          (type === \"break\" ||\n           type === \"continue\") &&\n          finallyEntry.tryLoc <= arg &&\n          arg <= finallyEntry.finallyLoc) {\n        // Ignore the finally entry if control is not jumping to a\n        // location outside the try/catch block.\n        finallyEntry = null;\n      }\n\n      var record = finallyEntry ? finallyEntry.completion : {};\n      record.type = type;\n      record.arg = arg;\n\n      if (finallyEntry) {\n        this.method = \"next\";\n        this.next = finallyEntry.finallyLoc;\n        return ContinueSentinel;\n      }\n\n      return this.complete(record);\n    },\n\n    complete: function(record, afterLoc) {\n      if (record.type === \"throw\") {\n        throw record.arg;\n      }\n\n      if (record.type === \"break\" ||\n          record.type === \"continue\") {\n        this.next = record.arg;\n      } else if (record.type === \"return\") {\n        this.rval = this.arg = record.arg;\n        this.method = \"return\";\n        this.next = \"end\";\n      } else if (record.type === \"normal\" && afterLoc) {\n        this.next = afterLoc;\n      }\n\n      return ContinueSentinel;\n    },\n\n    finish: function(finallyLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.finallyLoc === finallyLoc) {\n          this.complete(entry.completion, entry.afterLoc);\n          resetTryEntry(entry);\n          return ContinueSentinel;\n        }\n      }\n    },\n\n    \"catch\": function(tryLoc) {\n      for (var i = this.tryEntries.length - 1; i >= 0; --i) {\n        var entry = this.tryEntries[i];\n        if (entry.tryLoc === tryLoc) {\n          var record = entry.completion;\n          if (record.type === \"throw\") {\n            var thrown = record.arg;\n            resetTryEntry(entry);\n          }\n          return thrown;\n        }\n      }\n\n      // The context.catch method must only be called with a location\n      // argument that corresponds to a known catch block.\n      throw new Error(\"illegal catch attempt\");\n    },\n\n    delegateYield: function(iterable, resultName, nextLoc) {\n      this.delegate = {\n        iterator: values(iterable),\n        resultName: resultName,\n        nextLoc: nextLoc\n      };\n\n      if (this.method === \"next\") {\n        // Deliberately forget the last sent value so that we don't\n        // accidentally pass it on to the delegate.\n        this.arg = undefined;\n      }\n\n      return ContinueSentinel;\n    }\n  };\n\n  // Regardless of whether this script is executing as a CommonJS module\n  // or not, return the runtime object so that we can declare the variable\n  // regeneratorRuntime in the outer scope, which allows this module to be\n  // injected easily by `bin/regenerator --include-runtime script.js`.\n  return exports;\n\n}(\n  // If this script is executing as a CommonJS module, use module.exports\n  // as the regeneratorRuntime namespace. Otherwise create a new empty\n  // object. Either way, the resulting object will be used to initialize\n  // the regeneratorRuntime variable at the top of this file.\n  typeof module === \"object\" ? module.exports : {}\n));\n\ntry {\n  regeneratorRuntime = runtime;\n} catch (accidentalStrictMode) {\n  // This module should not be running in strict mode, so the above\n  // assignment should always work unless something is misconfigured. Just\n  // in case runtime.js accidentally runs in strict mode, we can escape\n  // strict mode using a global Function call. This could conceivably fail\n  // if a Content Security Policy forbids using Function, but in that case\n  // the proper solution is to fix the accidental strict mode problem. If\n  // you've misconfigured your bundler to force strict mode and applied a\n  // CSP to forbid Function, and you're not willing to fix either of those\n  // problems, please detail your unique predicament in a GitHub issue.\n  Function(\"r\", \"regeneratorRuntime = r\")(runtime);\n}\n","module.exports = require(\"regenerator-runtime\");\n","import { roundUp, camel2kebab } from '../utils'\nimport type {\n  PathClass,\n  AnimationOption,\n  FrameAnimation,\n  AnimateAttribute,\n  AnimationObject,\n} from '../types'\n\nconst createAnimateAttributeValues = (\n  animationPaths: (PathClass | undefined)[],\n  attributeName: string,\n  defaultValue: string\n): string[] =>\n  animationPaths.map((p) => p?.attrs[attributeName] || defaultValue)\n\nconst createAnimateCommandValues = (\n  animationPaths: (PathClass | undefined)[],\n  originPath: PathClass\n): string[] =>\n  animationPaths.map(\n    (p) => p?.getCommandString() || originPath.relativeCommands[0].toString()\n  )\n\nexport class Animation {\n  public ms: number\n  public paths: PathClass[]\n  public generator?: Generator<PathClass[], void, unknown>\n  private _frame: FrameAnimation | null = null\n  private _repeatCount?: number\n  constructor({ ms }: AnimationOption = { ms: 60 }) {\n    this.ms = ms\n    this.paths = []\n  }\n\n  /**\n   * `frame` is the number of frames to animate `repeat` is related for\n   * repeatCount of animate element attribute.\n   *\n   * @param {FramaAnimation} fn\n   * @param {{ frame?: number; repeat?: number }} opts\n   */\n  public setup(\n    frame: FrameAnimation,\n    { repeatCount, ms }: { repeatCount?: number; ms?: number } = {}\n  ): void {\n    this._frame = frame\n\n    this._repeatCount = repeatCount || undefined\n    if (ms) this.ms = ms\n\n    this.generator = this.setupGenerator()\n  }\n\n  public getFramePaths(key: number): PathClass[] {\n    const paths = this.paths.map((p) => p.clone())\n\n    if (!paths.length || !this._frame) return paths\n\n    return this._frame.animation(paths, key)\n  }\n\n  public restorePaths() {\n    return this.paths.map((p) => p.clone())\n  }\n\n  private *setupGenerator() {\n    let loopId = 0\n    let repeatCount = 0\n    if (!this._frame) return\n\n    while (!this._repeatCount || repeatCount < this._repeatCount) {\n      if (loopId > this._frame.loops) {\n        repeatCount += 1\n        loopId = 0\n      } else {\n        loopId += 1\n      }\n\n      yield this.getFramePaths(loopId)\n    }\n  }\n\n  public initialize(paths: PathClass[]) {\n    this.paths = paths.map((p) => p.clone())\n    this.generator = this.setupGenerator()\n    return this\n  }\n\n  public toJson(): AnimationObject {\n    if (!this._frame) return {}\n\n    const loop = this._frame.loops\n    const frameLoop = Array(this._frame.loops).fill(null)\n\n    const animPathsList: PathClass[][] = frameLoop.map((_: any, i: number) =>\n      this.getFramePaths(i)\n    )\n\n    const baseAttrs = {\n      repeatCount: `${this._repeatCount || `indefinite`}`,\n      dur: loop * (this.ms > 0 ? this.ms : 1) + 'ms',\n      keyTimes: frameLoop.reduce(\n        (acc: string, _, i) => acc + ';' + roundUp((i + 1) * (1 / loop), 4),\n        '0'\n      ),\n    }\n\n    return this.paths.reduce((acc: AnimationObject, basePath) => {\n      const { key, attributes } = basePath.toJson()\n\n      const animPaths = animPathsList.map((ap) =>\n        ap.find((p) => p.key === basePath.key)\n      )\n\n      // TODO: Check attribute key and value.\n      const animateAttributesList: AnimateAttribute[] = Object.keys(attributes)\n        .sort()\n        .reduce((animateAttrs: AnimateAttribute[], attributeName: string) => {\n          const defaultValue = attributes[attributeName]\n          if (!defaultValue) return animateAttrs\n\n          const values =\n            attributeName === 'd'\n              ? createAnimateCommandValues(animPaths, basePath)\n              : createAnimateAttributeValues(\n                  animPaths,\n                  attributeName,\n                  defaultValue\n                )\n          if (values.every((v) => v === defaultValue)) return animateAttrs\n\n          return [\n            ...animateAttrs,\n            {\n              ...baseAttrs,\n              attributeName: camel2kebab(attributeName),\n              values: [...values, defaultValue].join(';'),\n            },\n          ]\n        }, [])\n\n      return {\n        ...acc,\n        [key]: animateAttributesList.map((animateAttributes) => ({\n          type: 'animate',\n          attributes: animateAttributes,\n        })),\n      }\n    }, {})\n  }\n}\n","import { Animation } from './animation/animation'\nimport {\n  Renderer,\n  createSvgChildElement,\n  createSvgElement,\n  pathObjectToElement,\n} from './renderer'\nimport { Svg } from './svg/svg'\nimport type {\n  AnimationOption,\n  RendererOption,\n  ResizeCallback,\n  SvgClass,\n} from './types'\n\nexport class SvgAnimation {\n  private _stopId?: number\n  constructor(\n    public svg: SvgClass,\n    public animation: Animation,\n    private update: (svg: SvgClass) => void\n  ) {\n    this.resize = this.resize.bind(this)\n  }\n\n  public stop(): void {\n    if (!this._stopId) return\n\n    cancelAnimationFrame(this._stopId)\n    this.restore()\n  }\n\n  public restore(): void {\n    this.svg.paths = this.animation.restorePaths()\n    this.update(this.svg)\n  }\n\n  public start(): void {\n    // If do not this first, this cannot get the number of frames well.\n    this.stop()\n\n    this._setupAnimation()\n    this._startAnimation()\n  }\n\n  private _setupAnimation() {\n    this.animation.initialize(this.svg.paths)\n  }\n\n  private _updateFrame() {\n    if (!this.animation.generator) return\n\n    const result = this.animation.generator.next()\n    if (result.done) {\n      this.stop()\n      return\n    }\n\n    this.svg.paths = result.value\n    this.update(this.svg)\n  }\n\n  private _startAnimation(): void {\n    let start = 0\n\n    const frame: FrameRequestCallback = (timestamp: number) => {\n      if (timestamp - start > this.animation.ms) {\n        start = timestamp\n        this._updateFrame()\n      }\n\n      this._stopId = requestAnimationFrame(frame)\n    }\n\n    this._stopId = requestAnimationFrame(frame)\n  }\n\n  public toElement() {\n    const sizeAttributes = {\n      width: String(this.svg.width),\n      height: String(this.svg.height),\n    }\n\n    const animationJson = this.animation.toJson()\n\n    const pathEls = this.animation.paths.map((path) => {\n      const { key, attributes } = path.toJson()\n      const pathEl = pathObjectToElement(attributes)\n\n      animationJson?.[key]?.map(({ type, attributes }) => {\n        pathEl.appendChild(createSvgChildElement(type, attributes))\n      })\n\n      return pathEl\n    })\n\n    const childEls: SVGElement[] = this.svg.background\n      ? [\n          createSvgChildElement('rect', {\n            ...sizeAttributes,\n            fill: this.svg.background,\n          }),\n          ...pathEls,\n        ]\n      : pathEls\n\n    return createSvgElement(sizeAttributes, childEls)\n  }\n\n  public resize({ width, height }: Parameters<ResizeCallback>[0]): void {\n    this.stop()\n    this.svg.resize({ width, height })\n    this.animation.initialize(this.svg.paths)\n    this.start()\n  }\n\n  public static init(\n    el: HTMLElement,\n    { ms, background }: AnimationOption & RendererOption = { ms: 60 }\n  ): SvgAnimation {\n    const { width, height } = el.getBoundingClientRect()\n    return new SvgAnimation(\n      new Svg({ width, height }),\n      new Animation({ ms }),\n      (svg) => new Renderer(el, { background }).update({ svg: svg.toJson() })\n    )\n  }\n}\n"],"names":["_defineProperty","obj","key","value","Object","defineProperty","enumerable","configurable","writable","Drawing","svg","pathFactory","update","this","_drawPath","_drawPoints","start","bind","dot","end","_proto","prototype","createPath","addPath","po","push","updateCommands","createCommand","_extends","assign","target","i","arguments","length","source","hasOwnProperty","call","apply","_defineProperties","props","descriptor","_createClass","Constructor","protoProps","staticProps","coeffecient","roundNumber","num","Math","round","Point","x","y","_x","_y","scale","r","scaleX","scaleY","add","p","sub","clone","toJson","fromVector","_ref","theta","angle","PI","cos","sin","get","camel2kebab","str","replace","toLowerCase","roundUp","digits","toFixed","OtherCommand","type","values","toString","map","v","join","points","reduce","res","upd","slice","translate","Types","a","validTypes","t","some","arg","_this","acc","_","set","H","h","V","A","RelativeMove","point","_proto2","Move","_proto3","RelativeLine","_proto4","Line","_proto5","RelativeCurve","_proto6","Curve","_proto7","ShortcutCurve","_proto8","RelativeShortcutCurve","_proto9","QuadraticCurve","_proto10","RelativeQuadraticCurve","_proto11","Close","_proto12","_p","_r","isAbsoluteCommand","command","includes","isRelativeCommand","isCurveCommand","toRelativeCommand","basePoint","Error","toAbsoluteCommand","toRelativeCommands","commands","notAbsoluteCommand","undefined","toAbsoluteCommands","notRelativeCommand","Vector","rotate","fromPoint","sqrt","pow","atan2","createLineCommands","BezierCurve","_temp","ratio","create","genCommand","p1","p2","p3","p4","vPrev","vNext","cPrev","cNext","closeCommands","concat","Path","attrs","_key","genIndex","c","addCommand","param","flat","updateCommand","absoluteCommands","deleteCommand","filter","index","getCommandString","_this$relativeCommand","relativeCommands","com","_i","trim","attributes","d","setAttributes","updateAttributes","BasicDrawFactory","opts","curve","close","curveAttribute","setPathAttributes","updatePathAttributes","changeCurve","changeClose","strokeLinecap","strokeLinejoin","_assertThisInitialized","self","ReferenceError","_setPrototypeOf","o","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","constructor","SUPPORT_POINTER_EVENT","PointerEvent","SUPPORT_ON_TOUCH_START","ontouchstart","SUPPORT_EVENT_LISTENER_PASSIVE_OPTION","check","addEventListener","passive","removeEventListener","e","getEventPoint","ev","touche","touches","changedTouches","clientX","clientY","pressure","force","throttle","func","wait","context","args","result","timeout","previous","later","Date","now","remaining","_len","wrapArg","Array","clearTimeout","setTimeout","OffsetPosition","el","getBoundingClientRect","left","top","setElement","setup","setOffsetPosition","BaseHandler","drawing","on","off","setDrawing","_offsetPosition","_clearEventList","fn","setupListener","isActive","getPointObjectFromDrawEvent","PencilHandler","_BaseHandler","_this2","_handleStart","_handleMove","_handleEnd","_drawMoveThrottle","delay","listenerOption","changeDelay","_setupDrawListener","preventDefault","_this3","eventMap","pointer","move","flameout","touch","mouse","startClear","evname","moveClear","endClear","flameoutClear","PenHandler","_BaseHandler2","_this4","_editing","_handleProt","clearEvent","_setupCancelListener","isFrameIn","_isContainElement","contains","_this5","stopId","setInterval","document","hasFocus","clearInterval","_this6","Svg","width","height","background","paths","resize","_ref2","isFinite","pa","_this$paths","isArray","getPath","find","updatePath","path","findIndex","deletePath","clonePaths","copy","segmentPoint","bezierCurve","range","calculateCoefficient","p0","b","step","from","fallbackPointObject","BoundingBox","resizeParams","fixedType","movePoint","max","min","flatMap","prev","pts","base","_ref2$range","commandPoints","segmentPointsFromCommand","pointsX","pointsY","EditPath","selector","vertex","_loop","_curr$points$","_curr$points$2","_next$points$","_this$selector","curr","next","outlinePoints","pointIndex","getPointsIndex","pIndex","_pointIndex$includes","selected","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","convertSelectingFromIndex","isObjectEmpty","PathSelector","getCommandsIndex","pathKey","selectingCommands","selecting","Number","commandKey","_this$selecting$pathK","selectingPoints","clear","select","selectMerge","unselect","_this$selecting","unselectedPath","_index$path","updateSelecting","_toPropertyKey","isSelectPathIndex","_extends2","_extends3","_extends4","unselectedCommand","_index$command","updateCommandSelecting","isSelectCommandIndex","isSelectPointIndex","every","EditSvg","multipleSelect","pathSelector","cancel","changeAttributes","exec","resizeBoundingBox","_BoundingBox$resizePa","pathsIndex","forEach","commandsIndex","preview","_BoundingBox","_BoundingBox$min","boundingBox","selectedPathsOnly","pathExec","commandExec","pointExec","pointsIndex","pointKey","Editing","editSvg","updater","translatePreview","resizePreview","setupUpdater","deletePaths","translateEditSvg","resizeEditSvg","ResizePathHandler","editing","handleResizePathEnd","handleResizePathPreview","getResizeMovePoint","_this$resizeBoundingB","_this$resizeBoundingB2","_this$resizeBoundingB3","_this$resizeBoundingB4","resizeBoundingBoxBase","_this$resizeBoundingB5","TranslatePathHandler","handleTranslateEnd","handleTranslatePreview","getTranslatePoint","_this$basePoint$x","_this$basePoint","_this$basePoint$y","_this$basePoint2","SVG_NS","createSvgElement","childs","createElementNS","setAttributeNS","setAttribute","sort","appendChild","createSvgChildElement","elName","pathObjectToElement","kebabAttrs","entries","val","svgObjectToElement","size","String","bgEl","fill","_ref3","Renderer","_this$el$getBoundingC","_ref5","replaceChild","childNodes","mimeTypeMap","png","jpg","downloadBlob","_URL","data","extension","filename","blob","bin","Buffer","buffer","Uint8Array","charCodeAt","Blob","base64ToBlob","navigator","msSaveBlob","URL","createObjectURL","createElement","download","href","body","click","removeChild","open","Download","_download","toBase64","renderCanvas","outerHTML","img","Image","canvas","animVal","ctx","getContext","drawImage","toDataURL","src","SUPPORT_RESIZE_OBSERVER","ResizeObserver","ResizeHandler","resizeCallback","_setupListener","active","setHandler","handleResize","abs","threshold","resizeObserver","observe","disconnect","parseSVGElement","svgEl","getAttribute","querySelectorAll","pEl","parsePathElement","pathEl","_path$updateAttribute","attr","item","name","kebab2camel","toUpperCase","parseCommandString","regexp","RegExp","matchAll","match","_match$","_match$$split","split","SvgDrawing","_ref$curve","_ref$close","_ref$delay","penColor","penWidth","renderer","factory","stroke","strokeWidth","pencilHandler","handler","drawStart","drawMove","drawEnd","undo","pop","trunc","runtime","exports","Op","hasOwn","$Symbol","Symbol","iteratorSymbol","iterator","asyncIteratorSymbol","asyncIterator","toStringTagSymbol","toStringTag","wrap","innerFn","outerFn","tryLocsList","protoGenerator","Generator","generator","Context","_invoke","state","GenStateSuspendedStart","method","GenStateExecuting","GenStateCompleted","doneResult","delegate","delegateResult","maybeInvokeDelegate","ContinueSentinel","sent","_sent","dispatchException","abrupt","record","tryCatch","done","GenStateSuspendedYield","makeInvokeMethod","err","GeneratorFunction","GeneratorFunctionPrototype","IteratorPrototype","getProto","getPrototypeOf","NativeIteratorPrototype","Gp","defineIteratorMethods","AsyncIterator","PromiseImpl","invoke","resolve","reject","__await","then","unwrapped","error","previousPromise","callInvokeWithMethodAndArg","TypeError","info","resultName","nextLoc","pushTryEntry","locs","entry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","resetTryEntry","completion","reset","iterable","iteratorMethod","isNaN","displayName","isGeneratorFunction","genFun","ctor","mark","awrap","async","Promise","iter","object","reverse","skipTempReset","charAt","stop","rootRecord","rval","exception","handle","loc","caught","hasCatch","hasFinally","finallyEntry","complete","finish","catch","thrown","delegateYield","module","regeneratorRuntime","accidentalStrictMode","Function","require$$0","Animation","ms","frame","_temp2","repeatCount","_frame","_repeatCount","setupGenerator","getFramePaths","animation","restorePaths","_regeneratorRuntime","loopId","_context","loops","initialize","loop","frameLoop","animPathsList","baseAttrs","dur","keyTimes","basePath","animPaths","ap","animateAttributesList","animateAttrs","attributeName","defaultValue","originPath","animationPaths","createAnimateAttributeValues","animateAttributes","SvgAnimation","_stopId","cancelAnimationFrame","restore","_setupAnimation","_startAnimation","_updateFrame","requestAnimationFrame","timestamp","toElement","sizeAttributes","animationJson","pathEls","_animationJson$key","childEls","init","svgStr","DOMParser","parseFromString","querySelector"],"mappings":"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"}